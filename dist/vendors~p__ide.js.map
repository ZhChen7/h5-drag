{"version":3,"sources":["webpack:///./node_modules/codemirror/mode/javascript/javascript.js","webpack:///./node_modules/codemirror/mode/xml/xml.js","webpack:///./node_modules/@ant-design/icons/es/components/AntdIcon.js","webpack:///./node_modules/@ant-design/icons/es/components/IconBase.js","webpack:///../src/FileSaver.js","webpack:///./node_modules/@ant-design/icons/es/utils.js","webpack:///./node_modules/codemirror/lib/codemirror.js","webpack:///./node_modules/react-codemirror2/index.js","webpack:///./node_modules/@ant-design/icons-svg/es/asn/SaveOutlined.js","webpack:///./node_modules/@ant-design/icons/es/icons/SaveOutlined.js","webpack:///./node_modules/hotkeys-js/dist/hotkeys.esm.js","webpack:///../src/useIsHotkeyPressed.ts","webpack:///../src/useHotkeys.ts","webpack:///./node_modules/@ant-design/icons/es/components/twoTonePrimaryColor.js"],"names":["mod","require","CodeMirror","defineMode","config","parserConfig","indentUnit","statementIndent","jsonldMode","jsonld","jsonMode","json","isTS","typescript","wordRE","wordCharacters","keywords","type","style","A","kw","B","C","D","operator","atom","isOperatorChar","isJsonldKeyword","stream","escaped","next","inSet","content","tp","cont","state","ch","tokenize","tokenString","match","ret","test","eat","tokenComment","skipToEnd","expressionAllowed","readRegexp","current","tokenQuasi","peek","eatWhile","string","slice","start","lexical","word","lastType","propertyIsEnumerable","quote","tokenBase","maybeEnd","brackets","fatArrowAt","arrow","indexOf","m","exec","index","depth","sawSomething","pos","charAt","bracket","atomicTypes","indented","column","align","prev","info","varname","v","localVars","name","cx","context","vars","cc","marked","hasOwnProperty","combinator","length","pop","expression","statement","lex","inScope","i","arguments","push","pass","apply","list","block","newContext","registerVarScoped","inList","Var","globalVars","inner","Context","defaultVars","popcontext","result","indent","outer","JSLexical","poplex","wanted","exp","value","pushlex","vardef","expect","parenExpr","maybeexpression","pushblockcontext","maybeelse","functiondef","forspec","className","enumdef","typename","typeexpr","pattern","maybelabel","pushcontext","maybeCatchBinding","afterExport","afterImport","funarg","expressionInner","noComma","body","arrowBodyNoComma","arrowBody","commasep","maybeop","maybeoperatorNoComma","maybeoperatorComma","classExpression","expressionNoComma","arrayLiteral","contCommasep","objprop","quasi","maybeTarget","me","expr","property","backUp","continueQuasi","findFatArrow","targetNoComma","target","maybeTypeArgs","_","getterSetter","afterprop","isModifier","maybetype","what","end","sep","proceed","isKW","afterType","typeprop","typearg","maybeReturnType","maybetypeOrIn","functiondecl","maybeTypeDefault","maybeAssign","vardefCont","register","eltpattern","proppattern","_type","forspec1","forspec2","mayberettype","typeparam","classNameAfter","classBody","classfield","isInterface","maybeFrom","exportField","importSpec","maybeMoreImports","maybeAs","enummember","textAfter","startState","basecolumn","token","sol","indentation","eatSpace","parseJS","Pass","firstChar","top","c","closing","isContinuedStatement","doubleIndentSwitch","electricInput","blockCommentStart","blockCommentEnd","blockCommentContinue","lineComment","fold","closeBrackets","helperType","skipExpression","registerHelper","defineMIME","htmlConfig","autoSelfClosers","implicitlyClosed","contextGrabbers","doNotIndent","allowUnquoted","allowMissing","caseFold","xmlConfig","allowMissingTagName","editorConf","config_","defaults","htmlMode","prop","setStyle","parser","chain","inBlock","doctype","inTag","ok","inText","isInText","baseState","tagName","tagStart","inAttribute","stringStartCol","closure","eol","isInAttribute","terminator","startOfLine","noIndent","nextTagName","parentTagName","popContext","tagNameState","closeTagNameState","attrState","matchClosing","closeState","closeStateErr","_stream","attrEqState","maybePopContext","attrValueState","attrContinuedState","baseIndent","fullLine","multilineTagIndentPastTag","multilineTagIndentFactor","alignCDATA","tagAfter","grabbers","configuration","skipAttribute","xmlCurrentTag","close","xmlCurrentContext","reverse","mimeModes","global","factory","module","exports","userAgent","navigator","platform","gecko","ie_upto10","ie_11up","edge","ie","ie_version","document","documentMode","webkit","qtwebkit","chrome","presto","safari","vendor","mac_geMountainLion","phantom","ios","android","mobile","mac","chromeOS","windows","presto_version","Number","flipCtrlCmd","captureRightClick","cls","RegExp","rmClass","node","classTest","after","e","count","childNodes","removeChild","firstChild","parent","removeChildren","appendChild","tag","createElement","cssText","createTextNode","elt","setAttribute","range","createRange","endNode","r","setEnd","setStart","createTextRange","moveToElementText","parentNode","collapse","moveEnd","moveStart","child","nodeType","contains","host","activeElement","shadowRoot","a","b","as","split","selectInput","select","selectionStart","selectionEnd","_e","f","args","Array","prototype","call","obj","overwrite","tabSize","startIndex","startValue","search","n","nextTab","Delayed","id","time","handler","bind","onTimeout","self","Date","setTimeout","set","ms","clearTimeout","array","scrollerGap","toString","sel_dontScroll","scroll","sel_mouse","origin","sel_move","goal","col","skipped","Math","min","spaceStrs","lst","arr","out","score","priority","splice","base","props","inst","Object","create","nothing","copyObj","nonASCIISingleCaseWordChar","toUpperCase","toLowerCase","helper","source","isWordCharBasic","extendingChars","charCodeAt","str","dir","isExtendingChar","pred","from","to","midF","mid","ceil","floor","order","found","part","max","level","bidiOther","sticky","cur","bidiOrdering","lowTypes","arabicTypes","code","bidiRE","isNeutral","isStrong","countsAsLeft","countsAsNum","direction","outerType","len","types","charType","i$1","i$2","type$1","i$3","prev$1","type$2","i$4","type$3","replace","j","i$5","cur$1","type$4","i$6","end$1","before","replace$1","j$1","i$7","BidiSpan","at","isRTL","j$2","nstart","unshift","line","text","noHandlers","on","emitter","addEventListener","attachEvent","map","_handlers","concat","removeEventListener","detachEvent","handlers","getHandlers","cm","override","preventDefault","defaultPrevented","signal","e_defaultPrevented","codemirrorIgnore","cursorActivity","curOp","cursorActivityHandlers","ctor","off","returnValue","stopPropagation","cancelBubble","e_preventDefault","e_stopPropagation","srcElement","which","button","ctrlKey","dragAndDrop","div","zwspSupported","measure","removeChildrenAndAdd","offsetHeight","offsetWidth","badBidiRects","txt","r0","getBoundingClientRect","r1","left","right","splitLinesAuto","l","nl","rt","hasSelection","window","getSelection","te","ownerDocument","selection","parentElement","compareEndPoints","hasCopyEvent","oncopy","badZoomedRects","normal","fromRange","abs","modes","mode","dependencies","mime","spec","createObj","resolveMode","options","mfactory","getMode","modeObj","modeExtensions","exts","modeProps","prop$1","properties","copyState","nstate","val","innerMode","a1","a2","StringStream","lineOracle","lastColumnPos","lastColumnValue","lineStart","undefined","skipTo","countColumn","consume","caseInsensitive","cased","substr","hideFirstChars","lookAhead","oracle","baseToken","doc","first","size","Error","chunk","lines","children","sz","chunkSize","iter","height","diff","no","h","lh","String","lineNumberFormatter","firstLineNumber","Pos","cmp","x","last","getLine","clipToLen","linelen","clipPos","SavedContext","maxLookAhead","baseTokens","baseTokenPos","nextLine","fromSaved","saved","save","copy","forceToEnd","st","modeGen","lineClasses","runMode","loop","o","overlay","overlays","i_end","opaque","styles","classes","bgClass","textClass","updateFrontier","getContextBefore","lineNo","resetState","maxHighlightLength","highlightLine","stateAfter","styleClasses","highlightFrontier","modeFrontier","precise","display","findStartLine","processLine","viewFrom","viewTo","startAt","callBlankLine","readToken","blankLine","Token","asArray","tokens","output","lineClass","flattenSpans","curStart","curStyle","addModeClass","extractLineClasses","mName","minindent","minline","lim","sawReadOnlySpans","sawCollapsedSpans","marker","spans","span","markedSpans","attachLine","old","startCh","isInsert","nw","startsBefore","inclusiveLeft","insertLeft","endsAfter","inclusiveRight","MarkedSpan","endCh","change","full","oldFirst","isLine","oldLast","markedSpansBefore","markedSpansAfter","sameLine","offset","getMarkedSpanFor","span$1","found$1","clearEmptySpans","newMarkers","gap","gapMarkers","clearWhenEmpty","markers","mark","readOnly","parts","mk","find","p","newParts","dfrom","dto","detachLine","lenDiff","aPos","bPos","fromCmp","extraLeft","toCmp","extraRight","sps","sp","collapsed","compareCollapsedMarkers","collapsedSpanAtSide","merged","collapsedSpanAtStart","collapsedSpanAtEnd","lineN","vis","visualLine","lastLine","lineIsHidden","widgetNode","lineIsHiddenInner","lineObj","d","maxLine","maxLineLength","lineLength","maxLineChanged","Line","estimateHeight","attachMarkedSpans","eventMixin","detachMarkedSpans","estHeight","updateLineHeight","styleToClassCache","styleToClassCacheWithMode","cache","lineView","eltP","builder","pre","trailingSpace","splitSpaces","getOption","rest","addToken","buildToken","hasBadBidiRects","getOrder","buildTokenBadBidi","allowFrontierUpdate","externalMeasured","insertLineContent","getLineStyles","joinClasses","zeroWidthElement","maps","caches","lastChild","querySelector","title","startStyle","endStyle","css","attributes","displayText","special","specialChars","mustWrap","createDocumentFragment","lastIndex","txt$1","tabWidth","spaceStr","specialCharPlaceholder","fullStyle","attr","trailingBefore","spaceBefore","ignoreWidget","widget","input","needsContentAttribute","setUneditable","allText","interpretTokenStyle","nextChange","spanStyle","spanEndStyle","spanStartStyle","Infinity","foundBookmarks","endStyles","buildCollapsedSpan","upto","tokenText","visualLineContinued","hidden","nextPos","view","LineView","operationGroup","op","ops","ownsGroup","delayedCallbacks","group","callbacks","cursorActivityCalled","endCb","fireCallbacksForOps","orphanDelayedCallbacks","fireOrphanDelayed","delayed","dims","changes","updateLineText","updateLineGutter","updateLineClasses","updateLineWidgets","replaceChild","zIndex","background","wrap","ensureLineWrapped","insertBefore","ext","built","buildLineContent","getLineContent","updateLineBackground","wrapClass","gutter","gutterBackground","gutterClass","fixedGutter","fixedPos","gutterTotalWidth","gutterMarkers","lineNumbers","wrap$1","gutterWrap","lineNumber","lineNumberFor","gutterLeft","lineNumInnerWidth","k","gutterSpecs","gutterWidth","alignable","isWidget","nextSibling","insertLineWidgets","insertLineWidgetsFor","allowAbove","widgets","ws","handleMouseEvents","positionLineWidget","above","signalLater","noHScroll","width","wrapperWidth","coverGutter","paddingLeft","position","marginLeft","parentStyle","gutters","wrapper","clientWidth","e_target","getAttribute","sizer","mover","lineSpace","offsetTop","cachedPaddingH","getComputedStyle","currentStyle","data","parseInt","paddingRight","isNaN","nativeBarWidth","scroller","scrollGap","barWidth","clientHeight","barHeight","rect","wrapping","lineWrapping","curWidth","displayWidth","heights","rects","getClientRects","bottom","lineMeasure","bias","measureCharPrepared","prepareMeasureForLine","findViewIndex","findViewForLine","updateLineForChanges","getDimensions","forceUpdate","updateExternalMeasurement","mapFromLineView","hasHeights","prepared","varHeight","key","ensureLineHeights","measureCharInner","bogus","rtop","rbottom","nullRect","mStart","mEnd","coverStart","coverEnd","place","nodeAndOffsetInLineMap","getUsefulRect","maybeUpdateRectForZooming","rSpan","charWidth","rbot","bot","singleCursorHeightPerLine","screen","logicalXDPI","deviceXDPI","hasBadZoomedRects","scaleX","scaleY","logicalYDPI","deviceYDPI","externalMeasure","clearLineMeasurementCacheFor","clearLineMeasurementCache","cachedCharWidth","cachedTextHeight","lineNumChars","pageXOffset","documentElement","scrollLeft","marginTop","pageYOffset","scrollTop","widgetHeight","includeWidgets","widgetTopHeight","yOff","heightAtLine","paddingTop","viewOffset","lOff","pageScrollY","xOff","pageScrollX","coords","localBox","lineSpaceBox","intoCoordSystem","measureChar","preparedMeasure","get","partPos","invert","getBidiPartAt","other","getBidi","outside","xRel","y","PosWithInfo","lineAtHeight","coordsCharInner","collapsedSpanAround","rangeEnd","begin","findFirst","targetTop","wrappedLineExtent","box","ltr","coordsBidiPartWrapped","coordsBidiPart","chAround","boxAround","boxIsAfter","baseX","atLeft","atStart","cursorCoords","skipExtendingChars","_lineNo","ref","closestDist","endX","dist","measureText","anchor","clientLeft","offsetLeft","compensateForHScroll","th","textHeight","perLine","widgetsHeight","est","liberal","forRect","space","clientX","clientY","e$1","coordsChar","colDiff","round","paddingH","lendiff","updateLineNumbers","viewChanged","visualLineNo","resetView","visualLineEndNo","cut","viewCuttingPoint","cut$1","cutTop","cutBot","buildViewArray","oldN","newN","dirty","showSelection","prepareSelection","primary","curFragment","cursors","selFragment","sel","ranges","primIndex","empty","showCursorWhenSelecting","drawSelectionCursor","head","drawSelectionRange","cursor","cursorHeight","otherCursor","fragment","padding","leftSide","rightSide","sizerWidth","docLTR","fromArg","toArg","lineLen","charCoords","side","extent","wrappedLineExtentChar","iterateBidiSections","fromPos","toPos","openStart","openEnd","openLeft","openRight","add","topLeft","topRight","botLeft","botRight","wrapX","cmpCoords","sFrom","sTo","drawForLine","fromLine","toLine","singleVLine","leftEnd","rightStart","focused","clearInterval","blinker","cursorDiv","visibility","cursorBlinkRate","setInterval","hasFocus","onBlur","focus","onFocus","delayingBlurEvent","addClass","selForContextMenu","reset","receivedFocus","restartBlink","shift","prevBottom","lineDiv","updateWidgetHeight","chWidth","w","viewport","ensure","ensureFrom","ensureTo","signalDOMEvent","doScroll","innerHeight","scrollNode","scrollIntoView","margin","limit","changed","endCoords","scrollPos","calculateScrollPos","startTop","startLeft","updateScrollTop","setScrollLeft","snapMargin","screentop","displayHeight","docBottom","paddingVert","atTop","atBottom","newTop","screenleft","screenw","tooWide","resolveScrollToPos","getCursor","scrollToPos","cursorScrollMargin","estimateCoords","scrollToCoordsRange","sPos","scrollToCoords","updateDisplaySimple","setScrollTop","startWorker","forceScroll","scrollHeight","scrollbars","isScroller","scrollWidth","alignHorizontally","gutterW","docH","viewHeight","viewWidth","barLeft","docHeight","NativeScrollbars","vert","horiz","tabIndex","checkedZeroWidth","minHeight","minWidth","update","needsH","needsV","sWidth","totalHeight","totalWidth","zeroWidthHack","disableHoriz","enableZeroWidthBar","disableVert","pointerEvents","bar","delay","elementFromPoint","maybeDisable","clear","NullScrollbars","measureForScrollbars","startWidth","startHeight","updateScrollbarsInner","updateHeightsInViewport","sizes","paddingBottom","heightForcer","borderBottom","scrollbarFiller","coverGutterNextToScrollbar","gutterFiller","scrollbarModel","scrollbarStyle","axis","nextOpId","updateInput","typing","changeObjs","selectionChanged","updateMaxLine","pushOperation","finishOperation","endOperations","endOperation_R1","endOperation_W1","endOperation_R2","endOperation_W2","endOperation_finish","maybeClipScrollbars","findMaxLine","mustUpdate","DisplayUpdate","updatedDisplay","updateDisplayIfNeeded","barMeasure","adjustWidthTo","maxScrollLeft","preparedSelection","takeFocus","activeElt","updateScrollbars","setDocumentHeight","ensureFocus","postUpdateDisplay","wheelStartX","wheelStartY","scrollPosIntoView","maybeScrollWindow","maybeHiddenMarkers","unhidden","maybeUnhiddenMarkers","finish","startOperation","endOperation","highlight","highlightWorker","workTime","changedLines","oldStyles","highlighted","oldCls","newCls","ischange","workDelay","runInOp","regLineChange","force","visible","visibleLines","editorIsHidden","wrapperHeight","oldDisplayWidth","events","hasHandler","scrollbarsClipped","marginBottom","borderRightWidth","active","anchorNode","extend","anchorOffset","focusNode","focusOffset","snapshot","nodeName","removeAllRanges","addRange","renderedView","countDirtyView","maybeUpdateLineNumberWidth","viewportMargin","different","lastWrapHeight","lastWrapWidth","adjustView","toUpdate","selSnapshot","selectionSnapshot","patchDisplay","restoreSelection","selectionDiv","updateSelection","reportedViewFrom","reportedViewTo","updateNumbersFrom","container","currentWheelTarget","buildLineElement","rm","updateNumber","alignWidgets","comp","innerW","lineGutter","lineNumWidth","updateGutterSpace","sawLineNumbers","specs","gElt","renderGutters","regChange","draggable","wheelDX","wheelDY","activeTouch","getGutters","init","wheelSamples","wheelPixelsPerUnit","dx","wheelDeltaX","dy","wheelDeltaY","detail","HORIZONTAL_AXIS","VERTICAL_AXIS","wheelDelta","delta","wheelEventDelta","canScrollX","canScrollY","pixels","movedX","movedY","sample","Selection","equals","here","there","equalCursorPos","deepCopy","Range","copyPos","somethingSelected","minPos","maxPos","mayTouch","selectionsMayTouch","prim","sort","inv","changeEnd","adjustForChange","normalizeSelection","hint","oldPrev","newPrev","offsetPos","modeOption","resetModeState","wholeLineUpdateBefore","updateLine","spansFor","firstLine","lastText","lastSpans","nlines","insert","linesFor","remove","isWholeLineUpdate","added","added$1","added$2","sharedHistOnly","skip","sharedHist","linked","rel","shared","propagate","estimateLineHeights","loadMode","setDirectionClass","startGen","done","undone","undoDepth","lastModTime","lastSelTime","lastOp","lastSelOp","lastOrigin","lastSelOrigin","generation","maxGeneration","histChange","getBetween","attachLocalSpans","linkedDocs","hist","clearSelectionEvents","selAfter","opId","history","historyEventDelay","lastChangeEvent","historyChangeFromChange","pushSelectionToHistory","selectionEventCanBeMerged","clearRedo","dest","existing","explicitlyCleared","removeClearedSpans","getOldSpans","stretched","stretchSpansOverChange","oldCur","stretchCur","newGroup","instantiateSel","event","newChanges","posBefore","setSelection","extendRange","heads","newSel","simpleSelection","setSelectionNoUndo","addSelectionToHistory","NaN","filterSelectionChange","setSelectionInner","skipAtomicInSelection","ensureCursorVisible","signalCursorActivity","mayClear","newAnchor","skipAtomic","newHead","oldPos","preventCursorLeft","selectLeft","preventCursorRight","selectRight","atomic","near","movePos","skipAtomicInner","far","cantEdit","canceled","cancel","ignoreReadOnly","operation","makeChange","suppressEdits","filterChange","removeReadOnlyRanges","makeChangeInner","computeSelAfterChange","addChangeToHistory","makeChangeSingleDoc","rebased","rebaseHist","allowSelectionOnly","suppress","antiChanges","filter","mergeOldSpans","returned","distance","shiftDoc","removed","makeChangeSingleDocInEditor","updateDoc","recomputeMaxLength","checkWidthStart","retreatFrontier","changesHandler","changeHandler","assign","splitLines","sub","copied","rebaseHistSelSingle","rebaseHistArray","handle","changeType","clipLine","LeafChunk","removeInner","cleanUpLine","insertInner","iterN","BranchChunk","oldHeight","remaining","leaf","maybeSpill","spilled","sibling","myIndex","used","LineWidget","opt","adjustScrollWhenAboveVisible","this$1","oldH","addToScrollTop","changeLine","insertAt","aboveVisible","nextMarkerId","TextMarker","withOp","removeMarkedSpan","visual","reCheckSelection","dHeight","markTextShared","markText","replacedWith","conflictingCollapsedRange","seeCollapsedSpans","addToHistory","curLine","addMarkedSpan","clearOnEnter","seeReadOnlySpans","clearHistory","SharedTextMarker","cloneNode","isParent","findMarks","mFrom","mTo","subMark","subMarker","nextDocId","Doc","lineSep","cleanGeneration","History","constructor","getValue","getLines","join","lineSeparator","setValue","docMethodOp","replaceRange","getRange","getLineHandle","getLineNumber","getLineHandleVisualStart","lineCount","listSelections","setCursor","setSimpleSelection","extendSelection","extendSelections","clipPosArray","extendSelectionsBy","setSelections","addSelection","getSelections","replaceSelection","dup","replaceSelections","computeReplacedSel","setSelectionReplaceHistory","undo","makeChangeFromHistory","redo","undoSelection","redoSelection","setExtending","getExtending","historySize","markClean","changeGeneration","forceSplit","isClean","gen","getHistory","copyHistoryArray","setHistory","histData","setGutterMarker","gutterID","isEmpty","clearGutter","lineInfo","addLineClass","where","removeLineClass","addLineWidget","removeLineWidget","setBookmark","realOpts","findMarksAt","getAllMarks","posFromIndex","sepSize","indexFromPos","copyHistory","linkedDoc","copySharedMarkers","findSharedMarkers","unlinkDoc","link","detachSharedMarkers","splitIds","iterLinkedDocs","getEditor","setDirection","directionChanged","eachLine","lastDrop","clearDragCursor","eventInWidget","posFromMouse","files","dataTransfer","isReadOnly","FileReader","File","read","markAsReadAndPasteIfAllFilesAreRead","t","readTextFromFile","file","allowDropFileTypes","reader","onerror","onload","readAsText","draggingText","text$1","getData","selected","e_stop","setData","effectAllowed","setDragImage","img","src","_top","frag","dragCursor","getElementsByClassName","byClass","editors","globalsRegistered","registerGlobalHandlers","resizeTimer","forEachCodeMirror","onResize","setSize","keyNames","fromCharCode","keyMap","basic","pcDefault","emacsy","macDefault","alt","ctrl","cmd","keymap","keyname","keys","normalizeKeyName","getKeyMap","fallthrough","lookupKey","keyCode","noShift","altKey","metaKey","shiftKey","altGraphKey","addModifierNames","compute","kill","toKill","replaced","moveCharLogically","visually","moveInStorageOrder","prep","bidi","moveLogically","mv","getWrappedLineExtent","searchInVisualLine","getRes","res","nextCh","commands","selectAll","singleSelection","killLine","deleteNearSelection","deleteLine","delLineLeft","delWrappedLineLeft","leftPos","delWrappedLineRight","rightPos","goDocStart","goDocEnd","goLineStart","goLineStartSmart","lineStartSmart","goLineEnd","lineEnd","goLineRight","goLineLeft","goLineLeftSmart","goLineUp","moveV","goLineDown","goPageUp","goPageDown","goCharLeft","moveH","goCharRight","goColumnLeft","goColumnRight","goWordLeft","goGroupRight","goGroupLeft","goWordRight","delCharBefore","deleteH","delCharAfter","delWordBefore","delWordAfter","delGroupBefore","delGroupAfter","indentAuto","indentSelection","indentMore","indentLess","insertTab","insertSoftTab","spaces","defaultTab","execCommand","transposeChars","newlineAndIndent","sels","indentLine","openLine","toggleOverwrite","endOfLine","visualLineEnd","firstNonWS","inWS","bound","dropShift","ensurePolled","prevShift","keyMaps","extraKeys","stopSeq","seq","keySeq","isModifierKey","dispatchKeyInner","lookupKeyForEditor","keyName","dispatchKey","doHandleBinding","motion","lastStoppedKey","getField","handled","handleKeyBinding","showCrossHair","up","charCode","handleCharBinding","onKeyPress","DOUBLECLICK_DELAY","PastClick","compare","lastClick","lastDoubleClick","now","supportsTouch","clickInGutter","e_button","repeat","clickRepeat","selectingText","handleMappedButton","leftButtonDown","onContextMenu","delayBlurEvent","option","unit","addNew","moveOnDrag","behavior","configureMouse","contained","dragDrop","leftButtonStartDrag","leftButtonSelect","moved","dragEnd","mouseMove","dragStart","preventScroll","e2","findWordAt","ourRange","ourIndex","startSel","rangeForUnit","replaceOneSelection","lastPos","startCol","posCol","findColumn","oldRange","ranges$1","bidiSimplify","editorSize","counter","curCount","extendTo","move","buttons","anchorLine","boundary","headIndex","usePart","prevent","mX","mY","touches","lineBox","g","gutterEvent","contextMenuInGutter","theme","clearCaches","Init","optionHandlers","deflt","notOnInit","defineOption","newBreaks","refresh","defaultSpecialCharPlaceholder","getInputField","spellcheck","autocorrect","autocapitalize","themeChanged","updateGutters","detach","attach","wrappingChanged","initScrollbars","integer","blur","readOnlyChanged","screenReaderLabelChanged","dragDropChanged","resetPosition","wasOn","funcs","dragFunctions","toggle","enter","over","leave","drop","inputStyles","inputStyle","Display","pasteIncoming","cutIncoming","autofocus","registerEventHandlers","ensureGlobalHandlers","attachDoc","finishInit","initHooks","textRendering","onMouseDown","touchFinished","prevTouch","touch","radiusX","radiusY","isMouseLikeTouchEvent","pageX","pageY","farAway","finishTouch","onScrollWheel","onDragOver","onDragStart","onDrop","inp","onKeyUp","onKeyDown","defineInitHook","how","aggressive","curSpace","curSpaceString","indentString","indentWithTabs","pos$1","lastCopied","newLastCopied","inserted","deleted","recent","paste","textLines","multiPaste","pasteLinesPerSelection","lineWise","changeEvent","triggerElectric","pasted","clipboardData","disableInput","applyTextInput","electricChars","smartIndent","getModeAt","lineRange","field","border","disableBrowserMagic","helpers","setOption","getDoc","addKeyMap","removeKeyMap","addOverlay","methodOp","insertSorted","modeSpec","removeOverlay","newRanges","getTokenAt","takeToken","getLineTokens","getTokenTypeAt","getHelper","getHelpers","help","_global","getStateAfter","fromCoordSystem","defaultTextHeight","defaultCharWidth","getViewport","addWidget","vspace","hspace","triggerOnKeyDown","triggerOnKeyPress","triggerOnKeyUp","triggerOnMouseDown","findPosH","amount","hitSide","rtlMoveVisually","findPosV","goalColumn","goals","headPos","startChar","check","isWordChar","scrollTo","getScrollInfo","scrollToRange","interpret","swapDoc","phrase","phraseText","phrases","getWrapperElement","getScrollerElement","getGutterElement","registerGlobalHelper","predicate","origDir","lineDir","boundToLine","moveVisually","findNextLine","moveOnce","sawType","pageSize","moveAmount","ContentEditableInput","lastAnchorNode","lastAnchorOffset","lastFocusNode","lastFocusOffset","polling","composing","gracePeriod","readDOMTimeout","belongsToInput","handlePaste","updateFromDOM","readFromDOMSoon","forceCompositionEnd","setLastCopied","lineWiseCopyCut","copyableRanges","clearData","kludge","hiddenTextarea","hadFocus","showPrimarySelection","onCopyCut","label","removeAttribute","showMultipleSelections","curAnchor","domToPos","curFocus","bad","posToDOM","rangeCount","getRangeAt","rng","startGracePeriod","rememberSelection","selectionInEditor","commonAncestorContainer","pollSelection","pollInterval","poll","isInGutter","pollContent","fromIndex","fromNode","toIndex","toNode","previousSibling","newText","domTextBetween","oldText","cutFront","cutEnd","oldTop","maxCutFront","newBot","oldBot","maxCutEnd","chFrom","chTo","contentEditable","scan","extraLinebreak","cmText","addText","markerID","recognizeMarker","isBlock","textContent","walk","nodeValue","lineNode","badPos","locateNodeInLineView","textNode","topNode","curNode","dist$1","TextareaInput","prevInput","pollingFast","createField","textarea","fastPoll","prepareCopyCut","dispatchEvent","Event","_display","moveInputWithCursor","wrapOff","lineOff","teTop","teLeft","drawn","contextMenuPending","slowPoll","missed","same","resetSelectionOnContextMenu","oldCSS","oldWrapperCSS","wrapperBox","offsetParent","oldScrollY","scrollY","rehide","detectingSelectAll","extval","prepareSelectAllHack","mouseup","disabled","tabindex","placeholder","realSubmit","form","leaveSubmitMethodAlone","submit","wrappedSubmit","getTextArea","toTextArea","wheelEventPixels","cmpPos","extendMode","normalizeKeyMap","defineOptions","addEditorMethods","dontDelegate","method","defineExtension","func","defineDocExtension","fromTextArea","addLegacyProps","version","_extends","Symbol","iterator","_typeof","__extends","_extendStatics","setPrototypeOf","__proto__","__","defineProperty","UnControlled","Controlled","React","SERVER_RENDERED","Helper","_this","tx","ty","every","Shared","editor","delegateCursor","delegateScroll","coordinates","delegateSelection","autoScroll","applyNext","preserved","autoCursor","applyUserDefined","wire","forEach","onCopy","onCursor","onCursorActivity","onCut","onDblClick","onDragEnter","onDragLeave","onGutterClick","EditorChangeEvent","onInputRead","onKeyHandled","onPaste","element","onRenderLine","onScroll","onSelection","onTouchStart","onUpdate","onViewportChange","_super","applied","appliedNext","appliedUserDefined","deferred","emulating","hydrated","initCb","editorDidConfigure","mounted","hydrate","_options","userDefinedOptions","optionDelta","some","mirror","resolveChange","initChange","lastChar","mirrorChange","componentDidMount","fn","phantomChange","onBeforeChange","onChange","editorDidMount","componentDidUpdate","prevProps","componentWillUnmount","editorWillUnmount","shouldComponentUpdate","nextProps","nextState","render","Component","continueChange","detached","onBeforeChangeCb","editorDidAttach","editorDidDetach","isff","object","modifier","mods","lastIndexOf","arr1","arr2","isIndex","_keyMap","backspace","tab","esc","escape","down","del","ins","home","pageup","pagedown","capslock","_modifier","control","command","modifierMap","_mods","_downKeys","_scope","elementHasBindEvent","scope","flag","isContentEditable","newScope","getScope","setScope","hotkeys","keysInfo","isArray","eachUnbind","_len","_key","splitKey","_ref","_ref$splitKey","multipleKeys","getKeys","originKey","unbindKeys","lastKey","getMods","record","isMatchingMethod","compareArray","modifiersMatch","shortcut","asterisk","keyNum","getModifierState","keydown","keyup","eventHandler","_i","keyShortcut","_downKeysCurrent","isElementBind","addEvent","dispatch","clearModifier","_api","deleteScope","getPressedKeyCodes","isPressed","unbind","_hotkeys","noConflict","deep","callback","deps","enableOnTags","useRef","memoisedCallback","useCallback","useEffect","targetTagName","Boolean"],"mappings":"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","file":"vendors~p__ide.js","sourcesContent":["// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nCodeMirror.defineMode(\"javascript\", function(config, parserConfig) {\n  var indentUnit = config.indentUnit;\n  var statementIndent = parserConfig.statementIndent;\n  var jsonldMode = parserConfig.jsonld;\n  var jsonMode = parserConfig.json || jsonldMode;\n  var isTS = parserConfig.typescript;\n  var wordRE = parserConfig.wordCharacters || /[\\w$\\xa1-\\uffff]/;\n\n  // Tokenizer\n\n  var keywords = function(){\n    function kw(type) {return {type: type, style: \"keyword\"};}\n    var A = kw(\"keyword a\"), B = kw(\"keyword b\"), C = kw(\"keyword c\"), D = kw(\"keyword d\");\n    var operator = kw(\"operator\"), atom = {type: \"atom\", style: \"atom\"};\n\n    return {\n      \"if\": kw(\"if\"), \"while\": A, \"with\": A, \"else\": B, \"do\": B, \"try\": B, \"finally\": B,\n      \"return\": D, \"break\": D, \"continue\": D, \"new\": kw(\"new\"), \"delete\": C, \"void\": C, \"throw\": C,\n      \"debugger\": kw(\"debugger\"), \"var\": kw(\"var\"), \"const\": kw(\"var\"), \"let\": kw(\"var\"),\n      \"function\": kw(\"function\"), \"catch\": kw(\"catch\"),\n      \"for\": kw(\"for\"), \"switch\": kw(\"switch\"), \"case\": kw(\"case\"), \"default\": kw(\"default\"),\n      \"in\": operator, \"typeof\": operator, \"instanceof\": operator,\n      \"true\": atom, \"false\": atom, \"null\": atom, \"undefined\": atom, \"NaN\": atom, \"Infinity\": atom,\n      \"this\": kw(\"this\"), \"class\": kw(\"class\"), \"super\": kw(\"atom\"),\n      \"yield\": C, \"export\": kw(\"export\"), \"import\": kw(\"import\"), \"extends\": C,\n      \"await\": C\n    };\n  }();\n\n  var isOperatorChar = /[+\\-*&%=<>!?|~^@]/;\n  var isJsonldKeyword = /^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)\"/;\n\n  function readRegexp(stream) {\n    var escaped = false, next, inSet = false;\n    while ((next = stream.next()) != null) {\n      if (!escaped) {\n        if (next == \"/\" && !inSet) return;\n        if (next == \"[\") inSet = true;\n        else if (inSet && next == \"]\") inSet = false;\n      }\n      escaped = !escaped && next == \"\\\\\";\n    }\n  }\n\n  // Used as scratch variables to communicate multiple values without\n  // consing up tons of objects.\n  var type, content;\n  function ret(tp, style, cont) {\n    type = tp; content = cont;\n    return style;\n  }\n  function tokenBase(stream, state) {\n    var ch = stream.next();\n    if (ch == '\"' || ch == \"'\") {\n      state.tokenize = tokenString(ch);\n      return state.tokenize(stream, state);\n    } else if (ch == \".\" && stream.match(/^\\d[\\d_]*(?:[eE][+\\-]?[\\d_]+)?/)) {\n      return ret(\"number\", \"number\");\n    } else if (ch == \".\" && stream.match(\"..\")) {\n      return ret(\"spread\", \"meta\");\n    } else if (/[\\[\\]{}\\(\\),;\\:\\.]/.test(ch)) {\n      return ret(ch);\n    } else if (ch == \"=\" && stream.eat(\">\")) {\n      return ret(\"=>\", \"operator\");\n    } else if (ch == \"0\" && stream.match(/^(?:x[\\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/)) {\n      return ret(\"number\", \"number\");\n    } else if (/\\d/.test(ch)) {\n      stream.match(/^[\\d_]*(?:n|(?:\\.[\\d_]*)?(?:[eE][+\\-]?[\\d_]+)?)?/);\n      return ret(\"number\", \"number\");\n    } else if (ch == \"/\") {\n      if (stream.eat(\"*\")) {\n        state.tokenize = tokenComment;\n        return tokenComment(stream, state);\n      } else if (stream.eat(\"/\")) {\n        stream.skipToEnd();\n        return ret(\"comment\", \"comment\");\n      } else if (expressionAllowed(stream, state, 1)) {\n        readRegexp(stream);\n        stream.match(/^\\b(([gimyus])(?![gimyus]*\\2))+\\b/);\n        return ret(\"regexp\", \"string-2\");\n      } else {\n        stream.eat(\"=\");\n        return ret(\"operator\", \"operator\", stream.current());\n      }\n    } else if (ch == \"`\") {\n      state.tokenize = tokenQuasi;\n      return tokenQuasi(stream, state);\n    } else if (ch == \"#\" && stream.peek() == \"!\") {\n      stream.skipToEnd();\n      return ret(\"meta\", \"meta\");\n    } else if (ch == \"#\" && stream.eatWhile(wordRE)) {\n      return ret(\"variable\", \"property\")\n    } else if (ch == \"<\" && stream.match(\"!--\") ||\n               (ch == \"-\" && stream.match(\"->\") && !/\\S/.test(stream.string.slice(0, stream.start)))) {\n      stream.skipToEnd()\n      return ret(\"comment\", \"comment\")\n    } else if (isOperatorChar.test(ch)) {\n      if (ch != \">\" || !state.lexical || state.lexical.type != \">\") {\n        if (stream.eat(\"=\")) {\n          if (ch == \"!\" || ch == \"=\") stream.eat(\"=\")\n        } else if (/[<>*+\\-|&?]/.test(ch)) {\n          stream.eat(ch)\n          if (ch == \">\") stream.eat(ch)\n        }\n      }\n      if (ch == \"?\" && stream.eat(\".\")) return ret(\".\")\n      return ret(\"operator\", \"operator\", stream.current());\n    } else if (wordRE.test(ch)) {\n      stream.eatWhile(wordRE);\n      var word = stream.current()\n      if (state.lastType != \".\") {\n        if (keywords.propertyIsEnumerable(word)) {\n          var kw = keywords[word]\n          return ret(kw.type, kw.style, word)\n        }\n        if (word == \"async\" && stream.match(/^(\\s|\\/\\*.*?\\*\\/)*[\\[\\(\\w]/, false))\n          return ret(\"async\", \"keyword\", word)\n      }\n      return ret(\"variable\", \"variable\", word)\n    }\n  }\n\n  function tokenString(quote) {\n    return function(stream, state) {\n      var escaped = false, next;\n      if (jsonldMode && stream.peek() == \"@\" && stream.match(isJsonldKeyword)){\n        state.tokenize = tokenBase;\n        return ret(\"jsonld-keyword\", \"meta\");\n      }\n      while ((next = stream.next()) != null) {\n        if (next == quote && !escaped) break;\n        escaped = !escaped && next == \"\\\\\";\n      }\n      if (!escaped) state.tokenize = tokenBase;\n      return ret(\"string\", \"string\");\n    };\n  }\n\n  function tokenComment(stream, state) {\n    var maybeEnd = false, ch;\n    while (ch = stream.next()) {\n      if (ch == \"/\" && maybeEnd) {\n        state.tokenize = tokenBase;\n        break;\n      }\n      maybeEnd = (ch == \"*\");\n    }\n    return ret(\"comment\", \"comment\");\n  }\n\n  function tokenQuasi(stream, state) {\n    var escaped = false, next;\n    while ((next = stream.next()) != null) {\n      if (!escaped && (next == \"`\" || next == \"$\" && stream.eat(\"{\"))) {\n        state.tokenize = tokenBase;\n        break;\n      }\n      escaped = !escaped && next == \"\\\\\";\n    }\n    return ret(\"quasi\", \"string-2\", stream.current());\n  }\n\n  var brackets = \"([{}])\";\n  // This is a crude lookahead trick to try and notice that we're\n  // parsing the argument patterns for a fat-arrow function before we\n  // actually hit the arrow token. It only works if the arrow is on\n  // the same line as the arguments and there's no strange noise\n  // (comments) in between. Fallback is to only notice when we hit the\n  // arrow, and not declare the arguments as locals for the arrow\n  // body.\n  function findFatArrow(stream, state) {\n    if (state.fatArrowAt) state.fatArrowAt = null;\n    var arrow = stream.string.indexOf(\"=>\", stream.start);\n    if (arrow < 0) return;\n\n    if (isTS) { // Try to skip TypeScript return type declarations after the arguments\n      var m = /:\\s*(?:\\w+(?:<[^>]*>|\\[\\])?|\\{[^}]*\\})\\s*$/.exec(stream.string.slice(stream.start, arrow))\n      if (m) arrow = m.index\n    }\n\n    var depth = 0, sawSomething = false;\n    for (var pos = arrow - 1; pos >= 0; --pos) {\n      var ch = stream.string.charAt(pos);\n      var bracket = brackets.indexOf(ch);\n      if (bracket >= 0 && bracket < 3) {\n        if (!depth) { ++pos; break; }\n        if (--depth == 0) { if (ch == \"(\") sawSomething = true; break; }\n      } else if (bracket >= 3 && bracket < 6) {\n        ++depth;\n      } else if (wordRE.test(ch)) {\n        sawSomething = true;\n      } else if (/[\"'\\/`]/.test(ch)) {\n        for (;; --pos) {\n          if (pos == 0) return\n          var next = stream.string.charAt(pos - 1)\n          if (next == ch && stream.string.charAt(pos - 2) != \"\\\\\") { pos--; break }\n        }\n      } else if (sawSomething && !depth) {\n        ++pos;\n        break;\n      }\n    }\n    if (sawSomething && !depth) state.fatArrowAt = pos;\n  }\n\n  // Parser\n\n  var atomicTypes = {\"atom\": true, \"number\": true, \"variable\": true, \"string\": true, \"regexp\": true, \"this\": true, \"jsonld-keyword\": true};\n\n  function JSLexical(indented, column, type, align, prev, info) {\n    this.indented = indented;\n    this.column = column;\n    this.type = type;\n    this.prev = prev;\n    this.info = info;\n    if (align != null) this.align = align;\n  }\n\n  function inScope(state, varname) {\n    for (var v = state.localVars; v; v = v.next)\n      if (v.name == varname) return true;\n    for (var cx = state.context; cx; cx = cx.prev) {\n      for (var v = cx.vars; v; v = v.next)\n        if (v.name == varname) return true;\n    }\n  }\n\n  function parseJS(state, style, type, content, stream) {\n    var cc = state.cc;\n    // Communicate our context to the combinators.\n    // (Less wasteful than consing up a hundred closures on every call.)\n    cx.state = state; cx.stream = stream; cx.marked = null, cx.cc = cc; cx.style = style;\n\n    if (!state.lexical.hasOwnProperty(\"align\"))\n      state.lexical.align = true;\n\n    while(true) {\n      var combinator = cc.length ? cc.pop() : jsonMode ? expression : statement;\n      if (combinator(type, content)) {\n        while(cc.length && cc[cc.length - 1].lex)\n          cc.pop()();\n        if (cx.marked) return cx.marked;\n        if (type == \"variable\" && inScope(state, content)) return \"variable-2\";\n        return style;\n      }\n    }\n  }\n\n  // Combinator utils\n\n  var cx = {state: null, column: null, marked: null, cc: null};\n  function pass() {\n    for (var i = arguments.length - 1; i >= 0; i--) cx.cc.push(arguments[i]);\n  }\n  function cont() {\n    pass.apply(null, arguments);\n    return true;\n  }\n  function inList(name, list) {\n    for (var v = list; v; v = v.next) if (v.name == name) return true\n    return false;\n  }\n  function register(varname) {\n    var state = cx.state;\n    cx.marked = \"def\";\n    if (state.context) {\n      if (state.lexical.info == \"var\" && state.context && state.context.block) {\n        // FIXME function decls are also not block scoped\n        var newContext = registerVarScoped(varname, state.context)\n        if (newContext != null) {\n          state.context = newContext\n          return\n        }\n      } else if (!inList(varname, state.localVars)) {\n        state.localVars = new Var(varname, state.localVars)\n        return\n      }\n    }\n    // Fall through means this is global\n    if (parserConfig.globalVars && !inList(varname, state.globalVars))\n      state.globalVars = new Var(varname, state.globalVars)\n  }\n  function registerVarScoped(varname, context) {\n    if (!context) {\n      return null\n    } else if (context.block) {\n      var inner = registerVarScoped(varname, context.prev)\n      if (!inner) return null\n      if (inner == context.prev) return context\n      return new Context(inner, context.vars, true)\n    } else if (inList(varname, context.vars)) {\n      return context\n    } else {\n      return new Context(context.prev, new Var(varname, context.vars), false)\n    }\n  }\n\n  function isModifier(name) {\n    return name == \"public\" || name == \"private\" || name == \"protected\" || name == \"abstract\" || name == \"readonly\"\n  }\n\n  // Combinators\n\n  function Context(prev, vars, block) { this.prev = prev; this.vars = vars; this.block = block }\n  function Var(name, next) { this.name = name; this.next = next }\n\n  var defaultVars = new Var(\"this\", new Var(\"arguments\", null))\n  function pushcontext() {\n    cx.state.context = new Context(cx.state.context, cx.state.localVars, false)\n    cx.state.localVars = defaultVars\n  }\n  function pushblockcontext() {\n    cx.state.context = new Context(cx.state.context, cx.state.localVars, true)\n    cx.state.localVars = null\n  }\n  function popcontext() {\n    cx.state.localVars = cx.state.context.vars\n    cx.state.context = cx.state.context.prev\n  }\n  popcontext.lex = true\n  function pushlex(type, info) {\n    var result = function() {\n      var state = cx.state, indent = state.indented;\n      if (state.lexical.type == \"stat\") indent = state.lexical.indented;\n      else for (var outer = state.lexical; outer && outer.type == \")\" && outer.align; outer = outer.prev)\n        indent = outer.indented;\n      state.lexical = new JSLexical(indent, cx.stream.column(), type, null, state.lexical, info);\n    };\n    result.lex = true;\n    return result;\n  }\n  function poplex() {\n    var state = cx.state;\n    if (state.lexical.prev) {\n      if (state.lexical.type == \")\")\n        state.indented = state.lexical.indented;\n      state.lexical = state.lexical.prev;\n    }\n  }\n  poplex.lex = true;\n\n  function expect(wanted) {\n    function exp(type) {\n      if (type == wanted) return cont();\n      else if (wanted == \";\" || type == \"}\" || type == \")\" || type == \"]\") return pass();\n      else return cont(exp);\n    };\n    return exp;\n  }\n\n  function statement(type, value) {\n    if (type == \"var\") return cont(pushlex(\"vardef\", value), vardef, expect(\";\"), poplex);\n    if (type == \"keyword a\") return cont(pushlex(\"form\"), parenExpr, statement, poplex);\n    if (type == \"keyword b\") return cont(pushlex(\"form\"), statement, poplex);\n    if (type == \"keyword d\") return cx.stream.match(/^\\s*$/, false) ? cont() : cont(pushlex(\"stat\"), maybeexpression, expect(\";\"), poplex);\n    if (type == \"debugger\") return cont(expect(\";\"));\n    if (type == \"{\") return cont(pushlex(\"}\"), pushblockcontext, block, poplex, popcontext);\n    if (type == \";\") return cont();\n    if (type == \"if\") {\n      if (cx.state.lexical.info == \"else\" && cx.state.cc[cx.state.cc.length - 1] == poplex)\n        cx.state.cc.pop()();\n      return cont(pushlex(\"form\"), parenExpr, statement, poplex, maybeelse);\n    }\n    if (type == \"function\") return cont(functiondef);\n    if (type == \"for\") return cont(pushlex(\"form\"), forspec, statement, poplex);\n    if (type == \"class\" || (isTS && value == \"interface\")) {\n      cx.marked = \"keyword\"\n      return cont(pushlex(\"form\", type == \"class\" ? type : value), className, poplex)\n    }\n    if (type == \"variable\") {\n      if (isTS && value == \"declare\") {\n        cx.marked = \"keyword\"\n        return cont(statement)\n      } else if (isTS && (value == \"module\" || value == \"enum\" || value == \"type\") && cx.stream.match(/^\\s*\\w/, false)) {\n        cx.marked = \"keyword\"\n        if (value == \"enum\") return cont(enumdef);\n        else if (value == \"type\") return cont(typename, expect(\"operator\"), typeexpr, expect(\";\"));\n        else return cont(pushlex(\"form\"), pattern, expect(\"{\"), pushlex(\"}\"), block, poplex, poplex)\n      } else if (isTS && value == \"namespace\") {\n        cx.marked = \"keyword\"\n        return cont(pushlex(\"form\"), expression, statement, poplex)\n      } else if (isTS && value == \"abstract\") {\n        cx.marked = \"keyword\"\n        return cont(statement)\n      } else {\n        return cont(pushlex(\"stat\"), maybelabel);\n      }\n    }\n    if (type == \"switch\") return cont(pushlex(\"form\"), parenExpr, expect(\"{\"), pushlex(\"}\", \"switch\"), pushblockcontext,\n                                      block, poplex, poplex, popcontext);\n    if (type == \"case\") return cont(expression, expect(\":\"));\n    if (type == \"default\") return cont(expect(\":\"));\n    if (type == \"catch\") return cont(pushlex(\"form\"), pushcontext, maybeCatchBinding, statement, poplex, popcontext);\n    if (type == \"export\") return cont(pushlex(\"stat\"), afterExport, poplex);\n    if (type == \"import\") return cont(pushlex(\"stat\"), afterImport, poplex);\n    if (type == \"async\") return cont(statement)\n    if (value == \"@\") return cont(expression, statement)\n    return pass(pushlex(\"stat\"), expression, expect(\";\"), poplex);\n  }\n  function maybeCatchBinding(type) {\n    if (type == \"(\") return cont(funarg, expect(\")\"))\n  }\n  function expression(type, value) {\n    return expressionInner(type, value, false);\n  }\n  function expressionNoComma(type, value) {\n    return expressionInner(type, value, true);\n  }\n  function parenExpr(type) {\n    if (type != \"(\") return pass()\n    return cont(pushlex(\")\"), maybeexpression, expect(\")\"), poplex)\n  }\n  function expressionInner(type, value, noComma) {\n    if (cx.state.fatArrowAt == cx.stream.start) {\n      var body = noComma ? arrowBodyNoComma : arrowBody;\n      if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, expect(\"=>\"), body, popcontext);\n      else if (type == \"variable\") return pass(pushcontext, pattern, expect(\"=>\"), body, popcontext);\n    }\n\n    var maybeop = noComma ? maybeoperatorNoComma : maybeoperatorComma;\n    if (atomicTypes.hasOwnProperty(type)) return cont(maybeop);\n    if (type == \"function\") return cont(functiondef, maybeop);\n    if (type == \"class\" || (isTS && value == \"interface\")) { cx.marked = \"keyword\"; return cont(pushlex(\"form\"), classExpression, poplex); }\n    if (type == \"keyword c\" || type == \"async\") return cont(noComma ? expressionNoComma : expression);\n    if (type == \"(\") return cont(pushlex(\")\"), maybeexpression, expect(\")\"), poplex, maybeop);\n    if (type == \"operator\" || type == \"spread\") return cont(noComma ? expressionNoComma : expression);\n    if (type == \"[\") return cont(pushlex(\"]\"), arrayLiteral, poplex, maybeop);\n    if (type == \"{\") return contCommasep(objprop, \"}\", null, maybeop);\n    if (type == \"quasi\") return pass(quasi, maybeop);\n    if (type == \"new\") return cont(maybeTarget(noComma));\n    if (type == \"import\") return cont(expression);\n    return cont();\n  }\n  function maybeexpression(type) {\n    if (type.match(/[;\\}\\)\\],]/)) return pass();\n    return pass(expression);\n  }\n\n  function maybeoperatorComma(type, value) {\n    if (type == \",\") return cont(maybeexpression);\n    return maybeoperatorNoComma(type, value, false);\n  }\n  function maybeoperatorNoComma(type, value, noComma) {\n    var me = noComma == false ? maybeoperatorComma : maybeoperatorNoComma;\n    var expr = noComma == false ? expression : expressionNoComma;\n    if (type == \"=>\") return cont(pushcontext, noComma ? arrowBodyNoComma : arrowBody, popcontext);\n    if (type == \"operator\") {\n      if (/\\+\\+|--/.test(value) || isTS && value == \"!\") return cont(me);\n      if (isTS && value == \"<\" && cx.stream.match(/^([^<>]|<[^<>]*>)*>\\s*\\(/, false))\n        return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, me);\n      if (value == \"?\") return cont(expression, expect(\":\"), expr);\n      return cont(expr);\n    }\n    if (type == \"quasi\") { return pass(quasi, me); }\n    if (type == \";\") return;\n    if (type == \"(\") return contCommasep(expressionNoComma, \")\", \"call\", me);\n    if (type == \".\") return cont(property, me);\n    if (type == \"[\") return cont(pushlex(\"]\"), maybeexpression, expect(\"]\"), poplex, me);\n    if (isTS && value == \"as\") { cx.marked = \"keyword\"; return cont(typeexpr, me) }\n    if (type == \"regexp\") {\n      cx.state.lastType = cx.marked = \"operator\"\n      cx.stream.backUp(cx.stream.pos - cx.stream.start - 1)\n      return cont(expr)\n    }\n  }\n  function quasi(type, value) {\n    if (type != \"quasi\") return pass();\n    if (value.slice(value.length - 2) != \"${\") return cont(quasi);\n    return cont(expression, continueQuasi);\n  }\n  function continueQuasi(type) {\n    if (type == \"}\") {\n      cx.marked = \"string-2\";\n      cx.state.tokenize = tokenQuasi;\n      return cont(quasi);\n    }\n  }\n  function arrowBody(type) {\n    findFatArrow(cx.stream, cx.state);\n    return pass(type == \"{\" ? statement : expression);\n  }\n  function arrowBodyNoComma(type) {\n    findFatArrow(cx.stream, cx.state);\n    return pass(type == \"{\" ? statement : expressionNoComma);\n  }\n  function maybeTarget(noComma) {\n    return function(type) {\n      if (type == \".\") return cont(noComma ? targetNoComma : target);\n      else if (type == \"variable\" && isTS) return cont(maybeTypeArgs, noComma ? maybeoperatorNoComma : maybeoperatorComma)\n      else return pass(noComma ? expressionNoComma : expression);\n    };\n  }\n  function target(_, value) {\n    if (value == \"target\") { cx.marked = \"keyword\"; return cont(maybeoperatorComma); }\n  }\n  function targetNoComma(_, value) {\n    if (value == \"target\") { cx.marked = \"keyword\"; return cont(maybeoperatorNoComma); }\n  }\n  function maybelabel(type) {\n    if (type == \":\") return cont(poplex, statement);\n    return pass(maybeoperatorComma, expect(\";\"), poplex);\n  }\n  function property(type) {\n    if (type == \"variable\") {cx.marked = \"property\"; return cont();}\n  }\n  function objprop(type, value) {\n    if (type == \"async\") {\n      cx.marked = \"property\";\n      return cont(objprop);\n    } else if (type == \"variable\" || cx.style == \"keyword\") {\n      cx.marked = \"property\";\n      if (value == \"get\" || value == \"set\") return cont(getterSetter);\n      var m // Work around fat-arrow-detection complication for detecting typescript typed arrow params\n      if (isTS && cx.state.fatArrowAt == cx.stream.start && (m = cx.stream.match(/^\\s*:\\s*/, false)))\n        cx.state.fatArrowAt = cx.stream.pos + m[0].length\n      return cont(afterprop);\n    } else if (type == \"number\" || type == \"string\") {\n      cx.marked = jsonldMode ? \"property\" : (cx.style + \" property\");\n      return cont(afterprop);\n    } else if (type == \"jsonld-keyword\") {\n      return cont(afterprop);\n    } else if (isTS && isModifier(value)) {\n      cx.marked = \"keyword\"\n      return cont(objprop)\n    } else if (type == \"[\") {\n      return cont(expression, maybetype, expect(\"]\"), afterprop);\n    } else if (type == \"spread\") {\n      return cont(expressionNoComma, afterprop);\n    } else if (value == \"*\") {\n      cx.marked = \"keyword\";\n      return cont(objprop);\n    } else if (type == \":\") {\n      return pass(afterprop)\n    }\n  }\n  function getterSetter(type) {\n    if (type != \"variable\") return pass(afterprop);\n    cx.marked = \"property\";\n    return cont(functiondef);\n  }\n  function afterprop(type) {\n    if (type == \":\") return cont(expressionNoComma);\n    if (type == \"(\") return pass(functiondef);\n  }\n  function commasep(what, end, sep) {\n    function proceed(type, value) {\n      if (sep ? sep.indexOf(type) > -1 : type == \",\") {\n        var lex = cx.state.lexical;\n        if (lex.info == \"call\") lex.pos = (lex.pos || 0) + 1;\n        return cont(function(type, value) {\n          if (type == end || value == end) return pass()\n          return pass(what)\n        }, proceed);\n      }\n      if (type == end || value == end) return cont();\n      if (sep && sep.indexOf(\";\") > -1) return pass(what)\n      return cont(expect(end));\n    }\n    return function(type, value) {\n      if (type == end || value == end) return cont();\n      return pass(what, proceed);\n    };\n  }\n  function contCommasep(what, end, info) {\n    for (var i = 3; i < arguments.length; i++)\n      cx.cc.push(arguments[i]);\n    return cont(pushlex(end, info), commasep(what, end), poplex);\n  }\n  function block(type) {\n    if (type == \"}\") return cont();\n    return pass(statement, block);\n  }\n  function maybetype(type, value) {\n    if (isTS) {\n      if (type == \":\") return cont(typeexpr);\n      if (value == \"?\") return cont(maybetype);\n    }\n  }\n  function maybetypeOrIn(type, value) {\n    if (isTS && (type == \":\" || value == \"in\")) return cont(typeexpr)\n  }\n  function mayberettype(type) {\n    if (isTS && type == \":\") {\n      if (cx.stream.match(/^\\s*\\w+\\s+is\\b/, false)) return cont(expression, isKW, typeexpr)\n      else return cont(typeexpr)\n    }\n  }\n  function isKW(_, value) {\n    if (value == \"is\") {\n      cx.marked = \"keyword\"\n      return cont()\n    }\n  }\n  function typeexpr(type, value) {\n    if (value == \"keyof\" || value == \"typeof\" || value == \"infer\") {\n      cx.marked = \"keyword\"\n      return cont(value == \"typeof\" ? expressionNoComma : typeexpr)\n    }\n    if (type == \"variable\" || value == \"void\") {\n      cx.marked = \"type\"\n      return cont(afterType)\n    }\n    if (value == \"|\" || value == \"&\") return cont(typeexpr)\n    if (type == \"string\" || type == \"number\" || type == \"atom\") return cont(afterType);\n    if (type == \"[\") return cont(pushlex(\"]\"), commasep(typeexpr, \"]\", \",\"), poplex, afterType)\n    if (type == \"{\") return cont(pushlex(\"}\"), commasep(typeprop, \"}\", \",;\"), poplex, afterType)\n    if (type == \"(\") return cont(commasep(typearg, \")\"), maybeReturnType, afterType)\n    if (type == \"<\") return cont(commasep(typeexpr, \">\"), typeexpr)\n  }\n  function maybeReturnType(type) {\n    if (type == \"=>\") return cont(typeexpr)\n  }\n  function typeprop(type, value) {\n    if (type == \"variable\" || cx.style == \"keyword\") {\n      cx.marked = \"property\"\n      return cont(typeprop)\n    } else if (value == \"?\" || type == \"number\" || type == \"string\") {\n      return cont(typeprop)\n    } else if (type == \":\") {\n      return cont(typeexpr)\n    } else if (type == \"[\") {\n      return cont(expect(\"variable\"), maybetypeOrIn, expect(\"]\"), typeprop)\n    } else if (type == \"(\") {\n      return pass(functiondecl, typeprop)\n    }\n  }\n  function typearg(type, value) {\n    if (type == \"variable\" && cx.stream.match(/^\\s*[?:]/, false) || value == \"?\") return cont(typearg)\n    if (type == \":\") return cont(typeexpr)\n    if (type == \"spread\") return cont(typearg)\n    return pass(typeexpr)\n  }\n  function afterType(type, value) {\n    if (value == \"<\") return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, afterType)\n    if (value == \"|\" || type == \".\" || value == \"&\") return cont(typeexpr)\n    if (type == \"[\") return cont(typeexpr, expect(\"]\"), afterType)\n    if (value == \"extends\" || value == \"implements\") { cx.marked = \"keyword\"; return cont(typeexpr) }\n    if (value == \"?\") return cont(typeexpr, expect(\":\"), typeexpr)\n  }\n  function maybeTypeArgs(_, value) {\n    if (value == \"<\") return cont(pushlex(\">\"), commasep(typeexpr, \">\"), poplex, afterType)\n  }\n  function typeparam() {\n    return pass(typeexpr, maybeTypeDefault)\n  }\n  function maybeTypeDefault(_, value) {\n    if (value == \"=\") return cont(typeexpr)\n  }\n  function vardef(_, value) {\n    if (value == \"enum\") {cx.marked = \"keyword\"; return cont(enumdef)}\n    return pass(pattern, maybetype, maybeAssign, vardefCont);\n  }\n  function pattern(type, value) {\n    if (isTS && isModifier(value)) { cx.marked = \"keyword\"; return cont(pattern) }\n    if (type == \"variable\") { register(value); return cont(); }\n    if (type == \"spread\") return cont(pattern);\n    if (type == \"[\") return contCommasep(eltpattern, \"]\");\n    if (type == \"{\") return contCommasep(proppattern, \"}\");\n  }\n  function proppattern(type, value) {\n    if (type == \"variable\" && !cx.stream.match(/^\\s*:/, false)) {\n      register(value);\n      return cont(maybeAssign);\n    }\n    if (type == \"variable\") cx.marked = \"property\";\n    if (type == \"spread\") return cont(pattern);\n    if (type == \"}\") return pass();\n    if (type == \"[\") return cont(expression, expect(']'), expect(':'), proppattern);\n    return cont(expect(\":\"), pattern, maybeAssign);\n  }\n  function eltpattern() {\n    return pass(pattern, maybeAssign)\n  }\n  function maybeAssign(_type, value) {\n    if (value == \"=\") return cont(expressionNoComma);\n  }\n  function vardefCont(type) {\n    if (type == \",\") return cont(vardef);\n  }\n  function maybeelse(type, value) {\n    if (type == \"keyword b\" && value == \"else\") return cont(pushlex(\"form\", \"else\"), statement, poplex);\n  }\n  function forspec(type, value) {\n    if (value == \"await\") return cont(forspec);\n    if (type == \"(\") return cont(pushlex(\")\"), forspec1, poplex);\n  }\n  function forspec1(type) {\n    if (type == \"var\") return cont(vardef, forspec2);\n    if (type == \"variable\") return cont(forspec2);\n    return pass(forspec2)\n  }\n  function forspec2(type, value) {\n    if (type == \")\") return cont()\n    if (type == \";\") return cont(forspec2)\n    if (value == \"in\" || value == \"of\") { cx.marked = \"keyword\"; return cont(expression, forspec2) }\n    return pass(expression, forspec2)\n  }\n  function functiondef(type, value) {\n    if (value == \"*\") {cx.marked = \"keyword\"; return cont(functiondef);}\n    if (type == \"variable\") {register(value); return cont(functiondef);}\n    if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, mayberettype, statement, popcontext);\n    if (isTS && value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, functiondef)\n  }\n  function functiondecl(type, value) {\n    if (value == \"*\") {cx.marked = \"keyword\"; return cont(functiondecl);}\n    if (type == \"variable\") {register(value); return cont(functiondecl);}\n    if (type == \"(\") return cont(pushcontext, pushlex(\")\"), commasep(funarg, \")\"), poplex, mayberettype, popcontext);\n    if (isTS && value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, functiondecl)\n  }\n  function typename(type, value) {\n    if (type == \"keyword\" || type == \"variable\") {\n      cx.marked = \"type\"\n      return cont(typename)\n    } else if (value == \"<\") {\n      return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex)\n    }\n  }\n  function funarg(type, value) {\n    if (value == \"@\") cont(expression, funarg)\n    if (type == \"spread\") return cont(funarg);\n    if (isTS && isModifier(value)) { cx.marked = \"keyword\"; return cont(funarg); }\n    if (isTS && type == \"this\") return cont(maybetype, maybeAssign)\n    return pass(pattern, maybetype, maybeAssign);\n  }\n  function classExpression(type, value) {\n    // Class expressions may have an optional name.\n    if (type == \"variable\") return className(type, value);\n    return classNameAfter(type, value);\n  }\n  function className(type, value) {\n    if (type == \"variable\") {register(value); return cont(classNameAfter);}\n  }\n  function classNameAfter(type, value) {\n    if (value == \"<\") return cont(pushlex(\">\"), commasep(typeparam, \">\"), poplex, classNameAfter)\n    if (value == \"extends\" || value == \"implements\" || (isTS && type == \",\")) {\n      if (value == \"implements\") cx.marked = \"keyword\";\n      return cont(isTS ? typeexpr : expression, classNameAfter);\n    }\n    if (type == \"{\") return cont(pushlex(\"}\"), classBody, poplex);\n  }\n  function classBody(type, value) {\n    if (type == \"async\" ||\n        (type == \"variable\" &&\n         (value == \"static\" || value == \"get\" || value == \"set\" || (isTS && isModifier(value))) &&\n         cx.stream.match(/^\\s+[\\w$\\xa1-\\uffff]/, false))) {\n      cx.marked = \"keyword\";\n      return cont(classBody);\n    }\n    if (type == \"variable\" || cx.style == \"keyword\") {\n      cx.marked = \"property\";\n      return cont(classfield, classBody);\n    }\n    if (type == \"number\" || type == \"string\") return cont(classfield, classBody);\n    if (type == \"[\")\n      return cont(expression, maybetype, expect(\"]\"), classfield, classBody)\n    if (value == \"*\") {\n      cx.marked = \"keyword\";\n      return cont(classBody);\n    }\n    if (isTS && type == \"(\") return pass(functiondecl, classBody)\n    if (type == \";\" || type == \",\") return cont(classBody);\n    if (type == \"}\") return cont();\n    if (value == \"@\") return cont(expression, classBody)\n  }\n  function classfield(type, value) {\n    if (value == \"?\") return cont(classfield)\n    if (type == \":\") return cont(typeexpr, maybeAssign)\n    if (value == \"=\") return cont(expressionNoComma)\n    var context = cx.state.lexical.prev, isInterface = context && context.info == \"interface\"\n    return pass(isInterface ? functiondecl : functiondef)\n  }\n  function afterExport(type, value) {\n    if (value == \"*\") { cx.marked = \"keyword\"; return cont(maybeFrom, expect(\";\")); }\n    if (value == \"default\") { cx.marked = \"keyword\"; return cont(expression, expect(\";\")); }\n    if (type == \"{\") return cont(commasep(exportField, \"}\"), maybeFrom, expect(\";\"));\n    return pass(statement);\n  }\n  function exportField(type, value) {\n    if (value == \"as\") { cx.marked = \"keyword\"; return cont(expect(\"variable\")); }\n    if (type == \"variable\") return pass(expressionNoComma, exportField);\n  }\n  function afterImport(type) {\n    if (type == \"string\") return cont();\n    if (type == \"(\") return pass(expression);\n    return pass(importSpec, maybeMoreImports, maybeFrom);\n  }\n  function importSpec(type, value) {\n    if (type == \"{\") return contCommasep(importSpec, \"}\");\n    if (type == \"variable\") register(value);\n    if (value == \"*\") cx.marked = \"keyword\";\n    return cont(maybeAs);\n  }\n  function maybeMoreImports(type) {\n    if (type == \",\") return cont(importSpec, maybeMoreImports)\n  }\n  function maybeAs(_type, value) {\n    if (value == \"as\") { cx.marked = \"keyword\"; return cont(importSpec); }\n  }\n  function maybeFrom(_type, value) {\n    if (value == \"from\") { cx.marked = \"keyword\"; return cont(expression); }\n  }\n  function arrayLiteral(type) {\n    if (type == \"]\") return cont();\n    return pass(commasep(expressionNoComma, \"]\"));\n  }\n  function enumdef() {\n    return pass(pushlex(\"form\"), pattern, expect(\"{\"), pushlex(\"}\"), commasep(enummember, \"}\"), poplex, poplex)\n  }\n  function enummember() {\n    return pass(pattern, maybeAssign);\n  }\n\n  function isContinuedStatement(state, textAfter) {\n    return state.lastType == \"operator\" || state.lastType == \",\" ||\n      isOperatorChar.test(textAfter.charAt(0)) ||\n      /[,.]/.test(textAfter.charAt(0));\n  }\n\n  function expressionAllowed(stream, state, backUp) {\n    return state.tokenize == tokenBase &&\n      /^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\\[{}\\(,;:]|=>)$/.test(state.lastType) ||\n      (state.lastType == \"quasi\" && /\\{\\s*$/.test(stream.string.slice(0, stream.pos - (backUp || 0))))\n  }\n\n  // Interface\n\n  return {\n    startState: function(basecolumn) {\n      var state = {\n        tokenize: tokenBase,\n        lastType: \"sof\",\n        cc: [],\n        lexical: new JSLexical((basecolumn || 0) - indentUnit, 0, \"block\", false),\n        localVars: parserConfig.localVars,\n        context: parserConfig.localVars && new Context(null, null, false),\n        indented: basecolumn || 0\n      };\n      if (parserConfig.globalVars && typeof parserConfig.globalVars == \"object\")\n        state.globalVars = parserConfig.globalVars;\n      return state;\n    },\n\n    token: function(stream, state) {\n      if (stream.sol()) {\n        if (!state.lexical.hasOwnProperty(\"align\"))\n          state.lexical.align = false;\n        state.indented = stream.indentation();\n        findFatArrow(stream, state);\n      }\n      if (state.tokenize != tokenComment && stream.eatSpace()) return null;\n      var style = state.tokenize(stream, state);\n      if (type == \"comment\") return style;\n      state.lastType = type == \"operator\" && (content == \"++\" || content == \"--\") ? \"incdec\" : type;\n      return parseJS(state, style, type, content, stream);\n    },\n\n    indent: function(state, textAfter) {\n      if (state.tokenize == tokenComment) return CodeMirror.Pass;\n      if (state.tokenize != tokenBase) return 0;\n      var firstChar = textAfter && textAfter.charAt(0), lexical = state.lexical, top\n      // Kludge to prevent 'maybelse' from blocking lexical scope pops\n      if (!/^\\s*else\\b/.test(textAfter)) for (var i = state.cc.length - 1; i >= 0; --i) {\n        var c = state.cc[i];\n        if (c == poplex) lexical = lexical.prev;\n        else if (c != maybeelse) break;\n      }\n      while ((lexical.type == \"stat\" || lexical.type == \"form\") &&\n             (firstChar == \"}\" || ((top = state.cc[state.cc.length - 1]) &&\n                                   (top == maybeoperatorComma || top == maybeoperatorNoComma) &&\n                                   !/^[,\\.=+\\-*:?[\\(]/.test(textAfter))))\n        lexical = lexical.prev;\n      if (statementIndent && lexical.type == \")\" && lexical.prev.type == \"stat\")\n        lexical = lexical.prev;\n      var type = lexical.type, closing = firstChar == type;\n\n      if (type == \"vardef\") return lexical.indented + (state.lastType == \"operator\" || state.lastType == \",\" ? lexical.info.length + 1 : 0);\n      else if (type == \"form\" && firstChar == \"{\") return lexical.indented;\n      else if (type == \"form\") return lexical.indented + indentUnit;\n      else if (type == \"stat\")\n        return lexical.indented + (isContinuedStatement(state, textAfter) ? statementIndent || indentUnit : 0);\n      else if (lexical.info == \"switch\" && !closing && parserConfig.doubleIndentSwitch != false)\n        return lexical.indented + (/^(?:case|default)\\b/.test(textAfter) ? indentUnit : 2 * indentUnit);\n      else if (lexical.align) return lexical.column + (closing ? 0 : 1);\n      else return lexical.indented + (closing ? 0 : indentUnit);\n    },\n\n    electricInput: /^\\s*(?:case .*?:|default:|\\{|\\})$/,\n    blockCommentStart: jsonMode ? null : \"/*\",\n    blockCommentEnd: jsonMode ? null : \"*/\",\n    blockCommentContinue: jsonMode ? null : \" * \",\n    lineComment: jsonMode ? null : \"//\",\n    fold: \"brace\",\n    closeBrackets: \"()[]{}''\\\"\\\"``\",\n\n    helperType: jsonMode ? \"json\" : \"javascript\",\n    jsonldMode: jsonldMode,\n    jsonMode: jsonMode,\n\n    expressionAllowed: expressionAllowed,\n\n    skipExpression: function(state) {\n      var top = state.cc[state.cc.length - 1]\n      if (top == expression || top == expressionNoComma) state.cc.pop()\n    }\n  };\n});\n\nCodeMirror.registerHelper(\"wordChars\", \"javascript\", /[\\w$]/);\n\nCodeMirror.defineMIME(\"text/javascript\", \"javascript\");\nCodeMirror.defineMIME(\"text/ecmascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/javascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/x-javascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/ecmascript\", \"javascript\");\nCodeMirror.defineMIME(\"application/json\", {name: \"javascript\", json: true});\nCodeMirror.defineMIME(\"application/x-json\", {name: \"javascript\", json: true});\nCodeMirror.defineMIME(\"application/ld+json\", {name: \"javascript\", jsonld: true});\nCodeMirror.defineMIME(\"text/typescript\", { name: \"javascript\", typescript: true });\nCodeMirror.defineMIME(\"application/typescript\", { name: \"javascript\", typescript: true });\n\n});\n","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n(function(mod) {\n  if (typeof exports == \"object\" && typeof module == \"object\") // CommonJS\n    mod(require(\"../../lib/codemirror\"));\n  else if (typeof define == \"function\" && define.amd) // AMD\n    define([\"../../lib/codemirror\"], mod);\n  else // Plain browser env\n    mod(CodeMirror);\n})(function(CodeMirror) {\n\"use strict\";\n\nvar htmlConfig = {\n  autoSelfClosers: {'area': true, 'base': true, 'br': true, 'col': true, 'command': true,\n                    'embed': true, 'frame': true, 'hr': true, 'img': true, 'input': true,\n                    'keygen': true, 'link': true, 'meta': true, 'param': true, 'source': true,\n                    'track': true, 'wbr': true, 'menuitem': true},\n  implicitlyClosed: {'dd': true, 'li': true, 'optgroup': true, 'option': true, 'p': true,\n                     'rp': true, 'rt': true, 'tbody': true, 'td': true, 'tfoot': true,\n                     'th': true, 'tr': true},\n  contextGrabbers: {\n    'dd': {'dd': true, 'dt': true},\n    'dt': {'dd': true, 'dt': true},\n    'li': {'li': true},\n    'option': {'option': true, 'optgroup': true},\n    'optgroup': {'optgroup': true},\n    'p': {'address': true, 'article': true, 'aside': true, 'blockquote': true, 'dir': true,\n          'div': true, 'dl': true, 'fieldset': true, 'footer': true, 'form': true,\n          'h1': true, 'h2': true, 'h3': true, 'h4': true, 'h5': true, 'h6': true,\n          'header': true, 'hgroup': true, 'hr': true, 'menu': true, 'nav': true, 'ol': true,\n          'p': true, 'pre': true, 'section': true, 'table': true, 'ul': true},\n    'rp': {'rp': true, 'rt': true},\n    'rt': {'rp': true, 'rt': true},\n    'tbody': {'tbody': true, 'tfoot': true},\n    'td': {'td': true, 'th': true},\n    'tfoot': {'tbody': true},\n    'th': {'td': true, 'th': true},\n    'thead': {'tbody': true, 'tfoot': true},\n    'tr': {'tr': true}\n  },\n  doNotIndent: {\"pre\": true},\n  allowUnquoted: true,\n  allowMissing: true,\n  caseFold: true\n}\n\nvar xmlConfig = {\n  autoSelfClosers: {},\n  implicitlyClosed: {},\n  contextGrabbers: {},\n  doNotIndent: {},\n  allowUnquoted: false,\n  allowMissing: false,\n  allowMissingTagName: false,\n  caseFold: false\n}\n\nCodeMirror.defineMode(\"xml\", function(editorConf, config_) {\n  var indentUnit = editorConf.indentUnit\n  var config = {}\n  var defaults = config_.htmlMode ? htmlConfig : xmlConfig\n  for (var prop in defaults) config[prop] = defaults[prop]\n  for (var prop in config_) config[prop] = config_[prop]\n\n  // Return variables for tokenizers\n  var type, setStyle;\n\n  function inText(stream, state) {\n    function chain(parser) {\n      state.tokenize = parser;\n      return parser(stream, state);\n    }\n\n    var ch = stream.next();\n    if (ch == \"<\") {\n      if (stream.eat(\"!\")) {\n        if (stream.eat(\"[\")) {\n          if (stream.match(\"CDATA[\")) return chain(inBlock(\"atom\", \"]]>\"));\n          else return null;\n        } else if (stream.match(\"--\")) {\n          return chain(inBlock(\"comment\", \"-->\"));\n        } else if (stream.match(\"DOCTYPE\", true, true)) {\n          stream.eatWhile(/[\\w\\._\\-]/);\n          return chain(doctype(1));\n        } else {\n          return null;\n        }\n      } else if (stream.eat(\"?\")) {\n        stream.eatWhile(/[\\w\\._\\-]/);\n        state.tokenize = inBlock(\"meta\", \"?>\");\n        return \"meta\";\n      } else {\n        type = stream.eat(\"/\") ? \"closeTag\" : \"openTag\";\n        state.tokenize = inTag;\n        return \"tag bracket\";\n      }\n    } else if (ch == \"&\") {\n      var ok;\n      if (stream.eat(\"#\")) {\n        if (stream.eat(\"x\")) {\n          ok = stream.eatWhile(/[a-fA-F\\d]/) && stream.eat(\";\");\n        } else {\n          ok = stream.eatWhile(/[\\d]/) && stream.eat(\";\");\n        }\n      } else {\n        ok = stream.eatWhile(/[\\w\\.\\-:]/) && stream.eat(\";\");\n      }\n      return ok ? \"atom\" : \"error\";\n    } else {\n      stream.eatWhile(/[^&<]/);\n      return null;\n    }\n  }\n  inText.isInText = true;\n\n  function inTag(stream, state) {\n    var ch = stream.next();\n    if (ch == \">\" || (ch == \"/\" && stream.eat(\">\"))) {\n      state.tokenize = inText;\n      type = ch == \">\" ? \"endTag\" : \"selfcloseTag\";\n      return \"tag bracket\";\n    } else if (ch == \"=\") {\n      type = \"equals\";\n      return null;\n    } else if (ch == \"<\") {\n      state.tokenize = inText;\n      state.state = baseState;\n      state.tagName = state.tagStart = null;\n      var next = state.tokenize(stream, state);\n      return next ? next + \" tag error\" : \"tag error\";\n    } else if (/[\\'\\\"]/.test(ch)) {\n      state.tokenize = inAttribute(ch);\n      state.stringStartCol = stream.column();\n      return state.tokenize(stream, state);\n    } else {\n      stream.match(/^[^\\s\\u00a0=<>\\\"\\']*[^\\s\\u00a0=<>\\\"\\'\\/]/);\n      return \"word\";\n    }\n  }\n\n  function inAttribute(quote) {\n    var closure = function(stream, state) {\n      while (!stream.eol()) {\n        if (stream.next() == quote) {\n          state.tokenize = inTag;\n          break;\n        }\n      }\n      return \"string\";\n    };\n    closure.isInAttribute = true;\n    return closure;\n  }\n\n  function inBlock(style, terminator) {\n    return function(stream, state) {\n      while (!stream.eol()) {\n        if (stream.match(terminator)) {\n          state.tokenize = inText;\n          break;\n        }\n        stream.next();\n      }\n      return style;\n    }\n  }\n\n  function doctype(depth) {\n    return function(stream, state) {\n      var ch;\n      while ((ch = stream.next()) != null) {\n        if (ch == \"<\") {\n          state.tokenize = doctype(depth + 1);\n          return state.tokenize(stream, state);\n        } else if (ch == \">\") {\n          if (depth == 1) {\n            state.tokenize = inText;\n            break;\n          } else {\n            state.tokenize = doctype(depth - 1);\n            return state.tokenize(stream, state);\n          }\n        }\n      }\n      return \"meta\";\n    };\n  }\n\n  function Context(state, tagName, startOfLine) {\n    this.prev = state.context;\n    this.tagName = tagName;\n    this.indent = state.indented;\n    this.startOfLine = startOfLine;\n    if (config.doNotIndent.hasOwnProperty(tagName) || (state.context && state.context.noIndent))\n      this.noIndent = true;\n  }\n  function popContext(state) {\n    if (state.context) state.context = state.context.prev;\n  }\n  function maybePopContext(state, nextTagName) {\n    var parentTagName;\n    while (true) {\n      if (!state.context) {\n        return;\n      }\n      parentTagName = state.context.tagName;\n      if (!config.contextGrabbers.hasOwnProperty(parentTagName) ||\n          !config.contextGrabbers[parentTagName].hasOwnProperty(nextTagName)) {\n        return;\n      }\n      popContext(state);\n    }\n  }\n\n  function baseState(type, stream, state) {\n    if (type == \"openTag\") {\n      state.tagStart = stream.column();\n      return tagNameState;\n    } else if (type == \"closeTag\") {\n      return closeTagNameState;\n    } else {\n      return baseState;\n    }\n  }\n  function tagNameState(type, stream, state) {\n    if (type == \"word\") {\n      state.tagName = stream.current();\n      setStyle = \"tag\";\n      return attrState;\n    } else if (config.allowMissingTagName && type == \"endTag\") {\n      setStyle = \"tag bracket\";\n      return attrState(type, stream, state);\n    } else {\n      setStyle = \"error\";\n      return tagNameState;\n    }\n  }\n  function closeTagNameState(type, stream, state) {\n    if (type == \"word\") {\n      var tagName = stream.current();\n      if (state.context && state.context.tagName != tagName &&\n          config.implicitlyClosed.hasOwnProperty(state.context.tagName))\n        popContext(state);\n      if ((state.context && state.context.tagName == tagName) || config.matchClosing === false) {\n        setStyle = \"tag\";\n        return closeState;\n      } else {\n        setStyle = \"tag error\";\n        return closeStateErr;\n      }\n    } else if (config.allowMissingTagName && type == \"endTag\") {\n      setStyle = \"tag bracket\";\n      return closeState(type, stream, state);\n    } else {\n      setStyle = \"error\";\n      return closeStateErr;\n    }\n  }\n\n  function closeState(type, _stream, state) {\n    if (type != \"endTag\") {\n      setStyle = \"error\";\n      return closeState;\n    }\n    popContext(state);\n    return baseState;\n  }\n  function closeStateErr(type, stream, state) {\n    setStyle = \"error\";\n    return closeState(type, stream, state);\n  }\n\n  function attrState(type, _stream, state) {\n    if (type == \"word\") {\n      setStyle = \"attribute\";\n      return attrEqState;\n    } else if (type == \"endTag\" || type == \"selfcloseTag\") {\n      var tagName = state.tagName, tagStart = state.tagStart;\n      state.tagName = state.tagStart = null;\n      if (type == \"selfcloseTag\" ||\n          config.autoSelfClosers.hasOwnProperty(tagName)) {\n        maybePopContext(state, tagName);\n      } else {\n        maybePopContext(state, tagName);\n        state.context = new Context(state, tagName, tagStart == state.indented);\n      }\n      return baseState;\n    }\n    setStyle = \"error\";\n    return attrState;\n  }\n  function attrEqState(type, stream, state) {\n    if (type == \"equals\") return attrValueState;\n    if (!config.allowMissing) setStyle = \"error\";\n    return attrState(type, stream, state);\n  }\n  function attrValueState(type, stream, state) {\n    if (type == \"string\") return attrContinuedState;\n    if (type == \"word\" && config.allowUnquoted) {setStyle = \"string\"; return attrState;}\n    setStyle = \"error\";\n    return attrState(type, stream, state);\n  }\n  function attrContinuedState(type, stream, state) {\n    if (type == \"string\") return attrContinuedState;\n    return attrState(type, stream, state);\n  }\n\n  return {\n    startState: function(baseIndent) {\n      var state = {tokenize: inText,\n                   state: baseState,\n                   indented: baseIndent || 0,\n                   tagName: null, tagStart: null,\n                   context: null}\n      if (baseIndent != null) state.baseIndent = baseIndent\n      return state\n    },\n\n    token: function(stream, state) {\n      if (!state.tagName && stream.sol())\n        state.indented = stream.indentation();\n\n      if (stream.eatSpace()) return null;\n      type = null;\n      var style = state.tokenize(stream, state);\n      if ((style || type) && style != \"comment\") {\n        setStyle = null;\n        state.state = state.state(type || style, stream, state);\n        if (setStyle)\n          style = setStyle == \"error\" ? style + \" error\" : setStyle;\n      }\n      return style;\n    },\n\n    indent: function(state, textAfter, fullLine) {\n      var context = state.context;\n      // Indent multi-line strings (e.g. css).\n      if (state.tokenize.isInAttribute) {\n        if (state.tagStart == state.indented)\n          return state.stringStartCol + 1;\n        else\n          return state.indented + indentUnit;\n      }\n      if (context && context.noIndent) return CodeMirror.Pass;\n      if (state.tokenize != inTag && state.tokenize != inText)\n        return fullLine ? fullLine.match(/^(\\s*)/)[0].length : 0;\n      // Indent the starts of attribute names.\n      if (state.tagName) {\n        if (config.multilineTagIndentPastTag !== false)\n          return state.tagStart + state.tagName.length + 2;\n        else\n          return state.tagStart + indentUnit * (config.multilineTagIndentFactor || 1);\n      }\n      if (config.alignCDATA && /<!\\[CDATA\\[/.test(textAfter)) return 0;\n      var tagAfter = textAfter && /^<(\\/)?([\\w_:\\.-]*)/.exec(textAfter);\n      if (tagAfter && tagAfter[1]) { // Closing tag spotted\n        while (context) {\n          if (context.tagName == tagAfter[2]) {\n            context = context.prev;\n            break;\n          } else if (config.implicitlyClosed.hasOwnProperty(context.tagName)) {\n            context = context.prev;\n          } else {\n            break;\n          }\n        }\n      } else if (tagAfter) { // Opening tag spotted\n        while (context) {\n          var grabbers = config.contextGrabbers[context.tagName];\n          if (grabbers && grabbers.hasOwnProperty(tagAfter[2]))\n            context = context.prev;\n          else\n            break;\n        }\n      }\n      while (context && context.prev && !context.startOfLine)\n        context = context.prev;\n      if (context) return context.indent + indentUnit;\n      else return state.baseIndent || 0;\n    },\n\n    electricInput: /<\\/[\\s\\w:]+>$/,\n    blockCommentStart: \"<!--\",\n    blockCommentEnd: \"-->\",\n\n    configuration: config.htmlMode ? \"html\" : \"xml\",\n    helperType: config.htmlMode ? \"html\" : \"xml\",\n\n    skipAttribute: function(state) {\n      if (state.state == attrValueState)\n        state.state = attrState\n    },\n\n    xmlCurrentTag: function(state) {\n      return state.tagName ? {name: state.tagName, close: state.type == \"closeTag\"} : null\n    },\n\n    xmlCurrentContext: function(state) {\n      var context = []\n      for (var cx = state.context; cx; cx = cx.prev)\n        if (cx.tagName) context.push(cx.tagName)\n      return context.reverse()\n    }\n  };\n});\n\nCodeMirror.defineMIME(\"text/xml\", \"xml\");\nCodeMirror.defineMIME(\"application/xml\", \"xml\");\nif (!CodeMirror.mimeModes.hasOwnProperty(\"text/html\"))\n  CodeMirror.defineMIME(\"text/html\", {name: \"xml\", htmlMode: true});\n\n});\n","import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport * as React from 'react';\nimport classNames from 'classnames';\nimport ReactIcon from './IconBase';\nimport { getTwoToneColor, setTwoToneColor } from './twoTonePrimaryColor';\nimport { normalizeTwoToneColors } from '../utils'; // Initial setting\n// should move it to antd main repo?\n\nsetTwoToneColor('#1890ff');\nvar Icon = React.forwardRef(function (props, ref) {\n  var className = props.className,\n      icon = props.icon,\n      spin = props.spin,\n      rotate = props.rotate,\n      tabIndex = props.tabIndex,\n      onClick = props.onClick,\n      twoToneColor = props.twoToneColor,\n      restProps = _objectWithoutProperties(props, [\"className\", \"icon\", \"spin\", \"rotate\", \"tabIndex\", \"onClick\", \"twoToneColor\"]);\n\n  var classString = classNames('anticon', _defineProperty({}, \"anticon-\".concat(icon.name), Boolean(icon.name)), className);\n  var svgClassString = classNames({\n    'anticon-spin': !!spin || icon.name === 'loading'\n  });\n  var iconTabIndex = tabIndex;\n\n  if (iconTabIndex === undefined && onClick) {\n    iconTabIndex = -1;\n  }\n\n  var svgStyle = rotate ? {\n    msTransform: \"rotate(\".concat(rotate, \"deg)\"),\n    transform: \"rotate(\".concat(rotate, \"deg)\")\n  } : undefined;\n\n  var _normalizeTwoToneColo = normalizeTwoToneColors(twoToneColor),\n      _normalizeTwoToneColo2 = _slicedToArray(_normalizeTwoToneColo, 2),\n      primaryColor = _normalizeTwoToneColo2[0],\n      secondaryColor = _normalizeTwoToneColo2[1];\n\n  return React.createElement(\"span\", Object.assign({\n    role: \"img\",\n    \"aria-label\": icon.name\n  }, restProps, {\n    ref: ref,\n    tabIndex: iconTabIndex,\n    onClick: onClick,\n    className: classString\n  }), React.createElement(ReactIcon, {\n    className: svgClassString,\n    icon: icon,\n    primaryColor: primaryColor,\n    secondaryColor: secondaryColor,\n    style: svgStyle\n  }));\n});\nIcon.displayName = 'AntdIcon';\nIcon.getTwoToneColor = getTwoToneColor;\nIcon.setTwoToneColor = setTwoToneColor;\nexport default Icon;","import _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport { generate, getSecondaryColor, isIconDefinition, warning, useInsertStyles } from '../utils';\nvar twoToneColorPalette = {\n  primaryColor: '#333',\n  secondaryColor: '#E6E6E6',\n  calculated: false\n};\n\nfunction setTwoToneColors(_ref) {\n  var primaryColor = _ref.primaryColor,\n      secondaryColor = _ref.secondaryColor;\n  twoToneColorPalette.primaryColor = primaryColor;\n  twoToneColorPalette.secondaryColor = secondaryColor || getSecondaryColor(primaryColor);\n  twoToneColorPalette.calculated = !!secondaryColor;\n}\n\nfunction getTwoToneColors() {\n  return _objectSpread({}, twoToneColorPalette);\n}\n\nvar IconBase = function IconBase(props) {\n  var icon = props.icon,\n      className = props.className,\n      onClick = props.onClick,\n      style = props.style,\n      primaryColor = props.primaryColor,\n      secondaryColor = props.secondaryColor,\n      restProps = _objectWithoutProperties(props, [\"icon\", \"className\", \"onClick\", \"style\", \"primaryColor\", \"secondaryColor\"]);\n\n  var colors = twoToneColorPalette;\n\n  if (primaryColor) {\n    colors = {\n      primaryColor: primaryColor,\n      secondaryColor: secondaryColor || getSecondaryColor(primaryColor)\n    };\n  }\n\n  useInsertStyles();\n  warning(isIconDefinition(icon), \"icon should be icon definiton, but got \".concat(icon));\n\n  if (!isIconDefinition(icon)) {\n    return null;\n  }\n\n  var target = icon;\n\n  if (target && typeof target.icon === 'function') {\n    target = _objectSpread(_objectSpread({}, target), {}, {\n      icon: target.icon(colors.primaryColor, colors.secondaryColor)\n    });\n  }\n\n  return generate(target.icon, \"svg-\".concat(target.name), _objectSpread({\n    className: className,\n    onClick: onClick,\n    style: style,\n    'data-icon': target.name,\n    width: '1em',\n    height: '1em',\n    fill: 'currentColor',\n    'aria-hidden': 'true'\n  }, restProps));\n};\n\nIconBase.displayName = 'IconReact';\nIconBase.getTwoToneColors = getTwoToneColors;\nIconBase.setTwoToneColors = setTwoToneColors;\nexport default IconBase;","/*\n* FileSaver.js\n* A saveAs() FileSaver implementation.\n*\n* By Eli Grey, http://eligrey.com\n*\n* License : https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md (MIT)\n* source  : http://purl.eligrey.com/github/FileSaver.js\n*/\n\n// The one and only way of getting global scope in all environments\n// https://stackoverflow.com/q/3277182/1008999\nvar _global = typeof window === 'object' && window.window === window\n  ? window : typeof self === 'object' && self.self === self\n  ? self : typeof global === 'object' && global.global === global\n  ? global\n  : this\n\nfunction bom (blob, opts) {\n  if (typeof opts === 'undefined') opts = { autoBom: false }\n  else if (typeof opts !== 'object') {\n    console.warn('Deprecated: Expected third argument to be a object')\n    opts = { autoBom: !opts }\n  }\n\n  // prepend BOM for UTF-8 XML and text/* types (including HTML)\n  // note: your browser will automatically convert UTF-16 U+FEFF to EF BB BF\n  if (opts.autoBom && /^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n    return new Blob([String.fromCharCode(0xFEFF), blob], { type: blob.type })\n  }\n  return blob\n}\n\nfunction download (url, name, opts) {\n  var xhr = new XMLHttpRequest()\n  xhr.open('GET', url)\n  xhr.responseType = 'blob'\n  xhr.onload = function () {\n    saveAs(xhr.response, name, opts)\n  }\n  xhr.onerror = function () {\n    console.error('could not download file')\n  }\n  xhr.send()\n}\n\nfunction corsEnabled (url) {\n  var xhr = new XMLHttpRequest()\n  // use sync to avoid popup blocker\n  xhr.open('HEAD', url, false)\n  try {\n    xhr.send()\n  } catch (e) {}\n  return xhr.status >= 200 && xhr.status <= 299\n}\n\n// `a.click()` doesn't work for all browsers (#465)\nfunction click (node) {\n  try {\n    node.dispatchEvent(new MouseEvent('click'))\n  } catch (e) {\n    var evt = document.createEvent('MouseEvents')\n    evt.initMouseEvent('click', true, true, window, 0, 0, 0, 80,\n                          20, false, false, false, false, 0, null)\n    node.dispatchEvent(evt)\n  }\n}\n\nvar saveAs = _global.saveAs || (\n  // probably in some web worker\n  (typeof window !== 'object' || window !== _global)\n    ? function saveAs () { /* noop */ }\n\n  // Use download attribute first if possible (#193 Lumia mobile)\n  : 'download' in HTMLAnchorElement.prototype\n  ? function saveAs (blob, name, opts) {\n    var URL = _global.URL || _global.webkitURL\n    var a = document.createElement('a')\n    name = name || blob.name || 'download'\n\n    a.download = name\n    a.rel = 'noopener' // tabnabbing\n\n    // TODO: detect chrome extensions & packaged apps\n    // a.target = '_blank'\n\n    if (typeof blob === 'string') {\n      // Support regular links\n      a.href = blob\n      if (a.origin !== location.origin) {\n        corsEnabled(a.href)\n          ? download(blob, name, opts)\n          : click(a, a.target = '_blank')\n      } else {\n        click(a)\n      }\n    } else {\n      // Support blobs\n      a.href = URL.createObjectURL(blob)\n      setTimeout(function () { URL.revokeObjectURL(a.href) }, 4E4) // 40s\n      setTimeout(function () { click(a) }, 0)\n    }\n  }\n\n  // Use msSaveOrOpenBlob as a second approach\n  : 'msSaveOrOpenBlob' in navigator\n  ? function saveAs (blob, name, opts) {\n    name = name || blob.name || 'download'\n\n    if (typeof blob === 'string') {\n      if (corsEnabled(blob)) {\n        download(blob, name, opts)\n      } else {\n        var a = document.createElement('a')\n        a.href = blob\n        a.target = '_blank'\n        setTimeout(function () { click(a) })\n      }\n    } else {\n      navigator.msSaveOrOpenBlob(bom(blob, opts), name)\n    }\n  }\n\n  // Fallback to using FileReader and a popup\n  : function saveAs (blob, name, opts, popup) {\n    // Open a popup immediately do go around popup blocker\n    // Mostly only available on user interaction and the fileReader is async so...\n    popup = popup || open('', '_blank')\n    if (popup) {\n      popup.document.title =\n      popup.document.body.innerText = 'downloading...'\n    }\n\n    if (typeof blob === 'string') return download(blob, name, opts)\n\n    var force = blob.type === 'application/octet-stream'\n    var isSafari = /constructor/i.test(_global.HTMLElement) || _global.safari\n    var isChromeIOS = /CriOS\\/[\\d]+/.test(navigator.userAgent)\n\n    if ((isChromeIOS || (force && isSafari)) && typeof FileReader === 'object') {\n      // Safari doesn't allow downloading of blob URLs\n      var reader = new FileReader()\n      reader.onloadend = function () {\n        var url = reader.result\n        url = isChromeIOS ? url : url.replace(/^data:[^;]*;/, 'data:attachment/file;')\n        if (popup) popup.location.href = url\n        else location = url\n        popup = null // reverse-tabnabbing #460\n      }\n      reader.readAsDataURL(blob)\n    } else {\n      var URL = _global.URL || _global.webkitURL\n      var url = URL.createObjectURL(blob)\n      if (popup) popup.location = url\n      else location.href = url\n      popup = null // reverse-tabnabbing #460\n      setTimeout(function () { URL.revokeObjectURL(url) }, 4E4) // 40s\n    }\n  }\n)\n\n_global.saveAs = saveAs.saveAs = saveAs\n\nif (typeof module !== 'undefined') {\n  module.exports = saveAs;\n}\n","import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport { generate as generateColor } from '@ant-design/colors';\nimport React, { useEffect } from 'react';\nimport warn from \"rc-util/es/warning\";\nimport { insertCss } from 'insert-css';\nexport function warning(valid, message) {\n  warn(valid, \"[@ant-design/icons] \".concat(message));\n}\nexport function isIconDefinition(target) {\n  return _typeof(target) === 'object' && typeof target.name === 'string' && typeof target.theme === 'string' && (_typeof(target.icon) === 'object' || typeof target.icon === 'function');\n}\nexport function normalizeAttrs() {\n  var attrs = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  return Object.keys(attrs).reduce(function (acc, key) {\n    var val = attrs[key];\n\n    switch (key) {\n      case 'class':\n        acc.className = val;\n        delete acc.class;\n        break;\n\n      default:\n        acc[key] = val;\n    }\n\n    return acc;\n  }, {});\n}\nexport function generate(node, key, rootProps) {\n  if (!rootProps) {\n    return React.createElement(node.tag, _objectSpread({\n      key: key\n    }, normalizeAttrs(node.attrs)), (node.children || []).map(function (child, index) {\n      return generate(child, \"\".concat(key, \"-\").concat(node.tag, \"-\").concat(index));\n    }));\n  }\n\n  return React.createElement(node.tag, _objectSpread(_objectSpread({\n    key: key\n  }, normalizeAttrs(node.attrs)), rootProps), (node.children || []).map(function (child, index) {\n    return generate(child, \"\".concat(key, \"-\").concat(node.tag, \"-\").concat(index));\n  }));\n}\nexport function getSecondaryColor(primaryColor) {\n  // choose the second color\n  return generateColor(primaryColor)[0];\n}\nexport function normalizeTwoToneColors(twoToneColor) {\n  if (!twoToneColor) {\n    return [];\n  }\n\n  return Array.isArray(twoToneColor) ? twoToneColor : [twoToneColor];\n} // These props make sure that the SVG behaviours like general text.\n// Reference: https://blog.prototypr.io/align-svg-icons-to-text-and-say-goodbye-to-font-icons-d44b3d7b26b4\n\nexport var svgBaseProps = {\n  width: '1em',\n  height: '1em',\n  fill: 'currentColor',\n  'aria-hidden': 'true',\n  focusable: 'false'\n};\nexport var iconStyles = \"\\n.anticon {\\n  display: inline-block;\\n  color: inherit;\\n  font-style: normal;\\n  line-height: 0;\\n  text-align: center;\\n  text-transform: none;\\n  vertical-align: -0.125em;\\n  text-rendering: optimizeLegibility;\\n  -webkit-font-smoothing: antialiased;\\n  -moz-osx-font-smoothing: grayscale;\\n}\\n\\n.anticon > * {\\n  line-height: 1;\\n}\\n\\n.anticon svg {\\n  display: inline-block;\\n}\\n\\n.anticon::before {\\n  display: none;\\n}\\n\\n.anticon .anticon-icon {\\n  display: block;\\n}\\n\\n.anticon[tabindex] {\\n  cursor: pointer;\\n}\\n\\n.anticon-spin::before,\\n.anticon-spin {\\n  display: inline-block;\\n  -webkit-animation: loadingCircle 1s infinite linear;\\n  animation: loadingCircle 1s infinite linear;\\n}\\n\\n@-webkit-keyframes loadingCircle {\\n  100% {\\n    -webkit-transform: rotate(360deg);\\n    transform: rotate(360deg);\\n  }\\n}\\n\\n@keyframes loadingCircle {\\n  100% {\\n    -webkit-transform: rotate(360deg);\\n    transform: rotate(360deg);\\n  }\\n}\\n\";\nvar cssInjectedFlag = false;\nexport var useInsertStyles = function useInsertStyles() {\n  var styleStr = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : iconStyles;\n  useEffect(function () {\n    if (!cssInjectedFlag) {\n      insertCss(styleStr, {\n        prepend: true\n      });\n      cssInjectedFlag = true;\n    }\n  }, []);\n};","// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n// This is CodeMirror (https://codemirror.net), a code editor\n// implemented in JavaScript on top of the browser's DOM.\n//\n// You can find some technical background for some of the code below\n// at http://marijnhaverbeke.nl/blog/#cm-internals .\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, global.CodeMirror = factory());\n}(this, (function () { 'use strict';\n\n  // Kludges for bugs and behavior differences that can't be feature\n  // detected are enabled based on userAgent etc sniffing.\n  var userAgent = navigator.userAgent;\n  var platform = navigator.platform;\n\n  var gecko = /gecko\\/\\d/i.test(userAgent);\n  var ie_upto10 = /MSIE \\d/.test(userAgent);\n  var ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(userAgent);\n  var edge = /Edge\\/(\\d+)/.exec(userAgent);\n  var ie = ie_upto10 || ie_11up || edge;\n  var ie_version = ie && (ie_upto10 ? document.documentMode || 6 : +(edge || ie_11up)[1]);\n  var webkit = !edge && /WebKit\\//.test(userAgent);\n  var qtwebkit = webkit && /Qt\\/\\d+\\.\\d+/.test(userAgent);\n  var chrome = !edge && /Chrome\\//.test(userAgent);\n  var presto = /Opera\\//.test(userAgent);\n  var safari = /Apple Computer/.test(navigator.vendor);\n  var mac_geMountainLion = /Mac OS X 1\\d\\D([8-9]|\\d\\d)\\D/.test(userAgent);\n  var phantom = /PhantomJS/.test(userAgent);\n\n  var ios = !edge && /AppleWebKit/.test(userAgent) && /Mobile\\/\\w+/.test(userAgent);\n  var android = /Android/.test(userAgent);\n  // This is woefully incomplete. Suggestions for alternative methods welcome.\n  var mobile = ios || android || /webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(userAgent);\n  var mac = ios || /Mac/.test(platform);\n  var chromeOS = /\\bCrOS\\b/.test(userAgent);\n  var windows = /win/i.test(platform);\n\n  var presto_version = presto && userAgent.match(/Version\\/(\\d*\\.\\d*)/);\n  if (presto_version) { presto_version = Number(presto_version[1]); }\n  if (presto_version && presto_version >= 15) { presto = false; webkit = true; }\n  // Some browsers use the wrong event properties to signal cmd/ctrl on OS X\n  var flipCtrlCmd = mac && (qtwebkit || presto && (presto_version == null || presto_version < 12.11));\n  var captureRightClick = gecko || (ie && ie_version >= 9);\n\n  function classTest(cls) { return new RegExp(\"(^|\\\\s)\" + cls + \"(?:$|\\\\s)\\\\s*\") }\n\n  var rmClass = function(node, cls) {\n    var current = node.className;\n    var match = classTest(cls).exec(current);\n    if (match) {\n      var after = current.slice(match.index + match[0].length);\n      node.className = current.slice(0, match.index) + (after ? match[1] + after : \"\");\n    }\n  };\n\n  function removeChildren(e) {\n    for (var count = e.childNodes.length; count > 0; --count)\n      { e.removeChild(e.firstChild); }\n    return e\n  }\n\n  function removeChildrenAndAdd(parent, e) {\n    return removeChildren(parent).appendChild(e)\n  }\n\n  function elt(tag, content, className, style) {\n    var e = document.createElement(tag);\n    if (className) { e.className = className; }\n    if (style) { e.style.cssText = style; }\n    if (typeof content == \"string\") { e.appendChild(document.createTextNode(content)); }\n    else if (content) { for (var i = 0; i < content.length; ++i) { e.appendChild(content[i]); } }\n    return e\n  }\n  // wrapper for elt, which removes the elt from the accessibility tree\n  function eltP(tag, content, className, style) {\n    var e = elt(tag, content, className, style);\n    e.setAttribute(\"role\", \"presentation\");\n    return e\n  }\n\n  var range;\n  if (document.createRange) { range = function(node, start, end, endNode) {\n    var r = document.createRange();\n    r.setEnd(endNode || node, end);\n    r.setStart(node, start);\n    return r\n  }; }\n  else { range = function(node, start, end) {\n    var r = document.body.createTextRange();\n    try { r.moveToElementText(node.parentNode); }\n    catch(e) { return r }\n    r.collapse(true);\n    r.moveEnd(\"character\", end);\n    r.moveStart(\"character\", start);\n    return r\n  }; }\n\n  function contains(parent, child) {\n    if (child.nodeType == 3) // Android browser always returns false when child is a textnode\n      { child = child.parentNode; }\n    if (parent.contains)\n      { return parent.contains(child) }\n    do {\n      if (child.nodeType == 11) { child = child.host; }\n      if (child == parent) { return true }\n    } while (child = child.parentNode)\n  }\n\n  function activeElt() {\n    // IE and Edge may throw an \"Unspecified Error\" when accessing document.activeElement.\n    // IE < 10 will throw when accessed while the page is loading or in an iframe.\n    // IE > 9 and Edge will throw when accessed in an iframe if document.body is unavailable.\n    var activeElement;\n    try {\n      activeElement = document.activeElement;\n    } catch(e) {\n      activeElement = document.body || null;\n    }\n    while (activeElement && activeElement.shadowRoot && activeElement.shadowRoot.activeElement)\n      { activeElement = activeElement.shadowRoot.activeElement; }\n    return activeElement\n  }\n\n  function addClass(node, cls) {\n    var current = node.className;\n    if (!classTest(cls).test(current)) { node.className += (current ? \" \" : \"\") + cls; }\n  }\n  function joinClasses(a, b) {\n    var as = a.split(\" \");\n    for (var i = 0; i < as.length; i++)\n      { if (as[i] && !classTest(as[i]).test(b)) { b += \" \" + as[i]; } }\n    return b\n  }\n\n  var selectInput = function(node) { node.select(); };\n  if (ios) // Mobile Safari apparently has a bug where select() is broken.\n    { selectInput = function(node) { node.selectionStart = 0; node.selectionEnd = node.value.length; }; }\n  else if (ie) // Suppress mysterious IE10 errors\n    { selectInput = function(node) { try { node.select(); } catch(_e) {} }; }\n\n  function bind(f) {\n    var args = Array.prototype.slice.call(arguments, 1);\n    return function(){return f.apply(null, args)}\n  }\n\n  function copyObj(obj, target, overwrite) {\n    if (!target) { target = {}; }\n    for (var prop in obj)\n      { if (obj.hasOwnProperty(prop) && (overwrite !== false || !target.hasOwnProperty(prop)))\n        { target[prop] = obj[prop]; } }\n    return target\n  }\n\n  // Counts the column offset in a string, taking tabs into account.\n  // Used mostly to find indentation.\n  function countColumn(string, end, tabSize, startIndex, startValue) {\n    if (end == null) {\n      end = string.search(/[^\\s\\u00a0]/);\n      if (end == -1) { end = string.length; }\n    }\n    for (var i = startIndex || 0, n = startValue || 0;;) {\n      var nextTab = string.indexOf(\"\\t\", i);\n      if (nextTab < 0 || nextTab >= end)\n        { return n + (end - i) }\n      n += nextTab - i;\n      n += tabSize - (n % tabSize);\n      i = nextTab + 1;\n    }\n  }\n\n  var Delayed = function() {\n    this.id = null;\n    this.f = null;\n    this.time = 0;\n    this.handler = bind(this.onTimeout, this);\n  };\n  Delayed.prototype.onTimeout = function (self) {\n    self.id = 0;\n    if (self.time <= +new Date) {\n      self.f();\n    } else {\n      setTimeout(self.handler, self.time - +new Date);\n    }\n  };\n  Delayed.prototype.set = function (ms, f) {\n    this.f = f;\n    var time = +new Date + ms;\n    if (!this.id || time < this.time) {\n      clearTimeout(this.id);\n      this.id = setTimeout(this.handler, ms);\n      this.time = time;\n    }\n  };\n\n  function indexOf(array, elt) {\n    for (var i = 0; i < array.length; ++i)\n      { if (array[i] == elt) { return i } }\n    return -1\n  }\n\n  // Number of pixels added to scroller and sizer to hide scrollbar\n  var scrollerGap = 50;\n\n  // Returned or thrown by various protocols to signal 'I'm not\n  // handling this'.\n  var Pass = {toString: function(){return \"CodeMirror.Pass\"}};\n\n  // Reused option objects for setSelection & friends\n  var sel_dontScroll = {scroll: false}, sel_mouse = {origin: \"*mouse\"}, sel_move = {origin: \"+move\"};\n\n  // The inverse of countColumn -- find the offset that corresponds to\n  // a particular column.\n  function findColumn(string, goal, tabSize) {\n    for (var pos = 0, col = 0;;) {\n      var nextTab = string.indexOf(\"\\t\", pos);\n      if (nextTab == -1) { nextTab = string.length; }\n      var skipped = nextTab - pos;\n      if (nextTab == string.length || col + skipped >= goal)\n        { return pos + Math.min(skipped, goal - col) }\n      col += nextTab - pos;\n      col += tabSize - (col % tabSize);\n      pos = nextTab + 1;\n      if (col >= goal) { return pos }\n    }\n  }\n\n  var spaceStrs = [\"\"];\n  function spaceStr(n) {\n    while (spaceStrs.length <= n)\n      { spaceStrs.push(lst(spaceStrs) + \" \"); }\n    return spaceStrs[n]\n  }\n\n  function lst(arr) { return arr[arr.length-1] }\n\n  function map(array, f) {\n    var out = [];\n    for (var i = 0; i < array.length; i++) { out[i] = f(array[i], i); }\n    return out\n  }\n\n  function insertSorted(array, value, score) {\n    var pos = 0, priority = score(value);\n    while (pos < array.length && score(array[pos]) <= priority) { pos++; }\n    array.splice(pos, 0, value);\n  }\n\n  function nothing() {}\n\n  function createObj(base, props) {\n    var inst;\n    if (Object.create) {\n      inst = Object.create(base);\n    } else {\n      nothing.prototype = base;\n      inst = new nothing();\n    }\n    if (props) { copyObj(props, inst); }\n    return inst\n  }\n\n  var nonASCIISingleCaseWordChar = /[\\u00df\\u0587\\u0590-\\u05f4\\u0600-\\u06ff\\u3040-\\u309f\\u30a0-\\u30ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\uac00-\\ud7af]/;\n  function isWordCharBasic(ch) {\n    return /\\w/.test(ch) || ch > \"\\x80\" &&\n      (ch.toUpperCase() != ch.toLowerCase() || nonASCIISingleCaseWordChar.test(ch))\n  }\n  function isWordChar(ch, helper) {\n    if (!helper) { return isWordCharBasic(ch) }\n    if (helper.source.indexOf(\"\\\\w\") > -1 && isWordCharBasic(ch)) { return true }\n    return helper.test(ch)\n  }\n\n  function isEmpty(obj) {\n    for (var n in obj) { if (obj.hasOwnProperty(n) && obj[n]) { return false } }\n    return true\n  }\n\n  // Extending unicode characters. A series of a non-extending char +\n  // any number of extending chars is treated as a single unit as far\n  // as editing and measuring is concerned. This is not fully correct,\n  // since some scripts/fonts/browsers also treat other configurations\n  // of code points as a group.\n  var extendingChars = /[\\u0300-\\u036f\\u0483-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u065e\\u0670\\u06d6-\\u06dc\\u06de-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0900-\\u0902\\u093c\\u0941-\\u0948\\u094d\\u0951-\\u0955\\u0962\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2\\u09e3\\u0a01\\u0a02\\u0a3c\\u0a41\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70\\u0a71\\u0a75\\u0a81\\u0a82\\u0abc\\u0ac1-\\u0ac5\\u0ac7\\u0ac8\\u0acd\\u0ae2\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0d3e\\u0d41-\\u0d44\\u0d4d\\u0d57\\u0d62\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0f18\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86\\u0f87\\u0f90-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039\\u103a\\u103d\\u103e\\u1058\\u1059\\u105e-\\u1060\\u1071-\\u1074\\u1082\\u1085\\u1086\\u108d\\u109d\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927\\u1928\\u1932\\u1939-\\u193b\\u1a17\\u1a18\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1b00-\\u1b03\\u1b34\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80\\u1b81\\u1ba2-\\u1ba5\\u1ba8\\u1ba9\\u1c2c-\\u1c33\\u1c36\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1dc0-\\u1de6\\u1dfd-\\u1dff\\u200c\\u200d\\u20d0-\\u20f0\\u2cef-\\u2cf1\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua66f-\\ua672\\ua67c\\ua67d\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua825\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc\\uaa29-\\uaa2e\\uaa31\\uaa32\\uaa35\\uaa36\\uaa43\\uaa4c\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uabe5\\uabe8\\uabed\\udc00-\\udfff\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe26\\uff9e\\uff9f]/;\n  function isExtendingChar(ch) { return ch.charCodeAt(0) >= 768 && extendingChars.test(ch) }\n\n  // Returns a number from the range [`0`; `str.length`] unless `pos` is outside that range.\n  function skipExtendingChars(str, pos, dir) {\n    while ((dir < 0 ? pos > 0 : pos < str.length) && isExtendingChar(str.charAt(pos))) { pos += dir; }\n    return pos\n  }\n\n  // Returns the value from the range [`from`; `to`] that satisfies\n  // `pred` and is closest to `from`. Assumes that at least `to`\n  // satisfies `pred`. Supports `from` being greater than `to`.\n  function findFirst(pred, from, to) {\n    // At any point we are certain `to` satisfies `pred`, don't know\n    // whether `from` does.\n    var dir = from > to ? -1 : 1;\n    for (;;) {\n      if (from == to) { return from }\n      var midF = (from + to) / 2, mid = dir < 0 ? Math.ceil(midF) : Math.floor(midF);\n      if (mid == from) { return pred(mid) ? from : to }\n      if (pred(mid)) { to = mid; }\n      else { from = mid + dir; }\n    }\n  }\n\n  // BIDI HELPERS\n\n  function iterateBidiSections(order, from, to, f) {\n    if (!order) { return f(from, to, \"ltr\", 0) }\n    var found = false;\n    for (var i = 0; i < order.length; ++i) {\n      var part = order[i];\n      if (part.from < to && part.to > from || from == to && part.to == from) {\n        f(Math.max(part.from, from), Math.min(part.to, to), part.level == 1 ? \"rtl\" : \"ltr\", i);\n        found = true;\n      }\n    }\n    if (!found) { f(from, to, \"ltr\"); }\n  }\n\n  var bidiOther = null;\n  function getBidiPartAt(order, ch, sticky) {\n    var found;\n    bidiOther = null;\n    for (var i = 0; i < order.length; ++i) {\n      var cur = order[i];\n      if (cur.from < ch && cur.to > ch) { return i }\n      if (cur.to == ch) {\n        if (cur.from != cur.to && sticky == \"before\") { found = i; }\n        else { bidiOther = i; }\n      }\n      if (cur.from == ch) {\n        if (cur.from != cur.to && sticky != \"before\") { found = i; }\n        else { bidiOther = i; }\n      }\n    }\n    return found != null ? found : bidiOther\n  }\n\n  // Bidirectional ordering algorithm\n  // See http://unicode.org/reports/tr9/tr9-13.html for the algorithm\n  // that this (partially) implements.\n\n  // One-char codes used for character types:\n  // L (L):   Left-to-Right\n  // R (R):   Right-to-Left\n  // r (AL):  Right-to-Left Arabic\n  // 1 (EN):  European Number\n  // + (ES):  European Number Separator\n  // % (ET):  European Number Terminator\n  // n (AN):  Arabic Number\n  // , (CS):  Common Number Separator\n  // m (NSM): Non-Spacing Mark\n  // b (BN):  Boundary Neutral\n  // s (B):   Paragraph Separator\n  // t (S):   Segment Separator\n  // w (WS):  Whitespace\n  // N (ON):  Other Neutrals\n\n  // Returns null if characters are ordered as they appear\n  // (left-to-right), or an array of sections ({from, to, level}\n  // objects) in the order in which they occur visually.\n  var bidiOrdering = (function() {\n    // Character types for codepoints 0 to 0xff\n    var lowTypes = \"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN\";\n    // Character types for codepoints 0x600 to 0x6f9\n    var arabicTypes = \"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111\";\n    function charType(code) {\n      if (code <= 0xf7) { return lowTypes.charAt(code) }\n      else if (0x590 <= code && code <= 0x5f4) { return \"R\" }\n      else if (0x600 <= code && code <= 0x6f9) { return arabicTypes.charAt(code - 0x600) }\n      else if (0x6ee <= code && code <= 0x8ac) { return \"r\" }\n      else if (0x2000 <= code && code <= 0x200b) { return \"w\" }\n      else if (code == 0x200c) { return \"b\" }\n      else { return \"L\" }\n    }\n\n    var bidiRE = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/;\n    var isNeutral = /[stwN]/, isStrong = /[LRr]/, countsAsLeft = /[Lb1n]/, countsAsNum = /[1n]/;\n\n    function BidiSpan(level, from, to) {\n      this.level = level;\n      this.from = from; this.to = to;\n    }\n\n    return function(str, direction) {\n      var outerType = direction == \"ltr\" ? \"L\" : \"R\";\n\n      if (str.length == 0 || direction == \"ltr\" && !bidiRE.test(str)) { return false }\n      var len = str.length, types = [];\n      for (var i = 0; i < len; ++i)\n        { types.push(charType(str.charCodeAt(i))); }\n\n      // W1. Examine each non-spacing mark (NSM) in the level run, and\n      // change the type of the NSM to the type of the previous\n      // character. If the NSM is at the start of the level run, it will\n      // get the type of sor.\n      for (var i$1 = 0, prev = outerType; i$1 < len; ++i$1) {\n        var type = types[i$1];\n        if (type == \"m\") { types[i$1] = prev; }\n        else { prev = type; }\n      }\n\n      // W2. Search backwards from each instance of a European number\n      // until the first strong type (R, L, AL, or sor) is found. If an\n      // AL is found, change the type of the European number to Arabic\n      // number.\n      // W3. Change all ALs to R.\n      for (var i$2 = 0, cur = outerType; i$2 < len; ++i$2) {\n        var type$1 = types[i$2];\n        if (type$1 == \"1\" && cur == \"r\") { types[i$2] = \"n\"; }\n        else if (isStrong.test(type$1)) { cur = type$1; if (type$1 == \"r\") { types[i$2] = \"R\"; } }\n      }\n\n      // W4. A single European separator between two European numbers\n      // changes to a European number. A single common separator between\n      // two numbers of the same type changes to that type.\n      for (var i$3 = 1, prev$1 = types[0]; i$3 < len - 1; ++i$3) {\n        var type$2 = types[i$3];\n        if (type$2 == \"+\" && prev$1 == \"1\" && types[i$3+1] == \"1\") { types[i$3] = \"1\"; }\n        else if (type$2 == \",\" && prev$1 == types[i$3+1] &&\n                 (prev$1 == \"1\" || prev$1 == \"n\")) { types[i$3] = prev$1; }\n        prev$1 = type$2;\n      }\n\n      // W5. A sequence of European terminators adjacent to European\n      // numbers changes to all European numbers.\n      // W6. Otherwise, separators and terminators change to Other\n      // Neutral.\n      for (var i$4 = 0; i$4 < len; ++i$4) {\n        var type$3 = types[i$4];\n        if (type$3 == \",\") { types[i$4] = \"N\"; }\n        else if (type$3 == \"%\") {\n          var end = (void 0);\n          for (end = i$4 + 1; end < len && types[end] == \"%\"; ++end) {}\n          var replace = (i$4 && types[i$4-1] == \"!\") || (end < len && types[end] == \"1\") ? \"1\" : \"N\";\n          for (var j = i$4; j < end; ++j) { types[j] = replace; }\n          i$4 = end - 1;\n        }\n      }\n\n      // W7. Search backwards from each instance of a European number\n      // until the first strong type (R, L, or sor) is found. If an L is\n      // found, then change the type of the European number to L.\n      for (var i$5 = 0, cur$1 = outerType; i$5 < len; ++i$5) {\n        var type$4 = types[i$5];\n        if (cur$1 == \"L\" && type$4 == \"1\") { types[i$5] = \"L\"; }\n        else if (isStrong.test(type$4)) { cur$1 = type$4; }\n      }\n\n      // N1. A sequence of neutrals takes the direction of the\n      // surrounding strong text if the text on both sides has the same\n      // direction. European and Arabic numbers act as if they were R in\n      // terms of their influence on neutrals. Start-of-level-run (sor)\n      // and end-of-level-run (eor) are used at level run boundaries.\n      // N2. Any remaining neutrals take the embedding direction.\n      for (var i$6 = 0; i$6 < len; ++i$6) {\n        if (isNeutral.test(types[i$6])) {\n          var end$1 = (void 0);\n          for (end$1 = i$6 + 1; end$1 < len && isNeutral.test(types[end$1]); ++end$1) {}\n          var before = (i$6 ? types[i$6-1] : outerType) == \"L\";\n          var after = (end$1 < len ? types[end$1] : outerType) == \"L\";\n          var replace$1 = before == after ? (before ? \"L\" : \"R\") : outerType;\n          for (var j$1 = i$6; j$1 < end$1; ++j$1) { types[j$1] = replace$1; }\n          i$6 = end$1 - 1;\n        }\n      }\n\n      // Here we depart from the documented algorithm, in order to avoid\n      // building up an actual levels array. Since there are only three\n      // levels (0, 1, 2) in an implementation that doesn't take\n      // explicit embedding into account, we can build up the order on\n      // the fly, without following the level-based algorithm.\n      var order = [], m;\n      for (var i$7 = 0; i$7 < len;) {\n        if (countsAsLeft.test(types[i$7])) {\n          var start = i$7;\n          for (++i$7; i$7 < len && countsAsLeft.test(types[i$7]); ++i$7) {}\n          order.push(new BidiSpan(0, start, i$7));\n        } else {\n          var pos = i$7, at = order.length, isRTL = direction == \"rtl\" ? 1 : 0;\n          for (++i$7; i$7 < len && types[i$7] != \"L\"; ++i$7) {}\n          for (var j$2 = pos; j$2 < i$7;) {\n            if (countsAsNum.test(types[j$2])) {\n              if (pos < j$2) { order.splice(at, 0, new BidiSpan(1, pos, j$2)); at += isRTL; }\n              var nstart = j$2;\n              for (++j$2; j$2 < i$7 && countsAsNum.test(types[j$2]); ++j$2) {}\n              order.splice(at, 0, new BidiSpan(2, nstart, j$2));\n              at += isRTL;\n              pos = j$2;\n            } else { ++j$2; }\n          }\n          if (pos < i$7) { order.splice(at, 0, new BidiSpan(1, pos, i$7)); }\n        }\n      }\n      if (direction == \"ltr\") {\n        if (order[0].level == 1 && (m = str.match(/^\\s+/))) {\n          order[0].from = m[0].length;\n          order.unshift(new BidiSpan(0, 0, m[0].length));\n        }\n        if (lst(order).level == 1 && (m = str.match(/\\s+$/))) {\n          lst(order).to -= m[0].length;\n          order.push(new BidiSpan(0, len - m[0].length, len));\n        }\n      }\n\n      return direction == \"rtl\" ? order.reverse() : order\n    }\n  })();\n\n  // Get the bidi ordering for the given line (and cache it). Returns\n  // false for lines that are fully left-to-right, and an array of\n  // BidiSpan objects otherwise.\n  function getOrder(line, direction) {\n    var order = line.order;\n    if (order == null) { order = line.order = bidiOrdering(line.text, direction); }\n    return order\n  }\n\n  // EVENT HANDLING\n\n  // Lightweight event framework. on/off also work on DOM nodes,\n  // registering native DOM handlers.\n\n  var noHandlers = [];\n\n  var on = function(emitter, type, f) {\n    if (emitter.addEventListener) {\n      emitter.addEventListener(type, f, false);\n    } else if (emitter.attachEvent) {\n      emitter.attachEvent(\"on\" + type, f);\n    } else {\n      var map = emitter._handlers || (emitter._handlers = {});\n      map[type] = (map[type] || noHandlers).concat(f);\n    }\n  };\n\n  function getHandlers(emitter, type) {\n    return emitter._handlers && emitter._handlers[type] || noHandlers\n  }\n\n  function off(emitter, type, f) {\n    if (emitter.removeEventListener) {\n      emitter.removeEventListener(type, f, false);\n    } else if (emitter.detachEvent) {\n      emitter.detachEvent(\"on\" + type, f);\n    } else {\n      var map = emitter._handlers, arr = map && map[type];\n      if (arr) {\n        var index = indexOf(arr, f);\n        if (index > -1)\n          { map[type] = arr.slice(0, index).concat(arr.slice(index + 1)); }\n      }\n    }\n  }\n\n  function signal(emitter, type /*, values...*/) {\n    var handlers = getHandlers(emitter, type);\n    if (!handlers.length) { return }\n    var args = Array.prototype.slice.call(arguments, 2);\n    for (var i = 0; i < handlers.length; ++i) { handlers[i].apply(null, args); }\n  }\n\n  // The DOM events that CodeMirror handles can be overridden by\n  // registering a (non-DOM) handler on the editor for the event name,\n  // and preventDefault-ing the event in that handler.\n  function signalDOMEvent(cm, e, override) {\n    if (typeof e == \"string\")\n      { e = {type: e, preventDefault: function() { this.defaultPrevented = true; }}; }\n    signal(cm, override || e.type, cm, e);\n    return e_defaultPrevented(e) || e.codemirrorIgnore\n  }\n\n  function signalCursorActivity(cm) {\n    var arr = cm._handlers && cm._handlers.cursorActivity;\n    if (!arr) { return }\n    var set = cm.curOp.cursorActivityHandlers || (cm.curOp.cursorActivityHandlers = []);\n    for (var i = 0; i < arr.length; ++i) { if (indexOf(set, arr[i]) == -1)\n      { set.push(arr[i]); } }\n  }\n\n  function hasHandler(emitter, type) {\n    return getHandlers(emitter, type).length > 0\n  }\n\n  // Add on and off methods to a constructor's prototype, to make\n  // registering events on such objects more convenient.\n  function eventMixin(ctor) {\n    ctor.prototype.on = function(type, f) {on(this, type, f);};\n    ctor.prototype.off = function(type, f) {off(this, type, f);};\n  }\n\n  // Due to the fact that we still support jurassic IE versions, some\n  // compatibility wrappers are needed.\n\n  function e_preventDefault(e) {\n    if (e.preventDefault) { e.preventDefault(); }\n    else { e.returnValue = false; }\n  }\n  function e_stopPropagation(e) {\n    if (e.stopPropagation) { e.stopPropagation(); }\n    else { e.cancelBubble = true; }\n  }\n  function e_defaultPrevented(e) {\n    return e.defaultPrevented != null ? e.defaultPrevented : e.returnValue == false\n  }\n  function e_stop(e) {e_preventDefault(e); e_stopPropagation(e);}\n\n  function e_target(e) {return e.target || e.srcElement}\n  function e_button(e) {\n    var b = e.which;\n    if (b == null) {\n      if (e.button & 1) { b = 1; }\n      else if (e.button & 2) { b = 3; }\n      else if (e.button & 4) { b = 2; }\n    }\n    if (mac && e.ctrlKey && b == 1) { b = 3; }\n    return b\n  }\n\n  // Detect drag-and-drop\n  var dragAndDrop = function() {\n    // There is *some* kind of drag-and-drop support in IE6-8, but I\n    // couldn't get it to work yet.\n    if (ie && ie_version < 9) { return false }\n    var div = elt('div');\n    return \"draggable\" in div || \"dragDrop\" in div\n  }();\n\n  var zwspSupported;\n  function zeroWidthElement(measure) {\n    if (zwspSupported == null) {\n      var test = elt(\"span\", \"\\u200b\");\n      removeChildrenAndAdd(measure, elt(\"span\", [test, document.createTextNode(\"x\")]));\n      if (measure.firstChild.offsetHeight != 0)\n        { zwspSupported = test.offsetWidth <= 1 && test.offsetHeight > 2 && !(ie && ie_version < 8); }\n    }\n    var node = zwspSupported ? elt(\"span\", \"\\u200b\") :\n      elt(\"span\", \"\\u00a0\", null, \"display: inline-block; width: 1px; margin-right: -1px\");\n    node.setAttribute(\"cm-text\", \"\");\n    return node\n  }\n\n  // Feature-detect IE's crummy client rect reporting for bidi text\n  var badBidiRects;\n  function hasBadBidiRects(measure) {\n    if (badBidiRects != null) { return badBidiRects }\n    var txt = removeChildrenAndAdd(measure, document.createTextNode(\"A\\u062eA\"));\n    var r0 = range(txt, 0, 1).getBoundingClientRect();\n    var r1 = range(txt, 1, 2).getBoundingClientRect();\n    removeChildren(measure);\n    if (!r0 || r0.left == r0.right) { return false } // Safari returns null in some cases (#2780)\n    return badBidiRects = (r1.right - r0.right < 3)\n  }\n\n  // See if \"\".split is the broken IE version, if so, provide an\n  // alternative way to split lines.\n  var splitLinesAuto = \"\\n\\nb\".split(/\\n/).length != 3 ? function (string) {\n    var pos = 0, result = [], l = string.length;\n    while (pos <= l) {\n      var nl = string.indexOf(\"\\n\", pos);\n      if (nl == -1) { nl = string.length; }\n      var line = string.slice(pos, string.charAt(nl - 1) == \"\\r\" ? nl - 1 : nl);\n      var rt = line.indexOf(\"\\r\");\n      if (rt != -1) {\n        result.push(line.slice(0, rt));\n        pos += rt + 1;\n      } else {\n        result.push(line);\n        pos = nl + 1;\n      }\n    }\n    return result\n  } : function (string) { return string.split(/\\r\\n?|\\n/); };\n\n  var hasSelection = window.getSelection ? function (te) {\n    try { return te.selectionStart != te.selectionEnd }\n    catch(e) { return false }\n  } : function (te) {\n    var range;\n    try {range = te.ownerDocument.selection.createRange();}\n    catch(e) {}\n    if (!range || range.parentElement() != te) { return false }\n    return range.compareEndPoints(\"StartToEnd\", range) != 0\n  };\n\n  var hasCopyEvent = (function () {\n    var e = elt(\"div\");\n    if (\"oncopy\" in e) { return true }\n    e.setAttribute(\"oncopy\", \"return;\");\n    return typeof e.oncopy == \"function\"\n  })();\n\n  var badZoomedRects = null;\n  function hasBadZoomedRects(measure) {\n    if (badZoomedRects != null) { return badZoomedRects }\n    var node = removeChildrenAndAdd(measure, elt(\"span\", \"x\"));\n    var normal = node.getBoundingClientRect();\n    var fromRange = range(node, 0, 1).getBoundingClientRect();\n    return badZoomedRects = Math.abs(normal.left - fromRange.left) > 1\n  }\n\n  // Known modes, by name and by MIME\n  var modes = {}, mimeModes = {};\n\n  // Extra arguments are stored as the mode's dependencies, which is\n  // used by (legacy) mechanisms like loadmode.js to automatically\n  // load a mode. (Preferred mechanism is the require/define calls.)\n  function defineMode(name, mode) {\n    if (arguments.length > 2)\n      { mode.dependencies = Array.prototype.slice.call(arguments, 2); }\n    modes[name] = mode;\n  }\n\n  function defineMIME(mime, spec) {\n    mimeModes[mime] = spec;\n  }\n\n  // Given a MIME type, a {name, ...options} config object, or a name\n  // string, return a mode config object.\n  function resolveMode(spec) {\n    if (typeof spec == \"string\" && mimeModes.hasOwnProperty(spec)) {\n      spec = mimeModes[spec];\n    } else if (spec && typeof spec.name == \"string\" && mimeModes.hasOwnProperty(spec.name)) {\n      var found = mimeModes[spec.name];\n      if (typeof found == \"string\") { found = {name: found}; }\n      spec = createObj(found, spec);\n      spec.name = found.name;\n    } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+xml$/.test(spec)) {\n      return resolveMode(\"application/xml\")\n    } else if (typeof spec == \"string\" && /^[\\w\\-]+\\/[\\w\\-]+\\+json$/.test(spec)) {\n      return resolveMode(\"application/json\")\n    }\n    if (typeof spec == \"string\") { return {name: spec} }\n    else { return spec || {name: \"null\"} }\n  }\n\n  // Given a mode spec (anything that resolveMode accepts), find and\n  // initialize an actual mode object.\n  function getMode(options, spec) {\n    spec = resolveMode(spec);\n    var mfactory = modes[spec.name];\n    if (!mfactory) { return getMode(options, \"text/plain\") }\n    var modeObj = mfactory(options, spec);\n    if (modeExtensions.hasOwnProperty(spec.name)) {\n      var exts = modeExtensions[spec.name];\n      for (var prop in exts) {\n        if (!exts.hasOwnProperty(prop)) { continue }\n        if (modeObj.hasOwnProperty(prop)) { modeObj[\"_\" + prop] = modeObj[prop]; }\n        modeObj[prop] = exts[prop];\n      }\n    }\n    modeObj.name = spec.name;\n    if (spec.helperType) { modeObj.helperType = spec.helperType; }\n    if (spec.modeProps) { for (var prop$1 in spec.modeProps)\n      { modeObj[prop$1] = spec.modeProps[prop$1]; } }\n\n    return modeObj\n  }\n\n  // This can be used to attach properties to mode objects from\n  // outside the actual mode definition.\n  var modeExtensions = {};\n  function extendMode(mode, properties) {\n    var exts = modeExtensions.hasOwnProperty(mode) ? modeExtensions[mode] : (modeExtensions[mode] = {});\n    copyObj(properties, exts);\n  }\n\n  function copyState(mode, state) {\n    if (state === true) { return state }\n    if (mode.copyState) { return mode.copyState(state) }\n    var nstate = {};\n    for (var n in state) {\n      var val = state[n];\n      if (val instanceof Array) { val = val.concat([]); }\n      nstate[n] = val;\n    }\n    return nstate\n  }\n\n  // Given a mode and a state (for that mode), find the inner mode and\n  // state at the position that the state refers to.\n  function innerMode(mode, state) {\n    var info;\n    while (mode.innerMode) {\n      info = mode.innerMode(state);\n      if (!info || info.mode == mode) { break }\n      state = info.state;\n      mode = info.mode;\n    }\n    return info || {mode: mode, state: state}\n  }\n\n  function startState(mode, a1, a2) {\n    return mode.startState ? mode.startState(a1, a2) : true\n  }\n\n  // STRING STREAM\n\n  // Fed to the mode parsers, provides helper functions to make\n  // parsers more succinct.\n\n  var StringStream = function(string, tabSize, lineOracle) {\n    this.pos = this.start = 0;\n    this.string = string;\n    this.tabSize = tabSize || 8;\n    this.lastColumnPos = this.lastColumnValue = 0;\n    this.lineStart = 0;\n    this.lineOracle = lineOracle;\n  };\n\n  StringStream.prototype.eol = function () {return this.pos >= this.string.length};\n  StringStream.prototype.sol = function () {return this.pos == this.lineStart};\n  StringStream.prototype.peek = function () {return this.string.charAt(this.pos) || undefined};\n  StringStream.prototype.next = function () {\n    if (this.pos < this.string.length)\n      { return this.string.charAt(this.pos++) }\n  };\n  StringStream.prototype.eat = function (match) {\n    var ch = this.string.charAt(this.pos);\n    var ok;\n    if (typeof match == \"string\") { ok = ch == match; }\n    else { ok = ch && (match.test ? match.test(ch) : match(ch)); }\n    if (ok) {++this.pos; return ch}\n  };\n  StringStream.prototype.eatWhile = function (match) {\n    var start = this.pos;\n    while (this.eat(match)){}\n    return this.pos > start\n  };\n  StringStream.prototype.eatSpace = function () {\n    var start = this.pos;\n    while (/[\\s\\u00a0]/.test(this.string.charAt(this.pos))) { ++this.pos; }\n    return this.pos > start\n  };\n  StringStream.prototype.skipToEnd = function () {this.pos = this.string.length;};\n  StringStream.prototype.skipTo = function (ch) {\n    var found = this.string.indexOf(ch, this.pos);\n    if (found > -1) {this.pos = found; return true}\n  };\n  StringStream.prototype.backUp = function (n) {this.pos -= n;};\n  StringStream.prototype.column = function () {\n    if (this.lastColumnPos < this.start) {\n      this.lastColumnValue = countColumn(this.string, this.start, this.tabSize, this.lastColumnPos, this.lastColumnValue);\n      this.lastColumnPos = this.start;\n    }\n    return this.lastColumnValue - (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n  };\n  StringStream.prototype.indentation = function () {\n    return countColumn(this.string, null, this.tabSize) -\n      (this.lineStart ? countColumn(this.string, this.lineStart, this.tabSize) : 0)\n  };\n  StringStream.prototype.match = function (pattern, consume, caseInsensitive) {\n    if (typeof pattern == \"string\") {\n      var cased = function (str) { return caseInsensitive ? str.toLowerCase() : str; };\n      var substr = this.string.substr(this.pos, pattern.length);\n      if (cased(substr) == cased(pattern)) {\n        if (consume !== false) { this.pos += pattern.length; }\n        return true\n      }\n    } else {\n      var match = this.string.slice(this.pos).match(pattern);\n      if (match && match.index > 0) { return null }\n      if (match && consume !== false) { this.pos += match[0].length; }\n      return match\n    }\n  };\n  StringStream.prototype.current = function (){return this.string.slice(this.start, this.pos)};\n  StringStream.prototype.hideFirstChars = function (n, inner) {\n    this.lineStart += n;\n    try { return inner() }\n    finally { this.lineStart -= n; }\n  };\n  StringStream.prototype.lookAhead = function (n) {\n    var oracle = this.lineOracle;\n    return oracle && oracle.lookAhead(n)\n  };\n  StringStream.prototype.baseToken = function () {\n    var oracle = this.lineOracle;\n    return oracle && oracle.baseToken(this.pos)\n  };\n\n  // Find the line object corresponding to the given line number.\n  function getLine(doc, n) {\n    n -= doc.first;\n    if (n < 0 || n >= doc.size) { throw new Error(\"There is no line \" + (n + doc.first) + \" in the document.\") }\n    var chunk = doc;\n    while (!chunk.lines) {\n      for (var i = 0;; ++i) {\n        var child = chunk.children[i], sz = child.chunkSize();\n        if (n < sz) { chunk = child; break }\n        n -= sz;\n      }\n    }\n    return chunk.lines[n]\n  }\n\n  // Get the part of a document between two positions, as an array of\n  // strings.\n  function getBetween(doc, start, end) {\n    var out = [], n = start.line;\n    doc.iter(start.line, end.line + 1, function (line) {\n      var text = line.text;\n      if (n == end.line) { text = text.slice(0, end.ch); }\n      if (n == start.line) { text = text.slice(start.ch); }\n      out.push(text);\n      ++n;\n    });\n    return out\n  }\n  // Get the lines between from and to, as array of strings.\n  function getLines(doc, from, to) {\n    var out = [];\n    doc.iter(from, to, function (line) { out.push(line.text); }); // iter aborts when callback returns truthy value\n    return out\n  }\n\n  // Update the height of a line, propagating the height change\n  // upwards to parent nodes.\n  function updateLineHeight(line, height) {\n    var diff = height - line.height;\n    if (diff) { for (var n = line; n; n = n.parent) { n.height += diff; } }\n  }\n\n  // Given a line object, find its line number by walking up through\n  // its parent links.\n  function lineNo(line) {\n    if (line.parent == null) { return null }\n    var cur = line.parent, no = indexOf(cur.lines, line);\n    for (var chunk = cur.parent; chunk; cur = chunk, chunk = chunk.parent) {\n      for (var i = 0;; ++i) {\n        if (chunk.children[i] == cur) { break }\n        no += chunk.children[i].chunkSize();\n      }\n    }\n    return no + cur.first\n  }\n\n  // Find the line at the given vertical position, using the height\n  // information in the document tree.\n  function lineAtHeight(chunk, h) {\n    var n = chunk.first;\n    outer: do {\n      for (var i$1 = 0; i$1 < chunk.children.length; ++i$1) {\n        var child = chunk.children[i$1], ch = child.height;\n        if (h < ch) { chunk = child; continue outer }\n        h -= ch;\n        n += child.chunkSize();\n      }\n      return n\n    } while (!chunk.lines)\n    var i = 0;\n    for (; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i], lh = line.height;\n      if (h < lh) { break }\n      h -= lh;\n    }\n    return n + i\n  }\n\n  function isLine(doc, l) {return l >= doc.first && l < doc.first + doc.size}\n\n  function lineNumberFor(options, i) {\n    return String(options.lineNumberFormatter(i + options.firstLineNumber))\n  }\n\n  // A Pos instance represents a position within the text.\n  function Pos(line, ch, sticky) {\n    if ( sticky === void 0 ) sticky = null;\n\n    if (!(this instanceof Pos)) { return new Pos(line, ch, sticky) }\n    this.line = line;\n    this.ch = ch;\n    this.sticky = sticky;\n  }\n\n  // Compare two positions, return 0 if they are the same, a negative\n  // number when a is less, and a positive number otherwise.\n  function cmp(a, b) { return a.line - b.line || a.ch - b.ch }\n\n  function equalCursorPos(a, b) { return a.sticky == b.sticky && cmp(a, b) == 0 }\n\n  function copyPos(x) {return Pos(x.line, x.ch)}\n  function maxPos(a, b) { return cmp(a, b) < 0 ? b : a }\n  function minPos(a, b) { return cmp(a, b) < 0 ? a : b }\n\n  // Most of the external API clips given positions to make sure they\n  // actually exist within the document.\n  function clipLine(doc, n) {return Math.max(doc.first, Math.min(n, doc.first + doc.size - 1))}\n  function clipPos(doc, pos) {\n    if (pos.line < doc.first) { return Pos(doc.first, 0) }\n    var last = doc.first + doc.size - 1;\n    if (pos.line > last) { return Pos(last, getLine(doc, last).text.length) }\n    return clipToLen(pos, getLine(doc, pos.line).text.length)\n  }\n  function clipToLen(pos, linelen) {\n    var ch = pos.ch;\n    if (ch == null || ch > linelen) { return Pos(pos.line, linelen) }\n    else if (ch < 0) { return Pos(pos.line, 0) }\n    else { return pos }\n  }\n  function clipPosArray(doc, array) {\n    var out = [];\n    for (var i = 0; i < array.length; i++) { out[i] = clipPos(doc, array[i]); }\n    return out\n  }\n\n  var SavedContext = function(state, lookAhead) {\n    this.state = state;\n    this.lookAhead = lookAhead;\n  };\n\n  var Context = function(doc, state, line, lookAhead) {\n    this.state = state;\n    this.doc = doc;\n    this.line = line;\n    this.maxLookAhead = lookAhead || 0;\n    this.baseTokens = null;\n    this.baseTokenPos = 1;\n  };\n\n  Context.prototype.lookAhead = function (n) {\n    var line = this.doc.getLine(this.line + n);\n    if (line != null && n > this.maxLookAhead) { this.maxLookAhead = n; }\n    return line\n  };\n\n  Context.prototype.baseToken = function (n) {\n    if (!this.baseTokens) { return null }\n    while (this.baseTokens[this.baseTokenPos] <= n)\n      { this.baseTokenPos += 2; }\n    var type = this.baseTokens[this.baseTokenPos + 1];\n    return {type: type && type.replace(/( |^)overlay .*/, \"\"),\n            size: this.baseTokens[this.baseTokenPos] - n}\n  };\n\n  Context.prototype.nextLine = function () {\n    this.line++;\n    if (this.maxLookAhead > 0) { this.maxLookAhead--; }\n  };\n\n  Context.fromSaved = function (doc, saved, line) {\n    if (saved instanceof SavedContext)\n      { return new Context(doc, copyState(doc.mode, saved.state), line, saved.lookAhead) }\n    else\n      { return new Context(doc, copyState(doc.mode, saved), line) }\n  };\n\n  Context.prototype.save = function (copy) {\n    var state = copy !== false ? copyState(this.doc.mode, this.state) : this.state;\n    return this.maxLookAhead > 0 ? new SavedContext(state, this.maxLookAhead) : state\n  };\n\n\n  // Compute a style array (an array starting with a mode generation\n  // -- for invalidation -- followed by pairs of end positions and\n  // style strings), which is used to highlight the tokens on the\n  // line.\n  function highlightLine(cm, line, context, forceToEnd) {\n    // A styles array always starts with a number identifying the\n    // mode/overlays that it is based on (for easy invalidation).\n    var st = [cm.state.modeGen], lineClasses = {};\n    // Compute the base array of styles\n    runMode(cm, line.text, cm.doc.mode, context, function (end, style) { return st.push(end, style); },\n            lineClasses, forceToEnd);\n    var state = context.state;\n\n    // Run overlays, adjust style array.\n    var loop = function ( o ) {\n      context.baseTokens = st;\n      var overlay = cm.state.overlays[o], i = 1, at = 0;\n      context.state = true;\n      runMode(cm, line.text, overlay.mode, context, function (end, style) {\n        var start = i;\n        // Ensure there's a token end at the current position, and that i points at it\n        while (at < end) {\n          var i_end = st[i];\n          if (i_end > end)\n            { st.splice(i, 1, end, st[i+1], i_end); }\n          i += 2;\n          at = Math.min(end, i_end);\n        }\n        if (!style) { return }\n        if (overlay.opaque) {\n          st.splice(start, i - start, end, \"overlay \" + style);\n          i = start + 2;\n        } else {\n          for (; start < i; start += 2) {\n            var cur = st[start+1];\n            st[start+1] = (cur ? cur + \" \" : \"\") + \"overlay \" + style;\n          }\n        }\n      }, lineClasses);\n      context.state = state;\n      context.baseTokens = null;\n      context.baseTokenPos = 1;\n    };\n\n    for (var o = 0; o < cm.state.overlays.length; ++o) loop( o );\n\n    return {styles: st, classes: lineClasses.bgClass || lineClasses.textClass ? lineClasses : null}\n  }\n\n  function getLineStyles(cm, line, updateFrontier) {\n    if (!line.styles || line.styles[0] != cm.state.modeGen) {\n      var context = getContextBefore(cm, lineNo(line));\n      var resetState = line.text.length > cm.options.maxHighlightLength && copyState(cm.doc.mode, context.state);\n      var result = highlightLine(cm, line, context);\n      if (resetState) { context.state = resetState; }\n      line.stateAfter = context.save(!resetState);\n      line.styles = result.styles;\n      if (result.classes) { line.styleClasses = result.classes; }\n      else if (line.styleClasses) { line.styleClasses = null; }\n      if (updateFrontier === cm.doc.highlightFrontier)\n        { cm.doc.modeFrontier = Math.max(cm.doc.modeFrontier, ++cm.doc.highlightFrontier); }\n    }\n    return line.styles\n  }\n\n  function getContextBefore(cm, n, precise) {\n    var doc = cm.doc, display = cm.display;\n    if (!doc.mode.startState) { return new Context(doc, true, n) }\n    var start = findStartLine(cm, n, precise);\n    var saved = start > doc.first && getLine(doc, start - 1).stateAfter;\n    var context = saved ? Context.fromSaved(doc, saved, start) : new Context(doc, startState(doc.mode), start);\n\n    doc.iter(start, n, function (line) {\n      processLine(cm, line.text, context);\n      var pos = context.line;\n      line.stateAfter = pos == n - 1 || pos % 5 == 0 || pos >= display.viewFrom && pos < display.viewTo ? context.save() : null;\n      context.nextLine();\n    });\n    if (precise) { doc.modeFrontier = context.line; }\n    return context\n  }\n\n  // Lightweight form of highlight -- proceed over this line and\n  // update state, but don't save a style array. Used for lines that\n  // aren't currently visible.\n  function processLine(cm, text, context, startAt) {\n    var mode = cm.doc.mode;\n    var stream = new StringStream(text, cm.options.tabSize, context);\n    stream.start = stream.pos = startAt || 0;\n    if (text == \"\") { callBlankLine(mode, context.state); }\n    while (!stream.eol()) {\n      readToken(mode, stream, context.state);\n      stream.start = stream.pos;\n    }\n  }\n\n  function callBlankLine(mode, state) {\n    if (mode.blankLine) { return mode.blankLine(state) }\n    if (!mode.innerMode) { return }\n    var inner = innerMode(mode, state);\n    if (inner.mode.blankLine) { return inner.mode.blankLine(inner.state) }\n  }\n\n  function readToken(mode, stream, state, inner) {\n    for (var i = 0; i < 10; i++) {\n      if (inner) { inner[0] = innerMode(mode, state).mode; }\n      var style = mode.token(stream, state);\n      if (stream.pos > stream.start) { return style }\n    }\n    throw new Error(\"Mode \" + mode.name + \" failed to advance stream.\")\n  }\n\n  var Token = function(stream, type, state) {\n    this.start = stream.start; this.end = stream.pos;\n    this.string = stream.current();\n    this.type = type || null;\n    this.state = state;\n  };\n\n  // Utility for getTokenAt and getLineTokens\n  function takeToken(cm, pos, precise, asArray) {\n    var doc = cm.doc, mode = doc.mode, style;\n    pos = clipPos(doc, pos);\n    var line = getLine(doc, pos.line), context = getContextBefore(cm, pos.line, precise);\n    var stream = new StringStream(line.text, cm.options.tabSize, context), tokens;\n    if (asArray) { tokens = []; }\n    while ((asArray || stream.pos < pos.ch) && !stream.eol()) {\n      stream.start = stream.pos;\n      style = readToken(mode, stream, context.state);\n      if (asArray) { tokens.push(new Token(stream, style, copyState(doc.mode, context.state))); }\n    }\n    return asArray ? tokens : new Token(stream, style, context.state)\n  }\n\n  function extractLineClasses(type, output) {\n    if (type) { for (;;) {\n      var lineClass = type.match(/(?:^|\\s+)line-(background-)?(\\S+)/);\n      if (!lineClass) { break }\n      type = type.slice(0, lineClass.index) + type.slice(lineClass.index + lineClass[0].length);\n      var prop = lineClass[1] ? \"bgClass\" : \"textClass\";\n      if (output[prop] == null)\n        { output[prop] = lineClass[2]; }\n      else if (!(new RegExp(\"(?:^|\\\\s)\" + lineClass[2] + \"(?:$|\\\\s)\")).test(output[prop]))\n        { output[prop] += \" \" + lineClass[2]; }\n    } }\n    return type\n  }\n\n  // Run the given mode's parser over a line, calling f for each token.\n  function runMode(cm, text, mode, context, f, lineClasses, forceToEnd) {\n    var flattenSpans = mode.flattenSpans;\n    if (flattenSpans == null) { flattenSpans = cm.options.flattenSpans; }\n    var curStart = 0, curStyle = null;\n    var stream = new StringStream(text, cm.options.tabSize, context), style;\n    var inner = cm.options.addModeClass && [null];\n    if (text == \"\") { extractLineClasses(callBlankLine(mode, context.state), lineClasses); }\n    while (!stream.eol()) {\n      if (stream.pos > cm.options.maxHighlightLength) {\n        flattenSpans = false;\n        if (forceToEnd) { processLine(cm, text, context, stream.pos); }\n        stream.pos = text.length;\n        style = null;\n      } else {\n        style = extractLineClasses(readToken(mode, stream, context.state, inner), lineClasses);\n      }\n      if (inner) {\n        var mName = inner[0].name;\n        if (mName) { style = \"m-\" + (style ? mName + \" \" + style : mName); }\n      }\n      if (!flattenSpans || curStyle != style) {\n        while (curStart < stream.start) {\n          curStart = Math.min(stream.start, curStart + 5000);\n          f(curStart, curStyle);\n        }\n        curStyle = style;\n      }\n      stream.start = stream.pos;\n    }\n    while (curStart < stream.pos) {\n      // Webkit seems to refuse to render text nodes longer than 57444\n      // characters, and returns inaccurate measurements in nodes\n      // starting around 5000 chars.\n      var pos = Math.min(stream.pos, curStart + 5000);\n      f(pos, curStyle);\n      curStart = pos;\n    }\n  }\n\n  // Finds the line to start with when starting a parse. Tries to\n  // find a line with a stateAfter, so that it can start with a\n  // valid state. If that fails, it returns the line with the\n  // smallest indentation, which tends to need the least context to\n  // parse correctly.\n  function findStartLine(cm, n, precise) {\n    var minindent, minline, doc = cm.doc;\n    var lim = precise ? -1 : n - (cm.doc.mode.innerMode ? 1000 : 100);\n    for (var search = n; search > lim; --search) {\n      if (search <= doc.first) { return doc.first }\n      var line = getLine(doc, search - 1), after = line.stateAfter;\n      if (after && (!precise || search + (after instanceof SavedContext ? after.lookAhead : 0) <= doc.modeFrontier))\n        { return search }\n      var indented = countColumn(line.text, null, cm.options.tabSize);\n      if (minline == null || minindent > indented) {\n        minline = search - 1;\n        minindent = indented;\n      }\n    }\n    return minline\n  }\n\n  function retreatFrontier(doc, n) {\n    doc.modeFrontier = Math.min(doc.modeFrontier, n);\n    if (doc.highlightFrontier < n - 10) { return }\n    var start = doc.first;\n    for (var line = n - 1; line > start; line--) {\n      var saved = getLine(doc, line).stateAfter;\n      // change is on 3\n      // state on line 1 looked ahead 2 -- so saw 3\n      // test 1 + 2 < 3 should cover this\n      if (saved && (!(saved instanceof SavedContext) || line + saved.lookAhead < n)) {\n        start = line + 1;\n        break\n      }\n    }\n    doc.highlightFrontier = Math.min(doc.highlightFrontier, start);\n  }\n\n  // Optimize some code when these features are not used.\n  var sawReadOnlySpans = false, sawCollapsedSpans = false;\n\n  function seeReadOnlySpans() {\n    sawReadOnlySpans = true;\n  }\n\n  function seeCollapsedSpans() {\n    sawCollapsedSpans = true;\n  }\n\n  // TEXTMARKER SPANS\n\n  function MarkedSpan(marker, from, to) {\n    this.marker = marker;\n    this.from = from; this.to = to;\n  }\n\n  // Search an array of spans for a span matching the given marker.\n  function getMarkedSpanFor(spans, marker) {\n    if (spans) { for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.marker == marker) { return span }\n    } }\n  }\n  // Remove a span from an array, returning undefined if no spans are\n  // left (we don't store arrays for lines without spans).\n  function removeMarkedSpan(spans, span) {\n    var r;\n    for (var i = 0; i < spans.length; ++i)\n      { if (spans[i] != span) { (r || (r = [])).push(spans[i]); } }\n    return r\n  }\n  // Add a span to a line.\n  function addMarkedSpan(line, span) {\n    line.markedSpans = line.markedSpans ? line.markedSpans.concat([span]) : [span];\n    span.marker.attachLine(line);\n  }\n\n  // Used for the algorithm that adjusts markers for a change in the\n  // document. These functions cut an array of spans at a given\n  // character position, returning an array of remaining chunks (or\n  // undefined if nothing remains).\n  function markedSpansBefore(old, startCh, isInsert) {\n    var nw;\n    if (old) { for (var i = 0; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= startCh : span.from < startCh);\n      if (startsBefore || span.from == startCh && marker.type == \"bookmark\" && (!isInsert || !span.marker.insertLeft)) {\n        var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= startCh : span.to > startCh)\n        ;(nw || (nw = [])).push(new MarkedSpan(marker, span.from, endsAfter ? null : span.to));\n      }\n    } }\n    return nw\n  }\n  function markedSpansAfter(old, endCh, isInsert) {\n    var nw;\n    if (old) { for (var i = 0; i < old.length; ++i) {\n      var span = old[i], marker = span.marker;\n      var endsAfter = span.to == null || (marker.inclusiveRight ? span.to >= endCh : span.to > endCh);\n      if (endsAfter || span.from == endCh && marker.type == \"bookmark\" && (!isInsert || span.marker.insertLeft)) {\n        var startsBefore = span.from == null || (marker.inclusiveLeft ? span.from <= endCh : span.from < endCh)\n        ;(nw || (nw = [])).push(new MarkedSpan(marker, startsBefore ? null : span.from - endCh,\n                                              span.to == null ? null : span.to - endCh));\n      }\n    } }\n    return nw\n  }\n\n  // Given a change object, compute the new set of marker spans that\n  // cover the line in which the change took place. Removes spans\n  // entirely within the change, reconnects spans belonging to the\n  // same marker that appear on both sides of the change, and cuts off\n  // spans partially within the change. Returns an array of span\n  // arrays with one element for each line in (after) the change.\n  function stretchSpansOverChange(doc, change) {\n    if (change.full) { return null }\n    var oldFirst = isLine(doc, change.from.line) && getLine(doc, change.from.line).markedSpans;\n    var oldLast = isLine(doc, change.to.line) && getLine(doc, change.to.line).markedSpans;\n    if (!oldFirst && !oldLast) { return null }\n\n    var startCh = change.from.ch, endCh = change.to.ch, isInsert = cmp(change.from, change.to) == 0;\n    // Get the spans that 'stick out' on both sides\n    var first = markedSpansBefore(oldFirst, startCh, isInsert);\n    var last = markedSpansAfter(oldLast, endCh, isInsert);\n\n    // Next, merge those two ends\n    var sameLine = change.text.length == 1, offset = lst(change.text).length + (sameLine ? startCh : 0);\n    if (first) {\n      // Fix up .to properties of first\n      for (var i = 0; i < first.length; ++i) {\n        var span = first[i];\n        if (span.to == null) {\n          var found = getMarkedSpanFor(last, span.marker);\n          if (!found) { span.to = startCh; }\n          else if (sameLine) { span.to = found.to == null ? null : found.to + offset; }\n        }\n      }\n    }\n    if (last) {\n      // Fix up .from in last (or move them into first in case of sameLine)\n      for (var i$1 = 0; i$1 < last.length; ++i$1) {\n        var span$1 = last[i$1];\n        if (span$1.to != null) { span$1.to += offset; }\n        if (span$1.from == null) {\n          var found$1 = getMarkedSpanFor(first, span$1.marker);\n          if (!found$1) {\n            span$1.from = offset;\n            if (sameLine) { (first || (first = [])).push(span$1); }\n          }\n        } else {\n          span$1.from += offset;\n          if (sameLine) { (first || (first = [])).push(span$1); }\n        }\n      }\n    }\n    // Make sure we didn't create any zero-length spans\n    if (first) { first = clearEmptySpans(first); }\n    if (last && last != first) { last = clearEmptySpans(last); }\n\n    var newMarkers = [first];\n    if (!sameLine) {\n      // Fill gap with whole-line-spans\n      var gap = change.text.length - 2, gapMarkers;\n      if (gap > 0 && first)\n        { for (var i$2 = 0; i$2 < first.length; ++i$2)\n          { if (first[i$2].to == null)\n            { (gapMarkers || (gapMarkers = [])).push(new MarkedSpan(first[i$2].marker, null, null)); } } }\n      for (var i$3 = 0; i$3 < gap; ++i$3)\n        { newMarkers.push(gapMarkers); }\n      newMarkers.push(last);\n    }\n    return newMarkers\n  }\n\n  // Remove spans that are empty and don't have a clearWhenEmpty\n  // option of false.\n  function clearEmptySpans(spans) {\n    for (var i = 0; i < spans.length; ++i) {\n      var span = spans[i];\n      if (span.from != null && span.from == span.to && span.marker.clearWhenEmpty !== false)\n        { spans.splice(i--, 1); }\n    }\n    if (!spans.length) { return null }\n    return spans\n  }\n\n  // Used to 'clip' out readOnly ranges when making a change.\n  function removeReadOnlyRanges(doc, from, to) {\n    var markers = null;\n    doc.iter(from.line, to.line + 1, function (line) {\n      if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n        var mark = line.markedSpans[i].marker;\n        if (mark.readOnly && (!markers || indexOf(markers, mark) == -1))\n          { (markers || (markers = [])).push(mark); }\n      } }\n    });\n    if (!markers) { return null }\n    var parts = [{from: from, to: to}];\n    for (var i = 0; i < markers.length; ++i) {\n      var mk = markers[i], m = mk.find(0);\n      for (var j = 0; j < parts.length; ++j) {\n        var p = parts[j];\n        if (cmp(p.to, m.from) < 0 || cmp(p.from, m.to) > 0) { continue }\n        var newParts = [j, 1], dfrom = cmp(p.from, m.from), dto = cmp(p.to, m.to);\n        if (dfrom < 0 || !mk.inclusiveLeft && !dfrom)\n          { newParts.push({from: p.from, to: m.from}); }\n        if (dto > 0 || !mk.inclusiveRight && !dto)\n          { newParts.push({from: m.to, to: p.to}); }\n        parts.splice.apply(parts, newParts);\n        j += newParts.length - 3;\n      }\n    }\n    return parts\n  }\n\n  // Connect or disconnect spans from a line.\n  function detachMarkedSpans(line) {\n    var spans = line.markedSpans;\n    if (!spans) { return }\n    for (var i = 0; i < spans.length; ++i)\n      { spans[i].marker.detachLine(line); }\n    line.markedSpans = null;\n  }\n  function attachMarkedSpans(line, spans) {\n    if (!spans) { return }\n    for (var i = 0; i < spans.length; ++i)\n      { spans[i].marker.attachLine(line); }\n    line.markedSpans = spans;\n  }\n\n  // Helpers used when computing which overlapping collapsed span\n  // counts as the larger one.\n  function extraLeft(marker) { return marker.inclusiveLeft ? -1 : 0 }\n  function extraRight(marker) { return marker.inclusiveRight ? 1 : 0 }\n\n  // Returns a number indicating which of two overlapping collapsed\n  // spans is larger (and thus includes the other). Falls back to\n  // comparing ids when the spans cover exactly the same range.\n  function compareCollapsedMarkers(a, b) {\n    var lenDiff = a.lines.length - b.lines.length;\n    if (lenDiff != 0) { return lenDiff }\n    var aPos = a.find(), bPos = b.find();\n    var fromCmp = cmp(aPos.from, bPos.from) || extraLeft(a) - extraLeft(b);\n    if (fromCmp) { return -fromCmp }\n    var toCmp = cmp(aPos.to, bPos.to) || extraRight(a) - extraRight(b);\n    if (toCmp) { return toCmp }\n    return b.id - a.id\n  }\n\n  // Find out whether a line ends or starts in a collapsed span. If\n  // so, return the marker for that span.\n  function collapsedSpanAtSide(line, start) {\n    var sps = sawCollapsedSpans && line.markedSpans, found;\n    if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (sp.marker.collapsed && (start ? sp.from : sp.to) == null &&\n          (!found || compareCollapsedMarkers(found, sp.marker) < 0))\n        { found = sp.marker; }\n    } }\n    return found\n  }\n  function collapsedSpanAtStart(line) { return collapsedSpanAtSide(line, true) }\n  function collapsedSpanAtEnd(line) { return collapsedSpanAtSide(line, false) }\n\n  function collapsedSpanAround(line, ch) {\n    var sps = sawCollapsedSpans && line.markedSpans, found;\n    if (sps) { for (var i = 0; i < sps.length; ++i) {\n      var sp = sps[i];\n      if (sp.marker.collapsed && (sp.from == null || sp.from < ch) && (sp.to == null || sp.to > ch) &&\n          (!found || compareCollapsedMarkers(found, sp.marker) < 0)) { found = sp.marker; }\n    } }\n    return found\n  }\n\n  // Test whether there exists a collapsed span that partially\n  // overlaps (covers the start or end, but not both) of a new span.\n  // Such overlap is not allowed.\n  function conflictingCollapsedRange(doc, lineNo, from, to, marker) {\n    var line = getLine(doc, lineNo);\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) { for (var i = 0; i < sps.length; ++i) {\n      var sp = sps[i];\n      if (!sp.marker.collapsed) { continue }\n      var found = sp.marker.find(0);\n      var fromCmp = cmp(found.from, from) || extraLeft(sp.marker) - extraLeft(marker);\n      var toCmp = cmp(found.to, to) || extraRight(sp.marker) - extraRight(marker);\n      if (fromCmp >= 0 && toCmp <= 0 || fromCmp <= 0 && toCmp >= 0) { continue }\n      if (fromCmp <= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.to, from) >= 0 : cmp(found.to, from) > 0) ||\n          fromCmp >= 0 && (sp.marker.inclusiveRight && marker.inclusiveLeft ? cmp(found.from, to) <= 0 : cmp(found.from, to) < 0))\n        { return true }\n    } }\n  }\n\n  // A visual line is a line as drawn on the screen. Folding, for\n  // example, can cause multiple logical lines to appear on the same\n  // visual line. This finds the start of the visual line that the\n  // given line is part of (usually that is the line itself).\n  function visualLine(line) {\n    var merged;\n    while (merged = collapsedSpanAtStart(line))\n      { line = merged.find(-1, true).line; }\n    return line\n  }\n\n  function visualLineEnd(line) {\n    var merged;\n    while (merged = collapsedSpanAtEnd(line))\n      { line = merged.find(1, true).line; }\n    return line\n  }\n\n  // Returns an array of logical lines that continue the visual line\n  // started by the argument, or undefined if there are no such lines.\n  function visualLineContinued(line) {\n    var merged, lines;\n    while (merged = collapsedSpanAtEnd(line)) {\n      line = merged.find(1, true).line\n      ;(lines || (lines = [])).push(line);\n    }\n    return lines\n  }\n\n  // Get the line number of the start of the visual line that the\n  // given line number is part of.\n  function visualLineNo(doc, lineN) {\n    var line = getLine(doc, lineN), vis = visualLine(line);\n    if (line == vis) { return lineN }\n    return lineNo(vis)\n  }\n\n  // Get the line number of the start of the next visual line after\n  // the given line.\n  function visualLineEndNo(doc, lineN) {\n    if (lineN > doc.lastLine()) { return lineN }\n    var line = getLine(doc, lineN), merged;\n    if (!lineIsHidden(doc, line)) { return lineN }\n    while (merged = collapsedSpanAtEnd(line))\n      { line = merged.find(1, true).line; }\n    return lineNo(line) + 1\n  }\n\n  // Compute whether a line is hidden. Lines count as hidden when they\n  // are part of a visual line that starts with another line, or when\n  // they are entirely covered by collapsed, non-widget span.\n  function lineIsHidden(doc, line) {\n    var sps = sawCollapsedSpans && line.markedSpans;\n    if (sps) { for (var sp = (void 0), i = 0; i < sps.length; ++i) {\n      sp = sps[i];\n      if (!sp.marker.collapsed) { continue }\n      if (sp.from == null) { return true }\n      if (sp.marker.widgetNode) { continue }\n      if (sp.from == 0 && sp.marker.inclusiveLeft && lineIsHiddenInner(doc, line, sp))\n        { return true }\n    } }\n  }\n  function lineIsHiddenInner(doc, line, span) {\n    if (span.to == null) {\n      var end = span.marker.find(1, true);\n      return lineIsHiddenInner(doc, end.line, getMarkedSpanFor(end.line.markedSpans, span.marker))\n    }\n    if (span.marker.inclusiveRight && span.to == line.text.length)\n      { return true }\n    for (var sp = (void 0), i = 0; i < line.markedSpans.length; ++i) {\n      sp = line.markedSpans[i];\n      if (sp.marker.collapsed && !sp.marker.widgetNode && sp.from == span.to &&\n          (sp.to == null || sp.to != span.from) &&\n          (sp.marker.inclusiveLeft || span.marker.inclusiveRight) &&\n          lineIsHiddenInner(doc, line, sp)) { return true }\n    }\n  }\n\n  // Find the height above the given line.\n  function heightAtLine(lineObj) {\n    lineObj = visualLine(lineObj);\n\n    var h = 0, chunk = lineObj.parent;\n    for (var i = 0; i < chunk.lines.length; ++i) {\n      var line = chunk.lines[i];\n      if (line == lineObj) { break }\n      else { h += line.height; }\n    }\n    for (var p = chunk.parent; p; chunk = p, p = chunk.parent) {\n      for (var i$1 = 0; i$1 < p.children.length; ++i$1) {\n        var cur = p.children[i$1];\n        if (cur == chunk) { break }\n        else { h += cur.height; }\n      }\n    }\n    return h\n  }\n\n  // Compute the character length of a line, taking into account\n  // collapsed ranges (see markText) that might hide parts, and join\n  // other lines onto it.\n  function lineLength(line) {\n    if (line.height == 0) { return 0 }\n    var len = line.text.length, merged, cur = line;\n    while (merged = collapsedSpanAtStart(cur)) {\n      var found = merged.find(0, true);\n      cur = found.from.line;\n      len += found.from.ch - found.to.ch;\n    }\n    cur = line;\n    while (merged = collapsedSpanAtEnd(cur)) {\n      var found$1 = merged.find(0, true);\n      len -= cur.text.length - found$1.from.ch;\n      cur = found$1.to.line;\n      len += cur.text.length - found$1.to.ch;\n    }\n    return len\n  }\n\n  // Find the longest line in the document.\n  function findMaxLine(cm) {\n    var d = cm.display, doc = cm.doc;\n    d.maxLine = getLine(doc, doc.first);\n    d.maxLineLength = lineLength(d.maxLine);\n    d.maxLineChanged = true;\n    doc.iter(function (line) {\n      var len = lineLength(line);\n      if (len > d.maxLineLength) {\n        d.maxLineLength = len;\n        d.maxLine = line;\n      }\n    });\n  }\n\n  // LINE DATA STRUCTURE\n\n  // Line objects. These hold state related to a line, including\n  // highlighting info (the styles array).\n  var Line = function(text, markedSpans, estimateHeight) {\n    this.text = text;\n    attachMarkedSpans(this, markedSpans);\n    this.height = estimateHeight ? estimateHeight(this) : 1;\n  };\n\n  Line.prototype.lineNo = function () { return lineNo(this) };\n  eventMixin(Line);\n\n  // Change the content (text, markers) of a line. Automatically\n  // invalidates cached information and tries to re-estimate the\n  // line's height.\n  function updateLine(line, text, markedSpans, estimateHeight) {\n    line.text = text;\n    if (line.stateAfter) { line.stateAfter = null; }\n    if (line.styles) { line.styles = null; }\n    if (line.order != null) { line.order = null; }\n    detachMarkedSpans(line);\n    attachMarkedSpans(line, markedSpans);\n    var estHeight = estimateHeight ? estimateHeight(line) : 1;\n    if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n  }\n\n  // Detach a line from the document tree and its markers.\n  function cleanUpLine(line) {\n    line.parent = null;\n    detachMarkedSpans(line);\n  }\n\n  // Convert a style as returned by a mode (either null, or a string\n  // containing one or more styles) to a CSS style. This is cached,\n  // and also looks for line-wide styles.\n  var styleToClassCache = {}, styleToClassCacheWithMode = {};\n  function interpretTokenStyle(style, options) {\n    if (!style || /^\\s*$/.test(style)) { return null }\n    var cache = options.addModeClass ? styleToClassCacheWithMode : styleToClassCache;\n    return cache[style] ||\n      (cache[style] = style.replace(/\\S+/g, \"cm-$&\"))\n  }\n\n  // Render the DOM representation of the text of a line. Also builds\n  // up a 'line map', which points at the DOM nodes that represent\n  // specific stretches of text, and is used by the measuring code.\n  // The returned object contains the DOM node, this map, and\n  // information about line-wide styles that were set by the mode.\n  function buildLineContent(cm, lineView) {\n    // The padding-right forces the element to have a 'border', which\n    // is needed on Webkit to be able to get line-level bounding\n    // rectangles for it (in measureChar).\n    var content = eltP(\"span\", null, null, webkit ? \"padding-right: .1px\" : null);\n    var builder = {pre: eltP(\"pre\", [content], \"CodeMirror-line\"), content: content,\n                   col: 0, pos: 0, cm: cm,\n                   trailingSpace: false,\n                   splitSpaces: cm.getOption(\"lineWrapping\")};\n    lineView.measure = {};\n\n    // Iterate over the logical lines that make up this visual line.\n    for (var i = 0; i <= (lineView.rest ? lineView.rest.length : 0); i++) {\n      var line = i ? lineView.rest[i - 1] : lineView.line, order = (void 0);\n      builder.pos = 0;\n      builder.addToken = buildToken;\n      // Optionally wire in some hacks into the token-rendering\n      // algorithm, to deal with browser quirks.\n      if (hasBadBidiRects(cm.display.measure) && (order = getOrder(line, cm.doc.direction)))\n        { builder.addToken = buildTokenBadBidi(builder.addToken, order); }\n      builder.map = [];\n      var allowFrontierUpdate = lineView != cm.display.externalMeasured && lineNo(line);\n      insertLineContent(line, builder, getLineStyles(cm, line, allowFrontierUpdate));\n      if (line.styleClasses) {\n        if (line.styleClasses.bgClass)\n          { builder.bgClass = joinClasses(line.styleClasses.bgClass, builder.bgClass || \"\"); }\n        if (line.styleClasses.textClass)\n          { builder.textClass = joinClasses(line.styleClasses.textClass, builder.textClass || \"\"); }\n      }\n\n      // Ensure at least a single node is present, for measuring.\n      if (builder.map.length == 0)\n        { builder.map.push(0, 0, builder.content.appendChild(zeroWidthElement(cm.display.measure))); }\n\n      // Store the map and a cache object for the current logical line\n      if (i == 0) {\n        lineView.measure.map = builder.map;\n        lineView.measure.cache = {};\n      } else {\n  (lineView.measure.maps || (lineView.measure.maps = [])).push(builder.map)\n        ;(lineView.measure.caches || (lineView.measure.caches = [])).push({});\n      }\n    }\n\n    // See issue #2901\n    if (webkit) {\n      var last = builder.content.lastChild;\n      if (/\\bcm-tab\\b/.test(last.className) || (last.querySelector && last.querySelector(\".cm-tab\")))\n        { builder.content.className = \"cm-tab-wrap-hack\"; }\n    }\n\n    signal(cm, \"renderLine\", cm, lineView.line, builder.pre);\n    if (builder.pre.className)\n      { builder.textClass = joinClasses(builder.pre.className, builder.textClass || \"\"); }\n\n    return builder\n  }\n\n  function defaultSpecialCharPlaceholder(ch) {\n    var token = elt(\"span\", \"\\u2022\", \"cm-invalidchar\");\n    token.title = \"\\\\u\" + ch.charCodeAt(0).toString(16);\n    token.setAttribute(\"aria-label\", token.title);\n    return token\n  }\n\n  // Build up the DOM representation for a single token, and add it to\n  // the line map. Takes care to render special characters separately.\n  function buildToken(builder, text, style, startStyle, endStyle, css, attributes) {\n    if (!text) { return }\n    var displayText = builder.splitSpaces ? splitSpaces(text, builder.trailingSpace) : text;\n    var special = builder.cm.state.specialChars, mustWrap = false;\n    var content;\n    if (!special.test(text)) {\n      builder.col += text.length;\n      content = document.createTextNode(displayText);\n      builder.map.push(builder.pos, builder.pos + text.length, content);\n      if (ie && ie_version < 9) { mustWrap = true; }\n      builder.pos += text.length;\n    } else {\n      content = document.createDocumentFragment();\n      var pos = 0;\n      while (true) {\n        special.lastIndex = pos;\n        var m = special.exec(text);\n        var skipped = m ? m.index - pos : text.length - pos;\n        if (skipped) {\n          var txt = document.createTextNode(displayText.slice(pos, pos + skipped));\n          if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt])); }\n          else { content.appendChild(txt); }\n          builder.map.push(builder.pos, builder.pos + skipped, txt);\n          builder.col += skipped;\n          builder.pos += skipped;\n        }\n        if (!m) { break }\n        pos += skipped + 1;\n        var txt$1 = (void 0);\n        if (m[0] == \"\\t\") {\n          var tabSize = builder.cm.options.tabSize, tabWidth = tabSize - builder.col % tabSize;\n          txt$1 = content.appendChild(elt(\"span\", spaceStr(tabWidth), \"cm-tab\"));\n          txt$1.setAttribute(\"role\", \"presentation\");\n          txt$1.setAttribute(\"cm-text\", \"\\t\");\n          builder.col += tabWidth;\n        } else if (m[0] == \"\\r\" || m[0] == \"\\n\") {\n          txt$1 = content.appendChild(elt(\"span\", m[0] == \"\\r\" ? \"\\u240d\" : \"\\u2424\", \"cm-invalidchar\"));\n          txt$1.setAttribute(\"cm-text\", m[0]);\n          builder.col += 1;\n        } else {\n          txt$1 = builder.cm.options.specialCharPlaceholder(m[0]);\n          txt$1.setAttribute(\"cm-text\", m[0]);\n          if (ie && ie_version < 9) { content.appendChild(elt(\"span\", [txt$1])); }\n          else { content.appendChild(txt$1); }\n          builder.col += 1;\n        }\n        builder.map.push(builder.pos, builder.pos + 1, txt$1);\n        builder.pos++;\n      }\n    }\n    builder.trailingSpace = displayText.charCodeAt(text.length - 1) == 32;\n    if (style || startStyle || endStyle || mustWrap || css || attributes) {\n      var fullStyle = style || \"\";\n      if (startStyle) { fullStyle += startStyle; }\n      if (endStyle) { fullStyle += endStyle; }\n      var token = elt(\"span\", [content], fullStyle, css);\n      if (attributes) {\n        for (var attr in attributes) { if (attributes.hasOwnProperty(attr) && attr != \"style\" && attr != \"class\")\n          { token.setAttribute(attr, attributes[attr]); } }\n      }\n      return builder.content.appendChild(token)\n    }\n    builder.content.appendChild(content);\n  }\n\n  // Change some spaces to NBSP to prevent the browser from collapsing\n  // trailing spaces at the end of a line when rendering text (issue #1362).\n  function splitSpaces(text, trailingBefore) {\n    if (text.length > 1 && !/  /.test(text)) { return text }\n    var spaceBefore = trailingBefore, result = \"\";\n    for (var i = 0; i < text.length; i++) {\n      var ch = text.charAt(i);\n      if (ch == \" \" && spaceBefore && (i == text.length - 1 || text.charCodeAt(i + 1) == 32))\n        { ch = \"\\u00a0\"; }\n      result += ch;\n      spaceBefore = ch == \" \";\n    }\n    return result\n  }\n\n  // Work around nonsense dimensions being reported for stretches of\n  // right-to-left text.\n  function buildTokenBadBidi(inner, order) {\n    return function (builder, text, style, startStyle, endStyle, css, attributes) {\n      style = style ? style + \" cm-force-border\" : \"cm-force-border\";\n      var start = builder.pos, end = start + text.length;\n      for (;;) {\n        // Find the part that overlaps with the start of this text\n        var part = (void 0);\n        for (var i = 0; i < order.length; i++) {\n          part = order[i];\n          if (part.to > start && part.from <= start) { break }\n        }\n        if (part.to >= end) { return inner(builder, text, style, startStyle, endStyle, css, attributes) }\n        inner(builder, text.slice(0, part.to - start), style, startStyle, null, css, attributes);\n        startStyle = null;\n        text = text.slice(part.to - start);\n        start = part.to;\n      }\n    }\n  }\n\n  function buildCollapsedSpan(builder, size, marker, ignoreWidget) {\n    var widget = !ignoreWidget && marker.widgetNode;\n    if (widget) { builder.map.push(builder.pos, builder.pos + size, widget); }\n    if (!ignoreWidget && builder.cm.display.input.needsContentAttribute) {\n      if (!widget)\n        { widget = builder.content.appendChild(document.createElement(\"span\")); }\n      widget.setAttribute(\"cm-marker\", marker.id);\n    }\n    if (widget) {\n      builder.cm.display.input.setUneditable(widget);\n      builder.content.appendChild(widget);\n    }\n    builder.pos += size;\n    builder.trailingSpace = false;\n  }\n\n  // Outputs a number of spans to make up a line, taking highlighting\n  // and marked text into account.\n  function insertLineContent(line, builder, styles) {\n    var spans = line.markedSpans, allText = line.text, at = 0;\n    if (!spans) {\n      for (var i$1 = 1; i$1 < styles.length; i$1+=2)\n        { builder.addToken(builder, allText.slice(at, at = styles[i$1]), interpretTokenStyle(styles[i$1+1], builder.cm.options)); }\n      return\n    }\n\n    var len = allText.length, pos = 0, i = 1, text = \"\", style, css;\n    var nextChange = 0, spanStyle, spanEndStyle, spanStartStyle, collapsed, attributes;\n    for (;;) {\n      if (nextChange == pos) { // Update current marker set\n        spanStyle = spanEndStyle = spanStartStyle = css = \"\";\n        attributes = null;\n        collapsed = null; nextChange = Infinity;\n        var foundBookmarks = [], endStyles = (void 0);\n        for (var j = 0; j < spans.length; ++j) {\n          var sp = spans[j], m = sp.marker;\n          if (m.type == \"bookmark\" && sp.from == pos && m.widgetNode) {\n            foundBookmarks.push(m);\n          } else if (sp.from <= pos && (sp.to == null || sp.to > pos || m.collapsed && sp.to == pos && sp.from == pos)) {\n            if (sp.to != null && sp.to != pos && nextChange > sp.to) {\n              nextChange = sp.to;\n              spanEndStyle = \"\";\n            }\n            if (m.className) { spanStyle += \" \" + m.className; }\n            if (m.css) { css = (css ? css + \";\" : \"\") + m.css; }\n            if (m.startStyle && sp.from == pos) { spanStartStyle += \" \" + m.startStyle; }\n            if (m.endStyle && sp.to == nextChange) { (endStyles || (endStyles = [])).push(m.endStyle, sp.to); }\n            // support for the old title property\n            // https://github.com/codemirror/CodeMirror/pull/5673\n            if (m.title) { (attributes || (attributes = {})).title = m.title; }\n            if (m.attributes) {\n              for (var attr in m.attributes)\n                { (attributes || (attributes = {}))[attr] = m.attributes[attr]; }\n            }\n            if (m.collapsed && (!collapsed || compareCollapsedMarkers(collapsed.marker, m) < 0))\n              { collapsed = sp; }\n          } else if (sp.from > pos && nextChange > sp.from) {\n            nextChange = sp.from;\n          }\n        }\n        if (endStyles) { for (var j$1 = 0; j$1 < endStyles.length; j$1 += 2)\n          { if (endStyles[j$1 + 1] == nextChange) { spanEndStyle += \" \" + endStyles[j$1]; } } }\n\n        if (!collapsed || collapsed.from == pos) { for (var j$2 = 0; j$2 < foundBookmarks.length; ++j$2)\n          { buildCollapsedSpan(builder, 0, foundBookmarks[j$2]); } }\n        if (collapsed && (collapsed.from || 0) == pos) {\n          buildCollapsedSpan(builder, (collapsed.to == null ? len + 1 : collapsed.to) - pos,\n                             collapsed.marker, collapsed.from == null);\n          if (collapsed.to == null) { return }\n          if (collapsed.to == pos) { collapsed = false; }\n        }\n      }\n      if (pos >= len) { break }\n\n      var upto = Math.min(len, nextChange);\n      while (true) {\n        if (text) {\n          var end = pos + text.length;\n          if (!collapsed) {\n            var tokenText = end > upto ? text.slice(0, upto - pos) : text;\n            builder.addToken(builder, tokenText, style ? style + spanStyle : spanStyle,\n                             spanStartStyle, pos + tokenText.length == nextChange ? spanEndStyle : \"\", css, attributes);\n          }\n          if (end >= upto) {text = text.slice(upto - pos); pos = upto; break}\n          pos = end;\n          spanStartStyle = \"\";\n        }\n        text = allText.slice(at, at = styles[i++]);\n        style = interpretTokenStyle(styles[i++], builder.cm.options);\n      }\n    }\n  }\n\n\n  // These objects are used to represent the visible (currently drawn)\n  // part of the document. A LineView may correspond to multiple\n  // logical lines, if those are connected by collapsed ranges.\n  function LineView(doc, line, lineN) {\n    // The starting line\n    this.line = line;\n    // Continuing lines, if any\n    this.rest = visualLineContinued(line);\n    // Number of logical lines in this visual line\n    this.size = this.rest ? lineNo(lst(this.rest)) - lineN + 1 : 1;\n    this.node = this.text = null;\n    this.hidden = lineIsHidden(doc, line);\n  }\n\n  // Create a range of LineView objects for the given lines.\n  function buildViewArray(cm, from, to) {\n    var array = [], nextPos;\n    for (var pos = from; pos < to; pos = nextPos) {\n      var view = new LineView(cm.doc, getLine(cm.doc, pos), pos);\n      nextPos = pos + view.size;\n      array.push(view);\n    }\n    return array\n  }\n\n  var operationGroup = null;\n\n  function pushOperation(op) {\n    if (operationGroup) {\n      operationGroup.ops.push(op);\n    } else {\n      op.ownsGroup = operationGroup = {\n        ops: [op],\n        delayedCallbacks: []\n      };\n    }\n  }\n\n  function fireCallbacksForOps(group) {\n    // Calls delayed callbacks and cursorActivity handlers until no\n    // new ones appear\n    var callbacks = group.delayedCallbacks, i = 0;\n    do {\n      for (; i < callbacks.length; i++)\n        { callbacks[i].call(null); }\n      for (var j = 0; j < group.ops.length; j++) {\n        var op = group.ops[j];\n        if (op.cursorActivityHandlers)\n          { while (op.cursorActivityCalled < op.cursorActivityHandlers.length)\n            { op.cursorActivityHandlers[op.cursorActivityCalled++].call(null, op.cm); } }\n      }\n    } while (i < callbacks.length)\n  }\n\n  function finishOperation(op, endCb) {\n    var group = op.ownsGroup;\n    if (!group) { return }\n\n    try { fireCallbacksForOps(group); }\n    finally {\n      operationGroup = null;\n      endCb(group);\n    }\n  }\n\n  var orphanDelayedCallbacks = null;\n\n  // Often, we want to signal events at a point where we are in the\n  // middle of some work, but don't want the handler to start calling\n  // other methods on the editor, which might be in an inconsistent\n  // state or simply not expect any other events to happen.\n  // signalLater looks whether there are any handlers, and schedules\n  // them to be executed when the last operation ends, or, if no\n  // operation is active, when a timeout fires.\n  function signalLater(emitter, type /*, values...*/) {\n    var arr = getHandlers(emitter, type);\n    if (!arr.length) { return }\n    var args = Array.prototype.slice.call(arguments, 2), list;\n    if (operationGroup) {\n      list = operationGroup.delayedCallbacks;\n    } else if (orphanDelayedCallbacks) {\n      list = orphanDelayedCallbacks;\n    } else {\n      list = orphanDelayedCallbacks = [];\n      setTimeout(fireOrphanDelayed, 0);\n    }\n    var loop = function ( i ) {\n      list.push(function () { return arr[i].apply(null, args); });\n    };\n\n    for (var i = 0; i < arr.length; ++i)\n      loop( i );\n  }\n\n  function fireOrphanDelayed() {\n    var delayed = orphanDelayedCallbacks;\n    orphanDelayedCallbacks = null;\n    for (var i = 0; i < delayed.length; ++i) { delayed[i](); }\n  }\n\n  // When an aspect of a line changes, a string is added to\n  // lineView.changes. This updates the relevant part of the line's\n  // DOM structure.\n  function updateLineForChanges(cm, lineView, lineN, dims) {\n    for (var j = 0; j < lineView.changes.length; j++) {\n      var type = lineView.changes[j];\n      if (type == \"text\") { updateLineText(cm, lineView); }\n      else if (type == \"gutter\") { updateLineGutter(cm, lineView, lineN, dims); }\n      else if (type == \"class\") { updateLineClasses(cm, lineView); }\n      else if (type == \"widget\") { updateLineWidgets(cm, lineView, dims); }\n    }\n    lineView.changes = null;\n  }\n\n  // Lines with gutter elements, widgets or a background class need to\n  // be wrapped, and have the extra elements added to the wrapper div\n  function ensureLineWrapped(lineView) {\n    if (lineView.node == lineView.text) {\n      lineView.node = elt(\"div\", null, null, \"position: relative\");\n      if (lineView.text.parentNode)\n        { lineView.text.parentNode.replaceChild(lineView.node, lineView.text); }\n      lineView.node.appendChild(lineView.text);\n      if (ie && ie_version < 8) { lineView.node.style.zIndex = 2; }\n    }\n    return lineView.node\n  }\n\n  function updateLineBackground(cm, lineView) {\n    var cls = lineView.bgClass ? lineView.bgClass + \" \" + (lineView.line.bgClass || \"\") : lineView.line.bgClass;\n    if (cls) { cls += \" CodeMirror-linebackground\"; }\n    if (lineView.background) {\n      if (cls) { lineView.background.className = cls; }\n      else { lineView.background.parentNode.removeChild(lineView.background); lineView.background = null; }\n    } else if (cls) {\n      var wrap = ensureLineWrapped(lineView);\n      lineView.background = wrap.insertBefore(elt(\"div\", null, cls), wrap.firstChild);\n      cm.display.input.setUneditable(lineView.background);\n    }\n  }\n\n  // Wrapper around buildLineContent which will reuse the structure\n  // in display.externalMeasured when possible.\n  function getLineContent(cm, lineView) {\n    var ext = cm.display.externalMeasured;\n    if (ext && ext.line == lineView.line) {\n      cm.display.externalMeasured = null;\n      lineView.measure = ext.measure;\n      return ext.built\n    }\n    return buildLineContent(cm, lineView)\n  }\n\n  // Redraw the line's text. Interacts with the background and text\n  // classes because the mode may output tokens that influence these\n  // classes.\n  function updateLineText(cm, lineView) {\n    var cls = lineView.text.className;\n    var built = getLineContent(cm, lineView);\n    if (lineView.text == lineView.node) { lineView.node = built.pre; }\n    lineView.text.parentNode.replaceChild(built.pre, lineView.text);\n    lineView.text = built.pre;\n    if (built.bgClass != lineView.bgClass || built.textClass != lineView.textClass) {\n      lineView.bgClass = built.bgClass;\n      lineView.textClass = built.textClass;\n      updateLineClasses(cm, lineView);\n    } else if (cls) {\n      lineView.text.className = cls;\n    }\n  }\n\n  function updateLineClasses(cm, lineView) {\n    updateLineBackground(cm, lineView);\n    if (lineView.line.wrapClass)\n      { ensureLineWrapped(lineView).className = lineView.line.wrapClass; }\n    else if (lineView.node != lineView.text)\n      { lineView.node.className = \"\"; }\n    var textClass = lineView.textClass ? lineView.textClass + \" \" + (lineView.line.textClass || \"\") : lineView.line.textClass;\n    lineView.text.className = textClass || \"\";\n  }\n\n  function updateLineGutter(cm, lineView, lineN, dims) {\n    if (lineView.gutter) {\n      lineView.node.removeChild(lineView.gutter);\n      lineView.gutter = null;\n    }\n    if (lineView.gutterBackground) {\n      lineView.node.removeChild(lineView.gutterBackground);\n      lineView.gutterBackground = null;\n    }\n    if (lineView.line.gutterClass) {\n      var wrap = ensureLineWrapped(lineView);\n      lineView.gutterBackground = elt(\"div\", null, \"CodeMirror-gutter-background \" + lineView.line.gutterClass,\n                                      (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px; width: \" + (dims.gutterTotalWidth) + \"px\"));\n      cm.display.input.setUneditable(lineView.gutterBackground);\n      wrap.insertBefore(lineView.gutterBackground, lineView.text);\n    }\n    var markers = lineView.line.gutterMarkers;\n    if (cm.options.lineNumbers || markers) {\n      var wrap$1 = ensureLineWrapped(lineView);\n      var gutterWrap = lineView.gutter = elt(\"div\", null, \"CodeMirror-gutter-wrapper\", (\"left: \" + (cm.options.fixedGutter ? dims.fixedPos : -dims.gutterTotalWidth) + \"px\"));\n      cm.display.input.setUneditable(gutterWrap);\n      wrap$1.insertBefore(gutterWrap, lineView.text);\n      if (lineView.line.gutterClass)\n        { gutterWrap.className += \" \" + lineView.line.gutterClass; }\n      if (cm.options.lineNumbers && (!markers || !markers[\"CodeMirror-linenumbers\"]))\n        { lineView.lineNumber = gutterWrap.appendChild(\n          elt(\"div\", lineNumberFor(cm.options, lineN),\n              \"CodeMirror-linenumber CodeMirror-gutter-elt\",\n              (\"left: \" + (dims.gutterLeft[\"CodeMirror-linenumbers\"]) + \"px; width: \" + (cm.display.lineNumInnerWidth) + \"px\"))); }\n      if (markers) { for (var k = 0; k < cm.display.gutterSpecs.length; ++k) {\n        var id = cm.display.gutterSpecs[k].className, found = markers.hasOwnProperty(id) && markers[id];\n        if (found)\n          { gutterWrap.appendChild(elt(\"div\", [found], \"CodeMirror-gutter-elt\",\n                                     (\"left: \" + (dims.gutterLeft[id]) + \"px; width: \" + (dims.gutterWidth[id]) + \"px\"))); }\n      } }\n    }\n  }\n\n  function updateLineWidgets(cm, lineView, dims) {\n    if (lineView.alignable) { lineView.alignable = null; }\n    var isWidget = classTest(\"CodeMirror-linewidget\");\n    for (var node = lineView.node.firstChild, next = (void 0); node; node = next) {\n      next = node.nextSibling;\n      if (isWidget.test(node.className)) { lineView.node.removeChild(node); }\n    }\n    insertLineWidgets(cm, lineView, dims);\n  }\n\n  // Build a line's DOM representation from scratch\n  function buildLineElement(cm, lineView, lineN, dims) {\n    var built = getLineContent(cm, lineView);\n    lineView.text = lineView.node = built.pre;\n    if (built.bgClass) { lineView.bgClass = built.bgClass; }\n    if (built.textClass) { lineView.textClass = built.textClass; }\n\n    updateLineClasses(cm, lineView);\n    updateLineGutter(cm, lineView, lineN, dims);\n    insertLineWidgets(cm, lineView, dims);\n    return lineView.node\n  }\n\n  // A lineView may contain multiple logical lines (when merged by\n  // collapsed spans). The widgets for all of them need to be drawn.\n  function insertLineWidgets(cm, lineView, dims) {\n    insertLineWidgetsFor(cm, lineView.line, lineView, dims, true);\n    if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n      { insertLineWidgetsFor(cm, lineView.rest[i], lineView, dims, false); } }\n  }\n\n  function insertLineWidgetsFor(cm, line, lineView, dims, allowAbove) {\n    if (!line.widgets) { return }\n    var wrap = ensureLineWrapped(lineView);\n    for (var i = 0, ws = line.widgets; i < ws.length; ++i) {\n      var widget = ws[i], node = elt(\"div\", [widget.node], \"CodeMirror-linewidget\" + (widget.className ? \" \" + widget.className : \"\"));\n      if (!widget.handleMouseEvents) { node.setAttribute(\"cm-ignore-events\", \"true\"); }\n      positionLineWidget(widget, node, lineView, dims);\n      cm.display.input.setUneditable(node);\n      if (allowAbove && widget.above)\n        { wrap.insertBefore(node, lineView.gutter || lineView.text); }\n      else\n        { wrap.appendChild(node); }\n      signalLater(widget, \"redraw\");\n    }\n  }\n\n  function positionLineWidget(widget, node, lineView, dims) {\n    if (widget.noHScroll) {\n  (lineView.alignable || (lineView.alignable = [])).push(node);\n      var width = dims.wrapperWidth;\n      node.style.left = dims.fixedPos + \"px\";\n      if (!widget.coverGutter) {\n        width -= dims.gutterTotalWidth;\n        node.style.paddingLeft = dims.gutterTotalWidth + \"px\";\n      }\n      node.style.width = width + \"px\";\n    }\n    if (widget.coverGutter) {\n      node.style.zIndex = 5;\n      node.style.position = \"relative\";\n      if (!widget.noHScroll) { node.style.marginLeft = -dims.gutterTotalWidth + \"px\"; }\n    }\n  }\n\n  function widgetHeight(widget) {\n    if (widget.height != null) { return widget.height }\n    var cm = widget.doc.cm;\n    if (!cm) { return 0 }\n    if (!contains(document.body, widget.node)) {\n      var parentStyle = \"position: relative;\";\n      if (widget.coverGutter)\n        { parentStyle += \"margin-left: -\" + cm.display.gutters.offsetWidth + \"px;\"; }\n      if (widget.noHScroll)\n        { parentStyle += \"width: \" + cm.display.wrapper.clientWidth + \"px;\"; }\n      removeChildrenAndAdd(cm.display.measure, elt(\"div\", [widget.node], null, parentStyle));\n    }\n    return widget.height = widget.node.parentNode.offsetHeight\n  }\n\n  // Return true when the given mouse event happened in a widget\n  function eventInWidget(display, e) {\n    for (var n = e_target(e); n != display.wrapper; n = n.parentNode) {\n      if (!n || (n.nodeType == 1 && n.getAttribute(\"cm-ignore-events\") == \"true\") ||\n          (n.parentNode == display.sizer && n != display.mover))\n        { return true }\n    }\n  }\n\n  // POSITION MEASUREMENT\n\n  function paddingTop(display) {return display.lineSpace.offsetTop}\n  function paddingVert(display) {return display.mover.offsetHeight - display.lineSpace.offsetHeight}\n  function paddingH(display) {\n    if (display.cachedPaddingH) { return display.cachedPaddingH }\n    var e = removeChildrenAndAdd(display.measure, elt(\"pre\", \"x\", \"CodeMirror-line-like\"));\n    var style = window.getComputedStyle ? window.getComputedStyle(e) : e.currentStyle;\n    var data = {left: parseInt(style.paddingLeft), right: parseInt(style.paddingRight)};\n    if (!isNaN(data.left) && !isNaN(data.right)) { display.cachedPaddingH = data; }\n    return data\n  }\n\n  function scrollGap(cm) { return scrollerGap - cm.display.nativeBarWidth }\n  function displayWidth(cm) {\n    return cm.display.scroller.clientWidth - scrollGap(cm) - cm.display.barWidth\n  }\n  function displayHeight(cm) {\n    return cm.display.scroller.clientHeight - scrollGap(cm) - cm.display.barHeight\n  }\n\n  // Ensure the lineView.wrapping.heights array is populated. This is\n  // an array of bottom offsets for the lines that make up a drawn\n  // line. When lineWrapping is on, there might be more than one\n  // height.\n  function ensureLineHeights(cm, lineView, rect) {\n    var wrapping = cm.options.lineWrapping;\n    var curWidth = wrapping && displayWidth(cm);\n    if (!lineView.measure.heights || wrapping && lineView.measure.width != curWidth) {\n      var heights = lineView.measure.heights = [];\n      if (wrapping) {\n        lineView.measure.width = curWidth;\n        var rects = lineView.text.firstChild.getClientRects();\n        for (var i = 0; i < rects.length - 1; i++) {\n          var cur = rects[i], next = rects[i + 1];\n          if (Math.abs(cur.bottom - next.bottom) > 2)\n            { heights.push((cur.bottom + next.top) / 2 - rect.top); }\n        }\n      }\n      heights.push(rect.bottom - rect.top);\n    }\n  }\n\n  // Find a line map (mapping character offsets to text nodes) and a\n  // measurement cache for the given line number. (A line view might\n  // contain multiple lines when collapsed ranges are present.)\n  function mapFromLineView(lineView, line, lineN) {\n    if (lineView.line == line)\n      { return {map: lineView.measure.map, cache: lineView.measure.cache} }\n    for (var i = 0; i < lineView.rest.length; i++)\n      { if (lineView.rest[i] == line)\n        { return {map: lineView.measure.maps[i], cache: lineView.measure.caches[i]} } }\n    for (var i$1 = 0; i$1 < lineView.rest.length; i$1++)\n      { if (lineNo(lineView.rest[i$1]) > lineN)\n        { return {map: lineView.measure.maps[i$1], cache: lineView.measure.caches[i$1], before: true} } }\n  }\n\n  // Render a line into the hidden node display.externalMeasured. Used\n  // when measurement is needed for a line that's not in the viewport.\n  function updateExternalMeasurement(cm, line) {\n    line = visualLine(line);\n    var lineN = lineNo(line);\n    var view = cm.display.externalMeasured = new LineView(cm.doc, line, lineN);\n    view.lineN = lineN;\n    var built = view.built = buildLineContent(cm, view);\n    view.text = built.pre;\n    removeChildrenAndAdd(cm.display.lineMeasure, built.pre);\n    return view\n  }\n\n  // Get a {top, bottom, left, right} box (in line-local coordinates)\n  // for a given character.\n  function measureChar(cm, line, ch, bias) {\n    return measureCharPrepared(cm, prepareMeasureForLine(cm, line), ch, bias)\n  }\n\n  // Find a line view that corresponds to the given line number.\n  function findViewForLine(cm, lineN) {\n    if (lineN >= cm.display.viewFrom && lineN < cm.display.viewTo)\n      { return cm.display.view[findViewIndex(cm, lineN)] }\n    var ext = cm.display.externalMeasured;\n    if (ext && lineN >= ext.lineN && lineN < ext.lineN + ext.size)\n      { return ext }\n  }\n\n  // Measurement can be split in two steps, the set-up work that\n  // applies to the whole line, and the measurement of the actual\n  // character. Functions like coordsChar, that need to do a lot of\n  // measurements in a row, can thus ensure that the set-up work is\n  // only done once.\n  function prepareMeasureForLine(cm, line) {\n    var lineN = lineNo(line);\n    var view = findViewForLine(cm, lineN);\n    if (view && !view.text) {\n      view = null;\n    } else if (view && view.changes) {\n      updateLineForChanges(cm, view, lineN, getDimensions(cm));\n      cm.curOp.forceUpdate = true;\n    }\n    if (!view)\n      { view = updateExternalMeasurement(cm, line); }\n\n    var info = mapFromLineView(view, line, lineN);\n    return {\n      line: line, view: view, rect: null,\n      map: info.map, cache: info.cache, before: info.before,\n      hasHeights: false\n    }\n  }\n\n  // Given a prepared measurement object, measures the position of an\n  // actual character (or fetches it from the cache).\n  function measureCharPrepared(cm, prepared, ch, bias, varHeight) {\n    if (prepared.before) { ch = -1; }\n    var key = ch + (bias || \"\"), found;\n    if (prepared.cache.hasOwnProperty(key)) {\n      found = prepared.cache[key];\n    } else {\n      if (!prepared.rect)\n        { prepared.rect = prepared.view.text.getBoundingClientRect(); }\n      if (!prepared.hasHeights) {\n        ensureLineHeights(cm, prepared.view, prepared.rect);\n        prepared.hasHeights = true;\n      }\n      found = measureCharInner(cm, prepared, ch, bias);\n      if (!found.bogus) { prepared.cache[key] = found; }\n    }\n    return {left: found.left, right: found.right,\n            top: varHeight ? found.rtop : found.top,\n            bottom: varHeight ? found.rbottom : found.bottom}\n  }\n\n  var nullRect = {left: 0, right: 0, top: 0, bottom: 0};\n\n  function nodeAndOffsetInLineMap(map, ch, bias) {\n    var node, start, end, collapse, mStart, mEnd;\n    // First, search the line map for the text node corresponding to,\n    // or closest to, the target character.\n    for (var i = 0; i < map.length; i += 3) {\n      mStart = map[i];\n      mEnd = map[i + 1];\n      if (ch < mStart) {\n        start = 0; end = 1;\n        collapse = \"left\";\n      } else if (ch < mEnd) {\n        start = ch - mStart;\n        end = start + 1;\n      } else if (i == map.length - 3 || ch == mEnd && map[i + 3] > ch) {\n        end = mEnd - mStart;\n        start = end - 1;\n        if (ch >= mEnd) { collapse = \"right\"; }\n      }\n      if (start != null) {\n        node = map[i + 2];\n        if (mStart == mEnd && bias == (node.insertLeft ? \"left\" : \"right\"))\n          { collapse = bias; }\n        if (bias == \"left\" && start == 0)\n          { while (i && map[i - 2] == map[i - 3] && map[i - 1].insertLeft) {\n            node = map[(i -= 3) + 2];\n            collapse = \"left\";\n          } }\n        if (bias == \"right\" && start == mEnd - mStart)\n          { while (i < map.length - 3 && map[i + 3] == map[i + 4] && !map[i + 5].insertLeft) {\n            node = map[(i += 3) + 2];\n            collapse = \"right\";\n          } }\n        break\n      }\n    }\n    return {node: node, start: start, end: end, collapse: collapse, coverStart: mStart, coverEnd: mEnd}\n  }\n\n  function getUsefulRect(rects, bias) {\n    var rect = nullRect;\n    if (bias == \"left\") { for (var i = 0; i < rects.length; i++) {\n      if ((rect = rects[i]).left != rect.right) { break }\n    } } else { for (var i$1 = rects.length - 1; i$1 >= 0; i$1--) {\n      if ((rect = rects[i$1]).left != rect.right) { break }\n    } }\n    return rect\n  }\n\n  function measureCharInner(cm, prepared, ch, bias) {\n    var place = nodeAndOffsetInLineMap(prepared.map, ch, bias);\n    var node = place.node, start = place.start, end = place.end, collapse = place.collapse;\n\n    var rect;\n    if (node.nodeType == 3) { // If it is a text node, use a range to retrieve the coordinates.\n      for (var i$1 = 0; i$1 < 4; i$1++) { // Retry a maximum of 4 times when nonsense rectangles are returned\n        while (start && isExtendingChar(prepared.line.text.charAt(place.coverStart + start))) { --start; }\n        while (place.coverStart + end < place.coverEnd && isExtendingChar(prepared.line.text.charAt(place.coverStart + end))) { ++end; }\n        if (ie && ie_version < 9 && start == 0 && end == place.coverEnd - place.coverStart)\n          { rect = node.parentNode.getBoundingClientRect(); }\n        else\n          { rect = getUsefulRect(range(node, start, end).getClientRects(), bias); }\n        if (rect.left || rect.right || start == 0) { break }\n        end = start;\n        start = start - 1;\n        collapse = \"right\";\n      }\n      if (ie && ie_version < 11) { rect = maybeUpdateRectForZooming(cm.display.measure, rect); }\n    } else { // If it is a widget, simply get the box for the whole widget.\n      if (start > 0) { collapse = bias = \"right\"; }\n      var rects;\n      if (cm.options.lineWrapping && (rects = node.getClientRects()).length > 1)\n        { rect = rects[bias == \"right\" ? rects.length - 1 : 0]; }\n      else\n        { rect = node.getBoundingClientRect(); }\n    }\n    if (ie && ie_version < 9 && !start && (!rect || !rect.left && !rect.right)) {\n      var rSpan = node.parentNode.getClientRects()[0];\n      if (rSpan)\n        { rect = {left: rSpan.left, right: rSpan.left + charWidth(cm.display), top: rSpan.top, bottom: rSpan.bottom}; }\n      else\n        { rect = nullRect; }\n    }\n\n    var rtop = rect.top - prepared.rect.top, rbot = rect.bottom - prepared.rect.top;\n    var mid = (rtop + rbot) / 2;\n    var heights = prepared.view.measure.heights;\n    var i = 0;\n    for (; i < heights.length - 1; i++)\n      { if (mid < heights[i]) { break } }\n    var top = i ? heights[i - 1] : 0, bot = heights[i];\n    var result = {left: (collapse == \"right\" ? rect.right : rect.left) - prepared.rect.left,\n                  right: (collapse == \"left\" ? rect.left : rect.right) - prepared.rect.left,\n                  top: top, bottom: bot};\n    if (!rect.left && !rect.right) { result.bogus = true; }\n    if (!cm.options.singleCursorHeightPerLine) { result.rtop = rtop; result.rbottom = rbot; }\n\n    return result\n  }\n\n  // Work around problem with bounding client rects on ranges being\n  // returned incorrectly when zoomed on IE10 and below.\n  function maybeUpdateRectForZooming(measure, rect) {\n    if (!window.screen || screen.logicalXDPI == null ||\n        screen.logicalXDPI == screen.deviceXDPI || !hasBadZoomedRects(measure))\n      { return rect }\n    var scaleX = screen.logicalXDPI / screen.deviceXDPI;\n    var scaleY = screen.logicalYDPI / screen.deviceYDPI;\n    return {left: rect.left * scaleX, right: rect.right * scaleX,\n            top: rect.top * scaleY, bottom: rect.bottom * scaleY}\n  }\n\n  function clearLineMeasurementCacheFor(lineView) {\n    if (lineView.measure) {\n      lineView.measure.cache = {};\n      lineView.measure.heights = null;\n      if (lineView.rest) { for (var i = 0; i < lineView.rest.length; i++)\n        { lineView.measure.caches[i] = {}; } }\n    }\n  }\n\n  function clearLineMeasurementCache(cm) {\n    cm.display.externalMeasure = null;\n    removeChildren(cm.display.lineMeasure);\n    for (var i = 0; i < cm.display.view.length; i++)\n      { clearLineMeasurementCacheFor(cm.display.view[i]); }\n  }\n\n  function clearCaches(cm) {\n    clearLineMeasurementCache(cm);\n    cm.display.cachedCharWidth = cm.display.cachedTextHeight = cm.display.cachedPaddingH = null;\n    if (!cm.options.lineWrapping) { cm.display.maxLineChanged = true; }\n    cm.display.lineNumChars = null;\n  }\n\n  function pageScrollX() {\n    // Work around https://bugs.chromium.org/p/chromium/issues/detail?id=489206\n    // which causes page_Offset and bounding client rects to use\n    // different reference viewports and invalidate our calculations.\n    if (chrome && android) { return -(document.body.getBoundingClientRect().left - parseInt(getComputedStyle(document.body).marginLeft)) }\n    return window.pageXOffset || (document.documentElement || document.body).scrollLeft\n  }\n  function pageScrollY() {\n    if (chrome && android) { return -(document.body.getBoundingClientRect().top - parseInt(getComputedStyle(document.body).marginTop)) }\n    return window.pageYOffset || (document.documentElement || document.body).scrollTop\n  }\n\n  function widgetTopHeight(lineObj) {\n    var height = 0;\n    if (lineObj.widgets) { for (var i = 0; i < lineObj.widgets.length; ++i) { if (lineObj.widgets[i].above)\n      { height += widgetHeight(lineObj.widgets[i]); } } }\n    return height\n  }\n\n  // Converts a {top, bottom, left, right} box from line-local\n  // coordinates into another coordinate system. Context may be one of\n  // \"line\", \"div\" (display.lineDiv), \"local\"./null (editor), \"window\",\n  // or \"page\".\n  function intoCoordSystem(cm, lineObj, rect, context, includeWidgets) {\n    if (!includeWidgets) {\n      var height = widgetTopHeight(lineObj);\n      rect.top += height; rect.bottom += height;\n    }\n    if (context == \"line\") { return rect }\n    if (!context) { context = \"local\"; }\n    var yOff = heightAtLine(lineObj);\n    if (context == \"local\") { yOff += paddingTop(cm.display); }\n    else { yOff -= cm.display.viewOffset; }\n    if (context == \"page\" || context == \"window\") {\n      var lOff = cm.display.lineSpace.getBoundingClientRect();\n      yOff += lOff.top + (context == \"window\" ? 0 : pageScrollY());\n      var xOff = lOff.left + (context == \"window\" ? 0 : pageScrollX());\n      rect.left += xOff; rect.right += xOff;\n    }\n    rect.top += yOff; rect.bottom += yOff;\n    return rect\n  }\n\n  // Coverts a box from \"div\" coords to another coordinate system.\n  // Context may be \"window\", \"page\", \"div\", or \"local\"./null.\n  function fromCoordSystem(cm, coords, context) {\n    if (context == \"div\") { return coords }\n    var left = coords.left, top = coords.top;\n    // First move into \"page\" coordinate system\n    if (context == \"page\") {\n      left -= pageScrollX();\n      top -= pageScrollY();\n    } else if (context == \"local\" || !context) {\n      var localBox = cm.display.sizer.getBoundingClientRect();\n      left += localBox.left;\n      top += localBox.top;\n    }\n\n    var lineSpaceBox = cm.display.lineSpace.getBoundingClientRect();\n    return {left: left - lineSpaceBox.left, top: top - lineSpaceBox.top}\n  }\n\n  function charCoords(cm, pos, context, lineObj, bias) {\n    if (!lineObj) { lineObj = getLine(cm.doc, pos.line); }\n    return intoCoordSystem(cm, lineObj, measureChar(cm, lineObj, pos.ch, bias), context)\n  }\n\n  // Returns a box for a given cursor position, which may have an\n  // 'other' property containing the position of the secondary cursor\n  // on a bidi boundary.\n  // A cursor Pos(line, char, \"before\") is on the same visual line as `char - 1`\n  // and after `char - 1` in writing order of `char - 1`\n  // A cursor Pos(line, char, \"after\") is on the same visual line as `char`\n  // and before `char` in writing order of `char`\n  // Examples (upper-case letters are RTL, lower-case are LTR):\n  //     Pos(0, 1, ...)\n  //     before   after\n  // ab     a|b     a|b\n  // aB     a|B     aB|\n  // Ab     |Ab     A|b\n  // AB     B|A     B|A\n  // Every position after the last character on a line is considered to stick\n  // to the last character on the line.\n  function cursorCoords(cm, pos, context, lineObj, preparedMeasure, varHeight) {\n    lineObj = lineObj || getLine(cm.doc, pos.line);\n    if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n    function get(ch, right) {\n      var m = measureCharPrepared(cm, preparedMeasure, ch, right ? \"right\" : \"left\", varHeight);\n      if (right) { m.left = m.right; } else { m.right = m.left; }\n      return intoCoordSystem(cm, lineObj, m, context)\n    }\n    var order = getOrder(lineObj, cm.doc.direction), ch = pos.ch, sticky = pos.sticky;\n    if (ch >= lineObj.text.length) {\n      ch = lineObj.text.length;\n      sticky = \"before\";\n    } else if (ch <= 0) {\n      ch = 0;\n      sticky = \"after\";\n    }\n    if (!order) { return get(sticky == \"before\" ? ch - 1 : ch, sticky == \"before\") }\n\n    function getBidi(ch, partPos, invert) {\n      var part = order[partPos], right = part.level == 1;\n      return get(invert ? ch - 1 : ch, right != invert)\n    }\n    var partPos = getBidiPartAt(order, ch, sticky);\n    var other = bidiOther;\n    var val = getBidi(ch, partPos, sticky == \"before\");\n    if (other != null) { val.other = getBidi(ch, other, sticky != \"before\"); }\n    return val\n  }\n\n  // Used to cheaply estimate the coordinates for a position. Used for\n  // intermediate scroll updates.\n  function estimateCoords(cm, pos) {\n    var left = 0;\n    pos = clipPos(cm.doc, pos);\n    if (!cm.options.lineWrapping) { left = charWidth(cm.display) * pos.ch; }\n    var lineObj = getLine(cm.doc, pos.line);\n    var top = heightAtLine(lineObj) + paddingTop(cm.display);\n    return {left: left, right: left, top: top, bottom: top + lineObj.height}\n  }\n\n  // Positions returned by coordsChar contain some extra information.\n  // xRel is the relative x position of the input coordinates compared\n  // to the found position (so xRel > 0 means the coordinates are to\n  // the right of the character position, for example). When outside\n  // is true, that means the coordinates lie outside the line's\n  // vertical range.\n  function PosWithInfo(line, ch, sticky, outside, xRel) {\n    var pos = Pos(line, ch, sticky);\n    pos.xRel = xRel;\n    if (outside) { pos.outside = outside; }\n    return pos\n  }\n\n  // Compute the character position closest to the given coordinates.\n  // Input must be lineSpace-local (\"div\" coordinate system).\n  function coordsChar(cm, x, y) {\n    var doc = cm.doc;\n    y += cm.display.viewOffset;\n    if (y < 0) { return PosWithInfo(doc.first, 0, null, -1, -1) }\n    var lineN = lineAtHeight(doc, y), last = doc.first + doc.size - 1;\n    if (lineN > last)\n      { return PosWithInfo(doc.first + doc.size - 1, getLine(doc, last).text.length, null, 1, 1) }\n    if (x < 0) { x = 0; }\n\n    var lineObj = getLine(doc, lineN);\n    for (;;) {\n      var found = coordsCharInner(cm, lineObj, lineN, x, y);\n      var collapsed = collapsedSpanAround(lineObj, found.ch + (found.xRel > 0 || found.outside > 0 ? 1 : 0));\n      if (!collapsed) { return found }\n      var rangeEnd = collapsed.find(1);\n      if (rangeEnd.line == lineN) { return rangeEnd }\n      lineObj = getLine(doc, lineN = rangeEnd.line);\n    }\n  }\n\n  function wrappedLineExtent(cm, lineObj, preparedMeasure, y) {\n    y -= widgetTopHeight(lineObj);\n    var end = lineObj.text.length;\n    var begin = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch - 1).bottom <= y; }, end, 0);\n    end = findFirst(function (ch) { return measureCharPrepared(cm, preparedMeasure, ch).top > y; }, begin, end);\n    return {begin: begin, end: end}\n  }\n\n  function wrappedLineExtentChar(cm, lineObj, preparedMeasure, target) {\n    if (!preparedMeasure) { preparedMeasure = prepareMeasureForLine(cm, lineObj); }\n    var targetTop = intoCoordSystem(cm, lineObj, measureCharPrepared(cm, preparedMeasure, target), \"line\").top;\n    return wrappedLineExtent(cm, lineObj, preparedMeasure, targetTop)\n  }\n\n  // Returns true if the given side of a box is after the given\n  // coordinates, in top-to-bottom, left-to-right order.\n  function boxIsAfter(box, x, y, left) {\n    return box.bottom <= y ? false : box.top > y ? true : (left ? box.left : box.right) > x\n  }\n\n  function coordsCharInner(cm, lineObj, lineNo, x, y) {\n    // Move y into line-local coordinate space\n    y -= heightAtLine(lineObj);\n    var preparedMeasure = prepareMeasureForLine(cm, lineObj);\n    // When directly calling `measureCharPrepared`, we have to adjust\n    // for the widgets at this line.\n    var widgetHeight = widgetTopHeight(lineObj);\n    var begin = 0, end = lineObj.text.length, ltr = true;\n\n    var order = getOrder(lineObj, cm.doc.direction);\n    // If the line isn't plain left-to-right text, first figure out\n    // which bidi section the coordinates fall into.\n    if (order) {\n      var part = (cm.options.lineWrapping ? coordsBidiPartWrapped : coordsBidiPart)\n                   (cm, lineObj, lineNo, preparedMeasure, order, x, y);\n      ltr = part.level != 1;\n      // The awkward -1 offsets are needed because findFirst (called\n      // on these below) will treat its first bound as inclusive,\n      // second as exclusive, but we want to actually address the\n      // characters in the part's range\n      begin = ltr ? part.from : part.to - 1;\n      end = ltr ? part.to : part.from - 1;\n    }\n\n    // A binary search to find the first character whose bounding box\n    // starts after the coordinates. If we run across any whose box wrap\n    // the coordinates, store that.\n    var chAround = null, boxAround = null;\n    var ch = findFirst(function (ch) {\n      var box = measureCharPrepared(cm, preparedMeasure, ch);\n      box.top += widgetHeight; box.bottom += widgetHeight;\n      if (!boxIsAfter(box, x, y, false)) { return false }\n      if (box.top <= y && box.left <= x) {\n        chAround = ch;\n        boxAround = box;\n      }\n      return true\n    }, begin, end);\n\n    var baseX, sticky, outside = false;\n    // If a box around the coordinates was found, use that\n    if (boxAround) {\n      // Distinguish coordinates nearer to the left or right side of the box\n      var atLeft = x - boxAround.left < boxAround.right - x, atStart = atLeft == ltr;\n      ch = chAround + (atStart ? 0 : 1);\n      sticky = atStart ? \"after\" : \"before\";\n      baseX = atLeft ? boxAround.left : boxAround.right;\n    } else {\n      // (Adjust for extended bound, if necessary.)\n      if (!ltr && (ch == end || ch == begin)) { ch++; }\n      // To determine which side to associate with, get the box to the\n      // left of the character and compare it's vertical position to the\n      // coordinates\n      sticky = ch == 0 ? \"after\" : ch == lineObj.text.length ? \"before\" :\n        (measureCharPrepared(cm, preparedMeasure, ch - (ltr ? 1 : 0)).bottom + widgetHeight <= y) == ltr ?\n        \"after\" : \"before\";\n      // Now get accurate coordinates for this place, in order to get a\n      // base X position\n      var coords = cursorCoords(cm, Pos(lineNo, ch, sticky), \"line\", lineObj, preparedMeasure);\n      baseX = coords.left;\n      outside = y < coords.top ? -1 : y >= coords.bottom ? 1 : 0;\n    }\n\n    ch = skipExtendingChars(lineObj.text, ch, 1);\n    return PosWithInfo(lineNo, ch, sticky, outside, x - baseX)\n  }\n\n  function coordsBidiPart(cm, lineObj, lineNo, preparedMeasure, order, x, y) {\n    // Bidi parts are sorted left-to-right, and in a non-line-wrapping\n    // situation, we can take this ordering to correspond to the visual\n    // ordering. This finds the first part whose end is after the given\n    // coordinates.\n    var index = findFirst(function (i) {\n      var part = order[i], ltr = part.level != 1;\n      return boxIsAfter(cursorCoords(cm, Pos(lineNo, ltr ? part.to : part.from, ltr ? \"before\" : \"after\"),\n                                     \"line\", lineObj, preparedMeasure), x, y, true)\n    }, 0, order.length - 1);\n    var part = order[index];\n    // If this isn't the first part, the part's start is also after\n    // the coordinates, and the coordinates aren't on the same line as\n    // that start, move one part back.\n    if (index > 0) {\n      var ltr = part.level != 1;\n      var start = cursorCoords(cm, Pos(lineNo, ltr ? part.from : part.to, ltr ? \"after\" : \"before\"),\n                               \"line\", lineObj, preparedMeasure);\n      if (boxIsAfter(start, x, y, true) && start.top > y)\n        { part = order[index - 1]; }\n    }\n    return part\n  }\n\n  function coordsBidiPartWrapped(cm, lineObj, _lineNo, preparedMeasure, order, x, y) {\n    // In a wrapped line, rtl text on wrapping boundaries can do things\n    // that don't correspond to the ordering in our `order` array at\n    // all, so a binary search doesn't work, and we want to return a\n    // part that only spans one line so that the binary search in\n    // coordsCharInner is safe. As such, we first find the extent of the\n    // wrapped line, and then do a flat search in which we discard any\n    // spans that aren't on the line.\n    var ref = wrappedLineExtent(cm, lineObj, preparedMeasure, y);\n    var begin = ref.begin;\n    var end = ref.end;\n    if (/\\s/.test(lineObj.text.charAt(end - 1))) { end--; }\n    var part = null, closestDist = null;\n    for (var i = 0; i < order.length; i++) {\n      var p = order[i];\n      if (p.from >= end || p.to <= begin) { continue }\n      var ltr = p.level != 1;\n      var endX = measureCharPrepared(cm, preparedMeasure, ltr ? Math.min(end, p.to) - 1 : Math.max(begin, p.from)).right;\n      // Weigh against spans ending before this, so that they are only\n      // picked if nothing ends after\n      var dist = endX < x ? x - endX + 1e9 : endX - x;\n      if (!part || closestDist > dist) {\n        part = p;\n        closestDist = dist;\n      }\n    }\n    if (!part) { part = order[order.length - 1]; }\n    // Clip the part to the wrapped line.\n    if (part.from < begin) { part = {from: begin, to: part.to, level: part.level}; }\n    if (part.to > end) { part = {from: part.from, to: end, level: part.level}; }\n    return part\n  }\n\n  var measureText;\n  // Compute the default text height.\n  function textHeight(display) {\n    if (display.cachedTextHeight != null) { return display.cachedTextHeight }\n    if (measureText == null) {\n      measureText = elt(\"pre\", null, \"CodeMirror-line-like\");\n      // Measure a bunch of lines, for browsers that compute\n      // fractional heights.\n      for (var i = 0; i < 49; ++i) {\n        measureText.appendChild(document.createTextNode(\"x\"));\n        measureText.appendChild(elt(\"br\"));\n      }\n      measureText.appendChild(document.createTextNode(\"x\"));\n    }\n    removeChildrenAndAdd(display.measure, measureText);\n    var height = measureText.offsetHeight / 50;\n    if (height > 3) { display.cachedTextHeight = height; }\n    removeChildren(display.measure);\n    return height || 1\n  }\n\n  // Compute the default character width.\n  function charWidth(display) {\n    if (display.cachedCharWidth != null) { return display.cachedCharWidth }\n    var anchor = elt(\"span\", \"xxxxxxxxxx\");\n    var pre = elt(\"pre\", [anchor], \"CodeMirror-line-like\");\n    removeChildrenAndAdd(display.measure, pre);\n    var rect = anchor.getBoundingClientRect(), width = (rect.right - rect.left) / 10;\n    if (width > 2) { display.cachedCharWidth = width; }\n    return width || 10\n  }\n\n  // Do a bulk-read of the DOM positions and sizes needed to draw the\n  // view, so that we don't interleave reading and writing to the DOM.\n  function getDimensions(cm) {\n    var d = cm.display, left = {}, width = {};\n    var gutterLeft = d.gutters.clientLeft;\n    for (var n = d.gutters.firstChild, i = 0; n; n = n.nextSibling, ++i) {\n      var id = cm.display.gutterSpecs[i].className;\n      left[id] = n.offsetLeft + n.clientLeft + gutterLeft;\n      width[id] = n.clientWidth;\n    }\n    return {fixedPos: compensateForHScroll(d),\n            gutterTotalWidth: d.gutters.offsetWidth,\n            gutterLeft: left,\n            gutterWidth: width,\n            wrapperWidth: d.wrapper.clientWidth}\n  }\n\n  // Computes display.scroller.scrollLeft + display.gutters.offsetWidth,\n  // but using getBoundingClientRect to get a sub-pixel-accurate\n  // result.\n  function compensateForHScroll(display) {\n    return display.scroller.getBoundingClientRect().left - display.sizer.getBoundingClientRect().left\n  }\n\n  // Returns a function that estimates the height of a line, to use as\n  // first approximation until the line becomes visible (and is thus\n  // properly measurable).\n  function estimateHeight(cm) {\n    var th = textHeight(cm.display), wrapping = cm.options.lineWrapping;\n    var perLine = wrapping && Math.max(5, cm.display.scroller.clientWidth / charWidth(cm.display) - 3);\n    return function (line) {\n      if (lineIsHidden(cm.doc, line)) { return 0 }\n\n      var widgetsHeight = 0;\n      if (line.widgets) { for (var i = 0; i < line.widgets.length; i++) {\n        if (line.widgets[i].height) { widgetsHeight += line.widgets[i].height; }\n      } }\n\n      if (wrapping)\n        { return widgetsHeight + (Math.ceil(line.text.length / perLine) || 1) * th }\n      else\n        { return widgetsHeight + th }\n    }\n  }\n\n  function estimateLineHeights(cm) {\n    var doc = cm.doc, est = estimateHeight(cm);\n    doc.iter(function (line) {\n      var estHeight = est(line);\n      if (estHeight != line.height) { updateLineHeight(line, estHeight); }\n    });\n  }\n\n  // Given a mouse event, find the corresponding position. If liberal\n  // is false, it checks whether a gutter or scrollbar was clicked,\n  // and returns null if it was. forRect is used by rectangular\n  // selections, and tries to estimate a character position even for\n  // coordinates beyond the right of the text.\n  function posFromMouse(cm, e, liberal, forRect) {\n    var display = cm.display;\n    if (!liberal && e_target(e).getAttribute(\"cm-not-content\") == \"true\") { return null }\n\n    var x, y, space = display.lineSpace.getBoundingClientRect();\n    // Fails unpredictably on IE[67] when mouse is dragged around quickly.\n    try { x = e.clientX - space.left; y = e.clientY - space.top; }\n    catch (e$1) { return null }\n    var coords = coordsChar(cm, x, y), line;\n    if (forRect && coords.xRel > 0 && (line = getLine(cm.doc, coords.line).text).length == coords.ch) {\n      var colDiff = countColumn(line, line.length, cm.options.tabSize) - line.length;\n      coords = Pos(coords.line, Math.max(0, Math.round((x - paddingH(cm.display).left) / charWidth(cm.display)) - colDiff));\n    }\n    return coords\n  }\n\n  // Find the view element corresponding to a given line. Return null\n  // when the line isn't visible.\n  function findViewIndex(cm, n) {\n    if (n >= cm.display.viewTo) { return null }\n    n -= cm.display.viewFrom;\n    if (n < 0) { return null }\n    var view = cm.display.view;\n    for (var i = 0; i < view.length; i++) {\n      n -= view[i].size;\n      if (n < 0) { return i }\n    }\n  }\n\n  // Updates the display.view data structure for a given change to the\n  // document. From and to are in pre-change coordinates. Lendiff is\n  // the amount of lines added or subtracted by the change. This is\n  // used for changes that span multiple lines, or change the way\n  // lines are divided into visual lines. regLineChange (below)\n  // registers single-line changes.\n  function regChange(cm, from, to, lendiff) {\n    if (from == null) { from = cm.doc.first; }\n    if (to == null) { to = cm.doc.first + cm.doc.size; }\n    if (!lendiff) { lendiff = 0; }\n\n    var display = cm.display;\n    if (lendiff && to < display.viewTo &&\n        (display.updateLineNumbers == null || display.updateLineNumbers > from))\n      { display.updateLineNumbers = from; }\n\n    cm.curOp.viewChanged = true;\n\n    if (from >= display.viewTo) { // Change after\n      if (sawCollapsedSpans && visualLineNo(cm.doc, from) < display.viewTo)\n        { resetView(cm); }\n    } else if (to <= display.viewFrom) { // Change before\n      if (sawCollapsedSpans && visualLineEndNo(cm.doc, to + lendiff) > display.viewFrom) {\n        resetView(cm);\n      } else {\n        display.viewFrom += lendiff;\n        display.viewTo += lendiff;\n      }\n    } else if (from <= display.viewFrom && to >= display.viewTo) { // Full overlap\n      resetView(cm);\n    } else if (from <= display.viewFrom) { // Top overlap\n      var cut = viewCuttingPoint(cm, to, to + lendiff, 1);\n      if (cut) {\n        display.view = display.view.slice(cut.index);\n        display.viewFrom = cut.lineN;\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    } else if (to >= display.viewTo) { // Bottom overlap\n      var cut$1 = viewCuttingPoint(cm, from, from, -1);\n      if (cut$1) {\n        display.view = display.view.slice(0, cut$1.index);\n        display.viewTo = cut$1.lineN;\n      } else {\n        resetView(cm);\n      }\n    } else { // Gap in the middle\n      var cutTop = viewCuttingPoint(cm, from, from, -1);\n      var cutBot = viewCuttingPoint(cm, to, to + lendiff, 1);\n      if (cutTop && cutBot) {\n        display.view = display.view.slice(0, cutTop.index)\n          .concat(buildViewArray(cm, cutTop.lineN, cutBot.lineN))\n          .concat(display.view.slice(cutBot.index));\n        display.viewTo += lendiff;\n      } else {\n        resetView(cm);\n      }\n    }\n\n    var ext = display.externalMeasured;\n    if (ext) {\n      if (to < ext.lineN)\n        { ext.lineN += lendiff; }\n      else if (from < ext.lineN + ext.size)\n        { display.externalMeasured = null; }\n    }\n  }\n\n  // Register a change to a single line. Type must be one of \"text\",\n  // \"gutter\", \"class\", \"widget\"\n  function regLineChange(cm, line, type) {\n    cm.curOp.viewChanged = true;\n    var display = cm.display, ext = cm.display.externalMeasured;\n    if (ext && line >= ext.lineN && line < ext.lineN + ext.size)\n      { display.externalMeasured = null; }\n\n    if (line < display.viewFrom || line >= display.viewTo) { return }\n    var lineView = display.view[findViewIndex(cm, line)];\n    if (lineView.node == null) { return }\n    var arr = lineView.changes || (lineView.changes = []);\n    if (indexOf(arr, type) == -1) { arr.push(type); }\n  }\n\n  // Clear the view.\n  function resetView(cm) {\n    cm.display.viewFrom = cm.display.viewTo = cm.doc.first;\n    cm.display.view = [];\n    cm.display.viewOffset = 0;\n  }\n\n  function viewCuttingPoint(cm, oldN, newN, dir) {\n    var index = findViewIndex(cm, oldN), diff, view = cm.display.view;\n    if (!sawCollapsedSpans || newN == cm.doc.first + cm.doc.size)\n      { return {index: index, lineN: newN} }\n    var n = cm.display.viewFrom;\n    for (var i = 0; i < index; i++)\n      { n += view[i].size; }\n    if (n != oldN) {\n      if (dir > 0) {\n        if (index == view.length - 1) { return null }\n        diff = (n + view[index].size) - oldN;\n        index++;\n      } else {\n        diff = n - oldN;\n      }\n      oldN += diff; newN += diff;\n    }\n    while (visualLineNo(cm.doc, newN) != newN) {\n      if (index == (dir < 0 ? 0 : view.length - 1)) { return null }\n      newN += dir * view[index - (dir < 0 ? 1 : 0)].size;\n      index += dir;\n    }\n    return {index: index, lineN: newN}\n  }\n\n  // Force the view to cover a given range, adding empty view element\n  // or clipping off existing ones as needed.\n  function adjustView(cm, from, to) {\n    var display = cm.display, view = display.view;\n    if (view.length == 0 || from >= display.viewTo || to <= display.viewFrom) {\n      display.view = buildViewArray(cm, from, to);\n      display.viewFrom = from;\n    } else {\n      if (display.viewFrom > from)\n        { display.view = buildViewArray(cm, from, display.viewFrom).concat(display.view); }\n      else if (display.viewFrom < from)\n        { display.view = display.view.slice(findViewIndex(cm, from)); }\n      display.viewFrom = from;\n      if (display.viewTo < to)\n        { display.view = display.view.concat(buildViewArray(cm, display.viewTo, to)); }\n      else if (display.viewTo > to)\n        { display.view = display.view.slice(0, findViewIndex(cm, to)); }\n    }\n    display.viewTo = to;\n  }\n\n  // Count the number of lines in the view whose DOM representation is\n  // out of date (or nonexistent).\n  function countDirtyView(cm) {\n    var view = cm.display.view, dirty = 0;\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n      if (!lineView.hidden && (!lineView.node || lineView.changes)) { ++dirty; }\n    }\n    return dirty\n  }\n\n  function updateSelection(cm) {\n    cm.display.input.showSelection(cm.display.input.prepareSelection());\n  }\n\n  function prepareSelection(cm, primary) {\n    if ( primary === void 0 ) primary = true;\n\n    var doc = cm.doc, result = {};\n    var curFragment = result.cursors = document.createDocumentFragment();\n    var selFragment = result.selection = document.createDocumentFragment();\n\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      if (!primary && i == doc.sel.primIndex) { continue }\n      var range = doc.sel.ranges[i];\n      if (range.from().line >= cm.display.viewTo || range.to().line < cm.display.viewFrom) { continue }\n      var collapsed = range.empty();\n      if (collapsed || cm.options.showCursorWhenSelecting)\n        { drawSelectionCursor(cm, range.head, curFragment); }\n      if (!collapsed)\n        { drawSelectionRange(cm, range, selFragment); }\n    }\n    return result\n  }\n\n  // Draws a cursor for the given range\n  function drawSelectionCursor(cm, head, output) {\n    var pos = cursorCoords(cm, head, \"div\", null, null, !cm.options.singleCursorHeightPerLine);\n\n    var cursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor\"));\n    cursor.style.left = pos.left + \"px\";\n    cursor.style.top = pos.top + \"px\";\n    cursor.style.height = Math.max(0, pos.bottom - pos.top) * cm.options.cursorHeight + \"px\";\n\n    if (pos.other) {\n      // Secondary cursor, shown when on a 'jump' in bi-directional text\n      var otherCursor = output.appendChild(elt(\"div\", \"\\u00a0\", \"CodeMirror-cursor CodeMirror-secondarycursor\"));\n      otherCursor.style.display = \"\";\n      otherCursor.style.left = pos.other.left + \"px\";\n      otherCursor.style.top = pos.other.top + \"px\";\n      otherCursor.style.height = (pos.other.bottom - pos.other.top) * .85 + \"px\";\n    }\n  }\n\n  function cmpCoords(a, b) { return a.top - b.top || a.left - b.left }\n\n  // Draws the given range as a highlighted selection\n  function drawSelectionRange(cm, range, output) {\n    var display = cm.display, doc = cm.doc;\n    var fragment = document.createDocumentFragment();\n    var padding = paddingH(cm.display), leftSide = padding.left;\n    var rightSide = Math.max(display.sizerWidth, displayWidth(cm) - display.sizer.offsetLeft) - padding.right;\n    var docLTR = doc.direction == \"ltr\";\n\n    function add(left, top, width, bottom) {\n      if (top < 0) { top = 0; }\n      top = Math.round(top);\n      bottom = Math.round(bottom);\n      fragment.appendChild(elt(\"div\", null, \"CodeMirror-selected\", (\"position: absolute; left: \" + left + \"px;\\n                             top: \" + top + \"px; width: \" + (width == null ? rightSide - left : width) + \"px;\\n                             height: \" + (bottom - top) + \"px\")));\n    }\n\n    function drawForLine(line, fromArg, toArg) {\n      var lineObj = getLine(doc, line);\n      var lineLen = lineObj.text.length;\n      var start, end;\n      function coords(ch, bias) {\n        return charCoords(cm, Pos(line, ch), \"div\", lineObj, bias)\n      }\n\n      function wrapX(pos, dir, side) {\n        var extent = wrappedLineExtentChar(cm, lineObj, null, pos);\n        var prop = (dir == \"ltr\") == (side == \"after\") ? \"left\" : \"right\";\n        var ch = side == \"after\" ? extent.begin : extent.end - (/\\s/.test(lineObj.text.charAt(extent.end - 1)) ? 2 : 1);\n        return coords(ch, prop)[prop]\n      }\n\n      var order = getOrder(lineObj, doc.direction);\n      iterateBidiSections(order, fromArg || 0, toArg == null ? lineLen : toArg, function (from, to, dir, i) {\n        var ltr = dir == \"ltr\";\n        var fromPos = coords(from, ltr ? \"left\" : \"right\");\n        var toPos = coords(to - 1, ltr ? \"right\" : \"left\");\n\n        var openStart = fromArg == null && from == 0, openEnd = toArg == null && to == lineLen;\n        var first = i == 0, last = !order || i == order.length - 1;\n        if (toPos.top - fromPos.top <= 3) { // Single line\n          var openLeft = (docLTR ? openStart : openEnd) && first;\n          var openRight = (docLTR ? openEnd : openStart) && last;\n          var left = openLeft ? leftSide : (ltr ? fromPos : toPos).left;\n          var right = openRight ? rightSide : (ltr ? toPos : fromPos).right;\n          add(left, fromPos.top, right - left, fromPos.bottom);\n        } else { // Multiple lines\n          var topLeft, topRight, botLeft, botRight;\n          if (ltr) {\n            topLeft = docLTR && openStart && first ? leftSide : fromPos.left;\n            topRight = docLTR ? rightSide : wrapX(from, dir, \"before\");\n            botLeft = docLTR ? leftSide : wrapX(to, dir, \"after\");\n            botRight = docLTR && openEnd && last ? rightSide : toPos.right;\n          } else {\n            topLeft = !docLTR ? leftSide : wrapX(from, dir, \"before\");\n            topRight = !docLTR && openStart && first ? rightSide : fromPos.right;\n            botLeft = !docLTR && openEnd && last ? leftSide : toPos.left;\n            botRight = !docLTR ? rightSide : wrapX(to, dir, \"after\");\n          }\n          add(topLeft, fromPos.top, topRight - topLeft, fromPos.bottom);\n          if (fromPos.bottom < toPos.top) { add(leftSide, fromPos.bottom, null, toPos.top); }\n          add(botLeft, toPos.top, botRight - botLeft, toPos.bottom);\n        }\n\n        if (!start || cmpCoords(fromPos, start) < 0) { start = fromPos; }\n        if (cmpCoords(toPos, start) < 0) { start = toPos; }\n        if (!end || cmpCoords(fromPos, end) < 0) { end = fromPos; }\n        if (cmpCoords(toPos, end) < 0) { end = toPos; }\n      });\n      return {start: start, end: end}\n    }\n\n    var sFrom = range.from(), sTo = range.to();\n    if (sFrom.line == sTo.line) {\n      drawForLine(sFrom.line, sFrom.ch, sTo.ch);\n    } else {\n      var fromLine = getLine(doc, sFrom.line), toLine = getLine(doc, sTo.line);\n      var singleVLine = visualLine(fromLine) == visualLine(toLine);\n      var leftEnd = drawForLine(sFrom.line, sFrom.ch, singleVLine ? fromLine.text.length + 1 : null).end;\n      var rightStart = drawForLine(sTo.line, singleVLine ? 0 : null, sTo.ch).start;\n      if (singleVLine) {\n        if (leftEnd.top < rightStart.top - 2) {\n          add(leftEnd.right, leftEnd.top, null, leftEnd.bottom);\n          add(leftSide, rightStart.top, rightStart.left, rightStart.bottom);\n        } else {\n          add(leftEnd.right, leftEnd.top, rightStart.left - leftEnd.right, leftEnd.bottom);\n        }\n      }\n      if (leftEnd.bottom < rightStart.top)\n        { add(leftSide, leftEnd.bottom, null, rightStart.top); }\n    }\n\n    output.appendChild(fragment);\n  }\n\n  // Cursor-blinking\n  function restartBlink(cm) {\n    if (!cm.state.focused) { return }\n    var display = cm.display;\n    clearInterval(display.blinker);\n    var on = true;\n    display.cursorDiv.style.visibility = \"\";\n    if (cm.options.cursorBlinkRate > 0)\n      { display.blinker = setInterval(function () {\n        if (!cm.hasFocus()) { onBlur(cm); }\n        display.cursorDiv.style.visibility = (on = !on) ? \"\" : \"hidden\";\n      }, cm.options.cursorBlinkRate); }\n    else if (cm.options.cursorBlinkRate < 0)\n      { display.cursorDiv.style.visibility = \"hidden\"; }\n  }\n\n  function ensureFocus(cm) {\n    if (!cm.state.focused) { cm.display.input.focus(); onFocus(cm); }\n  }\n\n  function delayBlurEvent(cm) {\n    cm.state.delayingBlurEvent = true;\n    setTimeout(function () { if (cm.state.delayingBlurEvent) {\n      cm.state.delayingBlurEvent = false;\n      onBlur(cm);\n    } }, 100);\n  }\n\n  function onFocus(cm, e) {\n    if (cm.state.delayingBlurEvent) { cm.state.delayingBlurEvent = false; }\n\n    if (cm.options.readOnly == \"nocursor\") { return }\n    if (!cm.state.focused) {\n      signal(cm, \"focus\", cm, e);\n      cm.state.focused = true;\n      addClass(cm.display.wrapper, \"CodeMirror-focused\");\n      // This test prevents this from firing when a context\n      // menu is closed (since the input reset would kill the\n      // select-all detection hack)\n      if (!cm.curOp && cm.display.selForContextMenu != cm.doc.sel) {\n        cm.display.input.reset();\n        if (webkit) { setTimeout(function () { return cm.display.input.reset(true); }, 20); } // Issue #1730\n      }\n      cm.display.input.receivedFocus();\n    }\n    restartBlink(cm);\n  }\n  function onBlur(cm, e) {\n    if (cm.state.delayingBlurEvent) { return }\n\n    if (cm.state.focused) {\n      signal(cm, \"blur\", cm, e);\n      cm.state.focused = false;\n      rmClass(cm.display.wrapper, \"CodeMirror-focused\");\n    }\n    clearInterval(cm.display.blinker);\n    setTimeout(function () { if (!cm.state.focused) { cm.display.shift = false; } }, 150);\n  }\n\n  // Read the actual heights of the rendered lines, and update their\n  // stored heights to match.\n  function updateHeightsInViewport(cm) {\n    var display = cm.display;\n    var prevBottom = display.lineDiv.offsetTop;\n    for (var i = 0; i < display.view.length; i++) {\n      var cur = display.view[i], wrapping = cm.options.lineWrapping;\n      var height = (void 0), width = 0;\n      if (cur.hidden) { continue }\n      if (ie && ie_version < 8) {\n        var bot = cur.node.offsetTop + cur.node.offsetHeight;\n        height = bot - prevBottom;\n        prevBottom = bot;\n      } else {\n        var box = cur.node.getBoundingClientRect();\n        height = box.bottom - box.top;\n        // Check that lines don't extend past the right of the current\n        // editor width\n        if (!wrapping && cur.text.firstChild)\n          { width = cur.text.firstChild.getBoundingClientRect().right - box.left - 1; }\n      }\n      var diff = cur.line.height - height;\n      if (diff > .005 || diff < -.005) {\n        updateLineHeight(cur.line, height);\n        updateWidgetHeight(cur.line);\n        if (cur.rest) { for (var j = 0; j < cur.rest.length; j++)\n          { updateWidgetHeight(cur.rest[j]); } }\n      }\n      if (width > cm.display.sizerWidth) {\n        var chWidth = Math.ceil(width / charWidth(cm.display));\n        if (chWidth > cm.display.maxLineLength) {\n          cm.display.maxLineLength = chWidth;\n          cm.display.maxLine = cur.line;\n          cm.display.maxLineChanged = true;\n        }\n      }\n    }\n  }\n\n  // Read and store the height of line widgets associated with the\n  // given line.\n  function updateWidgetHeight(line) {\n    if (line.widgets) { for (var i = 0; i < line.widgets.length; ++i) {\n      var w = line.widgets[i], parent = w.node.parentNode;\n      if (parent) { w.height = parent.offsetHeight; }\n    } }\n  }\n\n  // Compute the lines that are visible in a given viewport (defaults\n  // the the current scroll position). viewport may contain top,\n  // height, and ensure (see op.scrollToPos) properties.\n  function visibleLines(display, doc, viewport) {\n    var top = viewport && viewport.top != null ? Math.max(0, viewport.top) : display.scroller.scrollTop;\n    top = Math.floor(top - paddingTop(display));\n    var bottom = viewport && viewport.bottom != null ? viewport.bottom : top + display.wrapper.clientHeight;\n\n    var from = lineAtHeight(doc, top), to = lineAtHeight(doc, bottom);\n    // Ensure is a {from: {line, ch}, to: {line, ch}} object, and\n    // forces those lines into the viewport (if possible).\n    if (viewport && viewport.ensure) {\n      var ensureFrom = viewport.ensure.from.line, ensureTo = viewport.ensure.to.line;\n      if (ensureFrom < from) {\n        from = ensureFrom;\n        to = lineAtHeight(doc, heightAtLine(getLine(doc, ensureFrom)) + display.wrapper.clientHeight);\n      } else if (Math.min(ensureTo, doc.lastLine()) >= to) {\n        from = lineAtHeight(doc, heightAtLine(getLine(doc, ensureTo)) - display.wrapper.clientHeight);\n        to = ensureTo;\n      }\n    }\n    return {from: from, to: Math.max(to, from + 1)}\n  }\n\n  // SCROLLING THINGS INTO VIEW\n\n  // If an editor sits on the top or bottom of the window, partially\n  // scrolled out of view, this ensures that the cursor is visible.\n  function maybeScrollWindow(cm, rect) {\n    if (signalDOMEvent(cm, \"scrollCursorIntoView\")) { return }\n\n    var display = cm.display, box = display.sizer.getBoundingClientRect(), doScroll = null;\n    if (rect.top + box.top < 0) { doScroll = true; }\n    else if (rect.bottom + box.top > (window.innerHeight || document.documentElement.clientHeight)) { doScroll = false; }\n    if (doScroll != null && !phantom) {\n      var scrollNode = elt(\"div\", \"\\u200b\", null, (\"position: absolute;\\n                         top: \" + (rect.top - display.viewOffset - paddingTop(cm.display)) + \"px;\\n                         height: \" + (rect.bottom - rect.top + scrollGap(cm) + display.barHeight) + \"px;\\n                         left: \" + (rect.left) + \"px; width: \" + (Math.max(2, rect.right - rect.left)) + \"px;\"));\n      cm.display.lineSpace.appendChild(scrollNode);\n      scrollNode.scrollIntoView(doScroll);\n      cm.display.lineSpace.removeChild(scrollNode);\n    }\n  }\n\n  // Scroll a given position into view (immediately), verifying that\n  // it actually became visible (as line heights are accurately\n  // measured, the position of something may 'drift' during drawing).\n  function scrollPosIntoView(cm, pos, end, margin) {\n    if (margin == null) { margin = 0; }\n    var rect;\n    if (!cm.options.lineWrapping && pos == end) {\n      // Set pos and end to the cursor positions around the character pos sticks to\n      // If pos.sticky == \"before\", that is around pos.ch - 1, otherwise around pos.ch\n      // If pos == Pos(_, 0, \"before\"), pos and end are unchanged\n      pos = pos.ch ? Pos(pos.line, pos.sticky == \"before\" ? pos.ch - 1 : pos.ch, \"after\") : pos;\n      end = pos.sticky == \"before\" ? Pos(pos.line, pos.ch + 1, \"before\") : pos;\n    }\n    for (var limit = 0; limit < 5; limit++) {\n      var changed = false;\n      var coords = cursorCoords(cm, pos);\n      var endCoords = !end || end == pos ? coords : cursorCoords(cm, end);\n      rect = {left: Math.min(coords.left, endCoords.left),\n              top: Math.min(coords.top, endCoords.top) - margin,\n              right: Math.max(coords.left, endCoords.left),\n              bottom: Math.max(coords.bottom, endCoords.bottom) + margin};\n      var scrollPos = calculateScrollPos(cm, rect);\n      var startTop = cm.doc.scrollTop, startLeft = cm.doc.scrollLeft;\n      if (scrollPos.scrollTop != null) {\n        updateScrollTop(cm, scrollPos.scrollTop);\n        if (Math.abs(cm.doc.scrollTop - startTop) > 1) { changed = true; }\n      }\n      if (scrollPos.scrollLeft != null) {\n        setScrollLeft(cm, scrollPos.scrollLeft);\n        if (Math.abs(cm.doc.scrollLeft - startLeft) > 1) { changed = true; }\n      }\n      if (!changed) { break }\n    }\n    return rect\n  }\n\n  // Scroll a given set of coordinates into view (immediately).\n  function scrollIntoView(cm, rect) {\n    var scrollPos = calculateScrollPos(cm, rect);\n    if (scrollPos.scrollTop != null) { updateScrollTop(cm, scrollPos.scrollTop); }\n    if (scrollPos.scrollLeft != null) { setScrollLeft(cm, scrollPos.scrollLeft); }\n  }\n\n  // Calculate a new scroll position needed to scroll the given\n  // rectangle into view. Returns an object with scrollTop and\n  // scrollLeft properties. When these are undefined, the\n  // vertical/horizontal position does not need to be adjusted.\n  function calculateScrollPos(cm, rect) {\n    var display = cm.display, snapMargin = textHeight(cm.display);\n    if (rect.top < 0) { rect.top = 0; }\n    var screentop = cm.curOp && cm.curOp.scrollTop != null ? cm.curOp.scrollTop : display.scroller.scrollTop;\n    var screen = displayHeight(cm), result = {};\n    if (rect.bottom - rect.top > screen) { rect.bottom = rect.top + screen; }\n    var docBottom = cm.doc.height + paddingVert(display);\n    var atTop = rect.top < snapMargin, atBottom = rect.bottom > docBottom - snapMargin;\n    if (rect.top < screentop) {\n      result.scrollTop = atTop ? 0 : rect.top;\n    } else if (rect.bottom > screentop + screen) {\n      var newTop = Math.min(rect.top, (atBottom ? docBottom : rect.bottom) - screen);\n      if (newTop != screentop) { result.scrollTop = newTop; }\n    }\n\n    var screenleft = cm.curOp && cm.curOp.scrollLeft != null ? cm.curOp.scrollLeft : display.scroller.scrollLeft;\n    var screenw = displayWidth(cm) - (cm.options.fixedGutter ? display.gutters.offsetWidth : 0);\n    var tooWide = rect.right - rect.left > screenw;\n    if (tooWide) { rect.right = rect.left + screenw; }\n    if (rect.left < 10)\n      { result.scrollLeft = 0; }\n    else if (rect.left < screenleft)\n      { result.scrollLeft = Math.max(0, rect.left - (tooWide ? 0 : 10)); }\n    else if (rect.right > screenw + screenleft - 3)\n      { result.scrollLeft = rect.right + (tooWide ? 0 : 10) - screenw; }\n    return result\n  }\n\n  // Store a relative adjustment to the scroll position in the current\n  // operation (to be applied when the operation finishes).\n  function addToScrollTop(cm, top) {\n    if (top == null) { return }\n    resolveScrollToPos(cm);\n    cm.curOp.scrollTop = (cm.curOp.scrollTop == null ? cm.doc.scrollTop : cm.curOp.scrollTop) + top;\n  }\n\n  // Make sure that at the end of the operation the current cursor is\n  // shown.\n  function ensureCursorVisible(cm) {\n    resolveScrollToPos(cm);\n    var cur = cm.getCursor();\n    cm.curOp.scrollToPos = {from: cur, to: cur, margin: cm.options.cursorScrollMargin};\n  }\n\n  function scrollToCoords(cm, x, y) {\n    if (x != null || y != null) { resolveScrollToPos(cm); }\n    if (x != null) { cm.curOp.scrollLeft = x; }\n    if (y != null) { cm.curOp.scrollTop = y; }\n  }\n\n  function scrollToRange(cm, range) {\n    resolveScrollToPos(cm);\n    cm.curOp.scrollToPos = range;\n  }\n\n  // When an operation has its scrollToPos property set, and another\n  // scroll action is applied before the end of the operation, this\n  // 'simulates' scrolling that position into view in a cheap way, so\n  // that the effect of intermediate scroll commands is not ignored.\n  function resolveScrollToPos(cm) {\n    var range = cm.curOp.scrollToPos;\n    if (range) {\n      cm.curOp.scrollToPos = null;\n      var from = estimateCoords(cm, range.from), to = estimateCoords(cm, range.to);\n      scrollToCoordsRange(cm, from, to, range.margin);\n    }\n  }\n\n  function scrollToCoordsRange(cm, from, to, margin) {\n    var sPos = calculateScrollPos(cm, {\n      left: Math.min(from.left, to.left),\n      top: Math.min(from.top, to.top) - margin,\n      right: Math.max(from.right, to.right),\n      bottom: Math.max(from.bottom, to.bottom) + margin\n    });\n    scrollToCoords(cm, sPos.scrollLeft, sPos.scrollTop);\n  }\n\n  // Sync the scrollable area and scrollbars, ensure the viewport\n  // covers the visible area.\n  function updateScrollTop(cm, val) {\n    if (Math.abs(cm.doc.scrollTop - val) < 2) { return }\n    if (!gecko) { updateDisplaySimple(cm, {top: val}); }\n    setScrollTop(cm, val, true);\n    if (gecko) { updateDisplaySimple(cm); }\n    startWorker(cm, 100);\n  }\n\n  function setScrollTop(cm, val, forceScroll) {\n    val = Math.max(0, Math.min(cm.display.scroller.scrollHeight - cm.display.scroller.clientHeight, val));\n    if (cm.display.scroller.scrollTop == val && !forceScroll) { return }\n    cm.doc.scrollTop = val;\n    cm.display.scrollbars.setScrollTop(val);\n    if (cm.display.scroller.scrollTop != val) { cm.display.scroller.scrollTop = val; }\n  }\n\n  // Sync scroller and scrollbar, ensure the gutter elements are\n  // aligned.\n  function setScrollLeft(cm, val, isScroller, forceScroll) {\n    val = Math.max(0, Math.min(val, cm.display.scroller.scrollWidth - cm.display.scroller.clientWidth));\n    if ((isScroller ? val == cm.doc.scrollLeft : Math.abs(cm.doc.scrollLeft - val) < 2) && !forceScroll) { return }\n    cm.doc.scrollLeft = val;\n    alignHorizontally(cm);\n    if (cm.display.scroller.scrollLeft != val) { cm.display.scroller.scrollLeft = val; }\n    cm.display.scrollbars.setScrollLeft(val);\n  }\n\n  // SCROLLBARS\n\n  // Prepare DOM reads needed to update the scrollbars. Done in one\n  // shot to minimize update/measure roundtrips.\n  function measureForScrollbars(cm) {\n    var d = cm.display, gutterW = d.gutters.offsetWidth;\n    var docH = Math.round(cm.doc.height + paddingVert(cm.display));\n    return {\n      clientHeight: d.scroller.clientHeight,\n      viewHeight: d.wrapper.clientHeight,\n      scrollWidth: d.scroller.scrollWidth, clientWidth: d.scroller.clientWidth,\n      viewWidth: d.wrapper.clientWidth,\n      barLeft: cm.options.fixedGutter ? gutterW : 0,\n      docHeight: docH,\n      scrollHeight: docH + scrollGap(cm) + d.barHeight,\n      nativeBarWidth: d.nativeBarWidth,\n      gutterWidth: gutterW\n    }\n  }\n\n  var NativeScrollbars = function(place, scroll, cm) {\n    this.cm = cm;\n    var vert = this.vert = elt(\"div\", [elt(\"div\", null, null, \"min-width: 1px\")], \"CodeMirror-vscrollbar\");\n    var horiz = this.horiz = elt(\"div\", [elt(\"div\", null, null, \"height: 100%; min-height: 1px\")], \"CodeMirror-hscrollbar\");\n    vert.tabIndex = horiz.tabIndex = -1;\n    place(vert); place(horiz);\n\n    on(vert, \"scroll\", function () {\n      if (vert.clientHeight) { scroll(vert.scrollTop, \"vertical\"); }\n    });\n    on(horiz, \"scroll\", function () {\n      if (horiz.clientWidth) { scroll(horiz.scrollLeft, \"horizontal\"); }\n    });\n\n    this.checkedZeroWidth = false;\n    // Need to set a minimum width to see the scrollbar on IE7 (but must not set it on IE8).\n    if (ie && ie_version < 8) { this.horiz.style.minHeight = this.vert.style.minWidth = \"18px\"; }\n  };\n\n  NativeScrollbars.prototype.update = function (measure) {\n    var needsH = measure.scrollWidth > measure.clientWidth + 1;\n    var needsV = measure.scrollHeight > measure.clientHeight + 1;\n    var sWidth = measure.nativeBarWidth;\n\n    if (needsV) {\n      this.vert.style.display = \"block\";\n      this.vert.style.bottom = needsH ? sWidth + \"px\" : \"0\";\n      var totalHeight = measure.viewHeight - (needsH ? sWidth : 0);\n      // A bug in IE8 can cause this value to be negative, so guard it.\n      this.vert.firstChild.style.height =\n        Math.max(0, measure.scrollHeight - measure.clientHeight + totalHeight) + \"px\";\n    } else {\n      this.vert.style.display = \"\";\n      this.vert.firstChild.style.height = \"0\";\n    }\n\n    if (needsH) {\n      this.horiz.style.display = \"block\";\n      this.horiz.style.right = needsV ? sWidth + \"px\" : \"0\";\n      this.horiz.style.left = measure.barLeft + \"px\";\n      var totalWidth = measure.viewWidth - measure.barLeft - (needsV ? sWidth : 0);\n      this.horiz.firstChild.style.width =\n        Math.max(0, measure.scrollWidth - measure.clientWidth + totalWidth) + \"px\";\n    } else {\n      this.horiz.style.display = \"\";\n      this.horiz.firstChild.style.width = \"0\";\n    }\n\n    if (!this.checkedZeroWidth && measure.clientHeight > 0) {\n      if (sWidth == 0) { this.zeroWidthHack(); }\n      this.checkedZeroWidth = true;\n    }\n\n    return {right: needsV ? sWidth : 0, bottom: needsH ? sWidth : 0}\n  };\n\n  NativeScrollbars.prototype.setScrollLeft = function (pos) {\n    if (this.horiz.scrollLeft != pos) { this.horiz.scrollLeft = pos; }\n    if (this.disableHoriz) { this.enableZeroWidthBar(this.horiz, this.disableHoriz, \"horiz\"); }\n  };\n\n  NativeScrollbars.prototype.setScrollTop = function (pos) {\n    if (this.vert.scrollTop != pos) { this.vert.scrollTop = pos; }\n    if (this.disableVert) { this.enableZeroWidthBar(this.vert, this.disableVert, \"vert\"); }\n  };\n\n  NativeScrollbars.prototype.zeroWidthHack = function () {\n    var w = mac && !mac_geMountainLion ? \"12px\" : \"18px\";\n    this.horiz.style.height = this.vert.style.width = w;\n    this.horiz.style.pointerEvents = this.vert.style.pointerEvents = \"none\";\n    this.disableHoriz = new Delayed;\n    this.disableVert = new Delayed;\n  };\n\n  NativeScrollbars.prototype.enableZeroWidthBar = function (bar, delay, type) {\n    bar.style.pointerEvents = \"auto\";\n    function maybeDisable() {\n      // To find out whether the scrollbar is still visible, we\n      // check whether the element under the pixel in the bottom\n      // right corner of the scrollbar box is the scrollbar box\n      // itself (when the bar is still visible) or its filler child\n      // (when the bar is hidden). If it is still visible, we keep\n      // it enabled, if it's hidden, we disable pointer events.\n      var box = bar.getBoundingClientRect();\n      var elt = type == \"vert\" ? document.elementFromPoint(box.right - 1, (box.top + box.bottom) / 2)\n          : document.elementFromPoint((box.right + box.left) / 2, box.bottom - 1);\n      if (elt != bar) { bar.style.pointerEvents = \"none\"; }\n      else { delay.set(1000, maybeDisable); }\n    }\n    delay.set(1000, maybeDisable);\n  };\n\n  NativeScrollbars.prototype.clear = function () {\n    var parent = this.horiz.parentNode;\n    parent.removeChild(this.horiz);\n    parent.removeChild(this.vert);\n  };\n\n  var NullScrollbars = function () {};\n\n  NullScrollbars.prototype.update = function () { return {bottom: 0, right: 0} };\n  NullScrollbars.prototype.setScrollLeft = function () {};\n  NullScrollbars.prototype.setScrollTop = function () {};\n  NullScrollbars.prototype.clear = function () {};\n\n  function updateScrollbars(cm, measure) {\n    if (!measure) { measure = measureForScrollbars(cm); }\n    var startWidth = cm.display.barWidth, startHeight = cm.display.barHeight;\n    updateScrollbarsInner(cm, measure);\n    for (var i = 0; i < 4 && startWidth != cm.display.barWidth || startHeight != cm.display.barHeight; i++) {\n      if (startWidth != cm.display.barWidth && cm.options.lineWrapping)\n        { updateHeightsInViewport(cm); }\n      updateScrollbarsInner(cm, measureForScrollbars(cm));\n      startWidth = cm.display.barWidth; startHeight = cm.display.barHeight;\n    }\n  }\n\n  // Re-synchronize the fake scrollbars with the actual size of the\n  // content.\n  function updateScrollbarsInner(cm, measure) {\n    var d = cm.display;\n    var sizes = d.scrollbars.update(measure);\n\n    d.sizer.style.paddingRight = (d.barWidth = sizes.right) + \"px\";\n    d.sizer.style.paddingBottom = (d.barHeight = sizes.bottom) + \"px\";\n    d.heightForcer.style.borderBottom = sizes.bottom + \"px solid transparent\";\n\n    if (sizes.right && sizes.bottom) {\n      d.scrollbarFiller.style.display = \"block\";\n      d.scrollbarFiller.style.height = sizes.bottom + \"px\";\n      d.scrollbarFiller.style.width = sizes.right + \"px\";\n    } else { d.scrollbarFiller.style.display = \"\"; }\n    if (sizes.bottom && cm.options.coverGutterNextToScrollbar && cm.options.fixedGutter) {\n      d.gutterFiller.style.display = \"block\";\n      d.gutterFiller.style.height = sizes.bottom + \"px\";\n      d.gutterFiller.style.width = measure.gutterWidth + \"px\";\n    } else { d.gutterFiller.style.display = \"\"; }\n  }\n\n  var scrollbarModel = {\"native\": NativeScrollbars, \"null\": NullScrollbars};\n\n  function initScrollbars(cm) {\n    if (cm.display.scrollbars) {\n      cm.display.scrollbars.clear();\n      if (cm.display.scrollbars.addClass)\n        { rmClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n    }\n\n    cm.display.scrollbars = new scrollbarModel[cm.options.scrollbarStyle](function (node) {\n      cm.display.wrapper.insertBefore(node, cm.display.scrollbarFiller);\n      // Prevent clicks in the scrollbars from killing focus\n      on(node, \"mousedown\", function () {\n        if (cm.state.focused) { setTimeout(function () { return cm.display.input.focus(); }, 0); }\n      });\n      node.setAttribute(\"cm-not-content\", \"true\");\n    }, function (pos, axis) {\n      if (axis == \"horizontal\") { setScrollLeft(cm, pos); }\n      else { updateScrollTop(cm, pos); }\n    }, cm);\n    if (cm.display.scrollbars.addClass)\n      { addClass(cm.display.wrapper, cm.display.scrollbars.addClass); }\n  }\n\n  // Operations are used to wrap a series of changes to the editor\n  // state in such a way that each change won't have to update the\n  // cursor and display (which would be awkward, slow, and\n  // error-prone). Instead, display updates are batched and then all\n  // combined and executed at once.\n\n  var nextOpId = 0;\n  // Start a new operation.\n  function startOperation(cm) {\n    cm.curOp = {\n      cm: cm,\n      viewChanged: false,      // Flag that indicates that lines might need to be redrawn\n      startHeight: cm.doc.height, // Used to detect need to update scrollbar\n      forceUpdate: false,      // Used to force a redraw\n      updateInput: 0,       // Whether to reset the input textarea\n      typing: false,           // Whether this reset should be careful to leave existing text (for compositing)\n      changeObjs: null,        // Accumulated changes, for firing change events\n      cursorActivityHandlers: null, // Set of handlers to fire cursorActivity on\n      cursorActivityCalled: 0, // Tracks which cursorActivity handlers have been called already\n      selectionChanged: false, // Whether the selection needs to be redrawn\n      updateMaxLine: false,    // Set when the widest line needs to be determined anew\n      scrollLeft: null, scrollTop: null, // Intermediate scroll position, not pushed to DOM yet\n      scrollToPos: null,       // Used to scroll to a specific position\n      focus: false,\n      id: ++nextOpId           // Unique ID\n    };\n    pushOperation(cm.curOp);\n  }\n\n  // Finish an operation, updating the display and signalling delayed events\n  function endOperation(cm) {\n    var op = cm.curOp;\n    if (op) { finishOperation(op, function (group) {\n      for (var i = 0; i < group.ops.length; i++)\n        { group.ops[i].cm.curOp = null; }\n      endOperations(group);\n    }); }\n  }\n\n  // The DOM updates done when an operation finishes are batched so\n  // that the minimum number of relayouts are required.\n  function endOperations(group) {\n    var ops = group.ops;\n    for (var i = 0; i < ops.length; i++) // Read DOM\n      { endOperation_R1(ops[i]); }\n    for (var i$1 = 0; i$1 < ops.length; i$1++) // Write DOM (maybe)\n      { endOperation_W1(ops[i$1]); }\n    for (var i$2 = 0; i$2 < ops.length; i$2++) // Read DOM\n      { endOperation_R2(ops[i$2]); }\n    for (var i$3 = 0; i$3 < ops.length; i$3++) // Write DOM (maybe)\n      { endOperation_W2(ops[i$3]); }\n    for (var i$4 = 0; i$4 < ops.length; i$4++) // Read DOM\n      { endOperation_finish(ops[i$4]); }\n  }\n\n  function endOperation_R1(op) {\n    var cm = op.cm, display = cm.display;\n    maybeClipScrollbars(cm);\n    if (op.updateMaxLine) { findMaxLine(cm); }\n\n    op.mustUpdate = op.viewChanged || op.forceUpdate || op.scrollTop != null ||\n      op.scrollToPos && (op.scrollToPos.from.line < display.viewFrom ||\n                         op.scrollToPos.to.line >= display.viewTo) ||\n      display.maxLineChanged && cm.options.lineWrapping;\n    op.update = op.mustUpdate &&\n      new DisplayUpdate(cm, op.mustUpdate && {top: op.scrollTop, ensure: op.scrollToPos}, op.forceUpdate);\n  }\n\n  function endOperation_W1(op) {\n    op.updatedDisplay = op.mustUpdate && updateDisplayIfNeeded(op.cm, op.update);\n  }\n\n  function endOperation_R2(op) {\n    var cm = op.cm, display = cm.display;\n    if (op.updatedDisplay) { updateHeightsInViewport(cm); }\n\n    op.barMeasure = measureForScrollbars(cm);\n\n    // If the max line changed since it was last measured, measure it,\n    // and ensure the document's width matches it.\n    // updateDisplay_W2 will use these properties to do the actual resizing\n    if (display.maxLineChanged && !cm.options.lineWrapping) {\n      op.adjustWidthTo = measureChar(cm, display.maxLine, display.maxLine.text.length).left + 3;\n      cm.display.sizerWidth = op.adjustWidthTo;\n      op.barMeasure.scrollWidth =\n        Math.max(display.scroller.clientWidth, display.sizer.offsetLeft + op.adjustWidthTo + scrollGap(cm) + cm.display.barWidth);\n      op.maxScrollLeft = Math.max(0, display.sizer.offsetLeft + op.adjustWidthTo - displayWidth(cm));\n    }\n\n    if (op.updatedDisplay || op.selectionChanged)\n      { op.preparedSelection = display.input.prepareSelection(); }\n  }\n\n  function endOperation_W2(op) {\n    var cm = op.cm;\n\n    if (op.adjustWidthTo != null) {\n      cm.display.sizer.style.minWidth = op.adjustWidthTo + \"px\";\n      if (op.maxScrollLeft < cm.doc.scrollLeft)\n        { setScrollLeft(cm, Math.min(cm.display.scroller.scrollLeft, op.maxScrollLeft), true); }\n      cm.display.maxLineChanged = false;\n    }\n\n    var takeFocus = op.focus && op.focus == activeElt();\n    if (op.preparedSelection)\n      { cm.display.input.showSelection(op.preparedSelection, takeFocus); }\n    if (op.updatedDisplay || op.startHeight != cm.doc.height)\n      { updateScrollbars(cm, op.barMeasure); }\n    if (op.updatedDisplay)\n      { setDocumentHeight(cm, op.barMeasure); }\n\n    if (op.selectionChanged) { restartBlink(cm); }\n\n    if (cm.state.focused && op.updateInput)\n      { cm.display.input.reset(op.typing); }\n    if (takeFocus) { ensureFocus(op.cm); }\n  }\n\n  function endOperation_finish(op) {\n    var cm = op.cm, display = cm.display, doc = cm.doc;\n\n    if (op.updatedDisplay) { postUpdateDisplay(cm, op.update); }\n\n    // Abort mouse wheel delta measurement, when scrolling explicitly\n    if (display.wheelStartX != null && (op.scrollTop != null || op.scrollLeft != null || op.scrollToPos))\n      { display.wheelStartX = display.wheelStartY = null; }\n\n    // Propagate the scroll position to the actual DOM scroller\n    if (op.scrollTop != null) { setScrollTop(cm, op.scrollTop, op.forceScroll); }\n\n    if (op.scrollLeft != null) { setScrollLeft(cm, op.scrollLeft, true, true); }\n    // If we need to scroll a specific position into view, do so.\n    if (op.scrollToPos) {\n      var rect = scrollPosIntoView(cm, clipPos(doc, op.scrollToPos.from),\n                                   clipPos(doc, op.scrollToPos.to), op.scrollToPos.margin);\n      maybeScrollWindow(cm, rect);\n    }\n\n    // Fire events for markers that are hidden/unidden by editing or\n    // undoing\n    var hidden = op.maybeHiddenMarkers, unhidden = op.maybeUnhiddenMarkers;\n    if (hidden) { for (var i = 0; i < hidden.length; ++i)\n      { if (!hidden[i].lines.length) { signal(hidden[i], \"hide\"); } } }\n    if (unhidden) { for (var i$1 = 0; i$1 < unhidden.length; ++i$1)\n      { if (unhidden[i$1].lines.length) { signal(unhidden[i$1], \"unhide\"); } } }\n\n    if (display.wrapper.offsetHeight)\n      { doc.scrollTop = cm.display.scroller.scrollTop; }\n\n    // Fire change events, and delayed event handlers\n    if (op.changeObjs)\n      { signal(cm, \"changes\", cm, op.changeObjs); }\n    if (op.update)\n      { op.update.finish(); }\n  }\n\n  // Run the given function in an operation\n  function runInOp(cm, f) {\n    if (cm.curOp) { return f() }\n    startOperation(cm);\n    try { return f() }\n    finally { endOperation(cm); }\n  }\n  // Wraps a function in an operation. Returns the wrapped function.\n  function operation(cm, f) {\n    return function() {\n      if (cm.curOp) { return f.apply(cm, arguments) }\n      startOperation(cm);\n      try { return f.apply(cm, arguments) }\n      finally { endOperation(cm); }\n    }\n  }\n  // Used to add methods to editor and doc instances, wrapping them in\n  // operations.\n  function methodOp(f) {\n    return function() {\n      if (this.curOp) { return f.apply(this, arguments) }\n      startOperation(this);\n      try { return f.apply(this, arguments) }\n      finally { endOperation(this); }\n    }\n  }\n  function docMethodOp(f) {\n    return function() {\n      var cm = this.cm;\n      if (!cm || cm.curOp) { return f.apply(this, arguments) }\n      startOperation(cm);\n      try { return f.apply(this, arguments) }\n      finally { endOperation(cm); }\n    }\n  }\n\n  // HIGHLIGHT WORKER\n\n  function startWorker(cm, time) {\n    if (cm.doc.highlightFrontier < cm.display.viewTo)\n      { cm.state.highlight.set(time, bind(highlightWorker, cm)); }\n  }\n\n  function highlightWorker(cm) {\n    var doc = cm.doc;\n    if (doc.highlightFrontier >= cm.display.viewTo) { return }\n    var end = +new Date + cm.options.workTime;\n    var context = getContextBefore(cm, doc.highlightFrontier);\n    var changedLines = [];\n\n    doc.iter(context.line, Math.min(doc.first + doc.size, cm.display.viewTo + 500), function (line) {\n      if (context.line >= cm.display.viewFrom) { // Visible\n        var oldStyles = line.styles;\n        var resetState = line.text.length > cm.options.maxHighlightLength ? copyState(doc.mode, context.state) : null;\n        var highlighted = highlightLine(cm, line, context, true);\n        if (resetState) { context.state = resetState; }\n        line.styles = highlighted.styles;\n        var oldCls = line.styleClasses, newCls = highlighted.classes;\n        if (newCls) { line.styleClasses = newCls; }\n        else if (oldCls) { line.styleClasses = null; }\n        var ischange = !oldStyles || oldStyles.length != line.styles.length ||\n          oldCls != newCls && (!oldCls || !newCls || oldCls.bgClass != newCls.bgClass || oldCls.textClass != newCls.textClass);\n        for (var i = 0; !ischange && i < oldStyles.length; ++i) { ischange = oldStyles[i] != line.styles[i]; }\n        if (ischange) { changedLines.push(context.line); }\n        line.stateAfter = context.save();\n        context.nextLine();\n      } else {\n        if (line.text.length <= cm.options.maxHighlightLength)\n          { processLine(cm, line.text, context); }\n        line.stateAfter = context.line % 5 == 0 ? context.save() : null;\n        context.nextLine();\n      }\n      if (+new Date > end) {\n        startWorker(cm, cm.options.workDelay);\n        return true\n      }\n    });\n    doc.highlightFrontier = context.line;\n    doc.modeFrontier = Math.max(doc.modeFrontier, context.line);\n    if (changedLines.length) { runInOp(cm, function () {\n      for (var i = 0; i < changedLines.length; i++)\n        { regLineChange(cm, changedLines[i], \"text\"); }\n    }); }\n  }\n\n  // DISPLAY DRAWING\n\n  var DisplayUpdate = function(cm, viewport, force) {\n    var display = cm.display;\n\n    this.viewport = viewport;\n    // Store some values that we'll need later (but don't want to force a relayout for)\n    this.visible = visibleLines(display, cm.doc, viewport);\n    this.editorIsHidden = !display.wrapper.offsetWidth;\n    this.wrapperHeight = display.wrapper.clientHeight;\n    this.wrapperWidth = display.wrapper.clientWidth;\n    this.oldDisplayWidth = displayWidth(cm);\n    this.force = force;\n    this.dims = getDimensions(cm);\n    this.events = [];\n  };\n\n  DisplayUpdate.prototype.signal = function (emitter, type) {\n    if (hasHandler(emitter, type))\n      { this.events.push(arguments); }\n  };\n  DisplayUpdate.prototype.finish = function () {\n    for (var i = 0; i < this.events.length; i++)\n      { signal.apply(null, this.events[i]); }\n  };\n\n  function maybeClipScrollbars(cm) {\n    var display = cm.display;\n    if (!display.scrollbarsClipped && display.scroller.offsetWidth) {\n      display.nativeBarWidth = display.scroller.offsetWidth - display.scroller.clientWidth;\n      display.heightForcer.style.height = scrollGap(cm) + \"px\";\n      display.sizer.style.marginBottom = -display.nativeBarWidth + \"px\";\n      display.sizer.style.borderRightWidth = scrollGap(cm) + \"px\";\n      display.scrollbarsClipped = true;\n    }\n  }\n\n  function selectionSnapshot(cm) {\n    if (cm.hasFocus()) { return null }\n    var active = activeElt();\n    if (!active || !contains(cm.display.lineDiv, active)) { return null }\n    var result = {activeElt: active};\n    if (window.getSelection) {\n      var sel = window.getSelection();\n      if (sel.anchorNode && sel.extend && contains(cm.display.lineDiv, sel.anchorNode)) {\n        result.anchorNode = sel.anchorNode;\n        result.anchorOffset = sel.anchorOffset;\n        result.focusNode = sel.focusNode;\n        result.focusOffset = sel.focusOffset;\n      }\n    }\n    return result\n  }\n\n  function restoreSelection(snapshot) {\n    if (!snapshot || !snapshot.activeElt || snapshot.activeElt == activeElt()) { return }\n    snapshot.activeElt.focus();\n    if (!/^(INPUT|TEXTAREA)$/.test(snapshot.activeElt.nodeName) &&\n        snapshot.anchorNode && contains(document.body, snapshot.anchorNode) && contains(document.body, snapshot.focusNode)) {\n      var sel = window.getSelection(), range = document.createRange();\n      range.setEnd(snapshot.anchorNode, snapshot.anchorOffset);\n      range.collapse(false);\n      sel.removeAllRanges();\n      sel.addRange(range);\n      sel.extend(snapshot.focusNode, snapshot.focusOffset);\n    }\n  }\n\n  // Does the actual updating of the line display. Bails out\n  // (returning false) when there is nothing to be done and forced is\n  // false.\n  function updateDisplayIfNeeded(cm, update) {\n    var display = cm.display, doc = cm.doc;\n\n    if (update.editorIsHidden) {\n      resetView(cm);\n      return false\n    }\n\n    // Bail out if the visible area is already rendered and nothing changed.\n    if (!update.force &&\n        update.visible.from >= display.viewFrom && update.visible.to <= display.viewTo &&\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo) &&\n        display.renderedView == display.view && countDirtyView(cm) == 0)\n      { return false }\n\n    if (maybeUpdateLineNumberWidth(cm)) {\n      resetView(cm);\n      update.dims = getDimensions(cm);\n    }\n\n    // Compute a suitable new viewport (from & to)\n    var end = doc.first + doc.size;\n    var from = Math.max(update.visible.from - cm.options.viewportMargin, doc.first);\n    var to = Math.min(end, update.visible.to + cm.options.viewportMargin);\n    if (display.viewFrom < from && from - display.viewFrom < 20) { from = Math.max(doc.first, display.viewFrom); }\n    if (display.viewTo > to && display.viewTo - to < 20) { to = Math.min(end, display.viewTo); }\n    if (sawCollapsedSpans) {\n      from = visualLineNo(cm.doc, from);\n      to = visualLineEndNo(cm.doc, to);\n    }\n\n    var different = from != display.viewFrom || to != display.viewTo ||\n      display.lastWrapHeight != update.wrapperHeight || display.lastWrapWidth != update.wrapperWidth;\n    adjustView(cm, from, to);\n\n    display.viewOffset = heightAtLine(getLine(cm.doc, display.viewFrom));\n    // Position the mover div to align with the current scroll position\n    cm.display.mover.style.top = display.viewOffset + \"px\";\n\n    var toUpdate = countDirtyView(cm);\n    if (!different && toUpdate == 0 && !update.force && display.renderedView == display.view &&\n        (display.updateLineNumbers == null || display.updateLineNumbers >= display.viewTo))\n      { return false }\n\n    // For big changes, we hide the enclosing element during the\n    // update, since that speeds up the operations on most browsers.\n    var selSnapshot = selectionSnapshot(cm);\n    if (toUpdate > 4) { display.lineDiv.style.display = \"none\"; }\n    patchDisplay(cm, display.updateLineNumbers, update.dims);\n    if (toUpdate > 4) { display.lineDiv.style.display = \"\"; }\n    display.renderedView = display.view;\n    // There might have been a widget with a focused element that got\n    // hidden or updated, if so re-focus it.\n    restoreSelection(selSnapshot);\n\n    // Prevent selection and cursors from interfering with the scroll\n    // width and height.\n    removeChildren(display.cursorDiv);\n    removeChildren(display.selectionDiv);\n    display.gutters.style.height = display.sizer.style.minHeight = 0;\n\n    if (different) {\n      display.lastWrapHeight = update.wrapperHeight;\n      display.lastWrapWidth = update.wrapperWidth;\n      startWorker(cm, 400);\n    }\n\n    display.updateLineNumbers = null;\n\n    return true\n  }\n\n  function postUpdateDisplay(cm, update) {\n    var viewport = update.viewport;\n\n    for (var first = true;; first = false) {\n      if (!first || !cm.options.lineWrapping || update.oldDisplayWidth == displayWidth(cm)) {\n        // Clip forced viewport to actual scrollable area.\n        if (viewport && viewport.top != null)\n          { viewport = {top: Math.min(cm.doc.height + paddingVert(cm.display) - displayHeight(cm), viewport.top)}; }\n        // Updated line heights might result in the drawn area not\n        // actually covering the viewport. Keep looping until it does.\n        update.visible = visibleLines(cm.display, cm.doc, viewport);\n        if (update.visible.from >= cm.display.viewFrom && update.visible.to <= cm.display.viewTo)\n          { break }\n      } else if (first) {\n        update.visible = visibleLines(cm.display, cm.doc, viewport);\n      }\n      if (!updateDisplayIfNeeded(cm, update)) { break }\n      updateHeightsInViewport(cm);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      updateScrollbars(cm, barMeasure);\n      setDocumentHeight(cm, barMeasure);\n      update.force = false;\n    }\n\n    update.signal(cm, \"update\", cm);\n    if (cm.display.viewFrom != cm.display.reportedViewFrom || cm.display.viewTo != cm.display.reportedViewTo) {\n      update.signal(cm, \"viewportChange\", cm, cm.display.viewFrom, cm.display.viewTo);\n      cm.display.reportedViewFrom = cm.display.viewFrom; cm.display.reportedViewTo = cm.display.viewTo;\n    }\n  }\n\n  function updateDisplaySimple(cm, viewport) {\n    var update = new DisplayUpdate(cm, viewport);\n    if (updateDisplayIfNeeded(cm, update)) {\n      updateHeightsInViewport(cm);\n      postUpdateDisplay(cm, update);\n      var barMeasure = measureForScrollbars(cm);\n      updateSelection(cm);\n      updateScrollbars(cm, barMeasure);\n      setDocumentHeight(cm, barMeasure);\n      update.finish();\n    }\n  }\n\n  // Sync the actual display DOM structure with display.view, removing\n  // nodes for lines that are no longer in view, and creating the ones\n  // that are not there yet, and updating the ones that are out of\n  // date.\n  function patchDisplay(cm, updateNumbersFrom, dims) {\n    var display = cm.display, lineNumbers = cm.options.lineNumbers;\n    var container = display.lineDiv, cur = container.firstChild;\n\n    function rm(node) {\n      var next = node.nextSibling;\n      // Works around a throw-scroll bug in OS X Webkit\n      if (webkit && mac && cm.display.currentWheelTarget == node)\n        { node.style.display = \"none\"; }\n      else\n        { node.parentNode.removeChild(node); }\n      return next\n    }\n\n    var view = display.view, lineN = display.viewFrom;\n    // Loop over the elements in the view, syncing cur (the DOM nodes\n    // in display.lineDiv) with the view as we go.\n    for (var i = 0; i < view.length; i++) {\n      var lineView = view[i];\n      if (lineView.hidden) ; else if (!lineView.node || lineView.node.parentNode != container) { // Not drawn yet\n        var node = buildLineElement(cm, lineView, lineN, dims);\n        container.insertBefore(node, cur);\n      } else { // Already drawn\n        while (cur != lineView.node) { cur = rm(cur); }\n        var updateNumber = lineNumbers && updateNumbersFrom != null &&\n          updateNumbersFrom <= lineN && lineView.lineNumber;\n        if (lineView.changes) {\n          if (indexOf(lineView.changes, \"gutter\") > -1) { updateNumber = false; }\n          updateLineForChanges(cm, lineView, lineN, dims);\n        }\n        if (updateNumber) {\n          removeChildren(lineView.lineNumber);\n          lineView.lineNumber.appendChild(document.createTextNode(lineNumberFor(cm.options, lineN)));\n        }\n        cur = lineView.node.nextSibling;\n      }\n      lineN += lineView.size;\n    }\n    while (cur) { cur = rm(cur); }\n  }\n\n  function updateGutterSpace(display) {\n    var width = display.gutters.offsetWidth;\n    display.sizer.style.marginLeft = width + \"px\";\n  }\n\n  function setDocumentHeight(cm, measure) {\n    cm.display.sizer.style.minHeight = measure.docHeight + \"px\";\n    cm.display.heightForcer.style.top = measure.docHeight + \"px\";\n    cm.display.gutters.style.height = (measure.docHeight + cm.display.barHeight + scrollGap(cm)) + \"px\";\n  }\n\n  // Re-align line numbers and gutter marks to compensate for\n  // horizontal scrolling.\n  function alignHorizontally(cm) {\n    var display = cm.display, view = display.view;\n    if (!display.alignWidgets && (!display.gutters.firstChild || !cm.options.fixedGutter)) { return }\n    var comp = compensateForHScroll(display) - display.scroller.scrollLeft + cm.doc.scrollLeft;\n    var gutterW = display.gutters.offsetWidth, left = comp + \"px\";\n    for (var i = 0; i < view.length; i++) { if (!view[i].hidden) {\n      if (cm.options.fixedGutter) {\n        if (view[i].gutter)\n          { view[i].gutter.style.left = left; }\n        if (view[i].gutterBackground)\n          { view[i].gutterBackground.style.left = left; }\n      }\n      var align = view[i].alignable;\n      if (align) { for (var j = 0; j < align.length; j++)\n        { align[j].style.left = left; } }\n    } }\n    if (cm.options.fixedGutter)\n      { display.gutters.style.left = (comp + gutterW) + \"px\"; }\n  }\n\n  // Used to ensure that the line number gutter is still the right\n  // size for the current document size. Returns true when an update\n  // is needed.\n  function maybeUpdateLineNumberWidth(cm) {\n    if (!cm.options.lineNumbers) { return false }\n    var doc = cm.doc, last = lineNumberFor(cm.options, doc.first + doc.size - 1), display = cm.display;\n    if (last.length != display.lineNumChars) {\n      var test = display.measure.appendChild(elt(\"div\", [elt(\"div\", last)],\n                                                 \"CodeMirror-linenumber CodeMirror-gutter-elt\"));\n      var innerW = test.firstChild.offsetWidth, padding = test.offsetWidth - innerW;\n      display.lineGutter.style.width = \"\";\n      display.lineNumInnerWidth = Math.max(innerW, display.lineGutter.offsetWidth - padding) + 1;\n      display.lineNumWidth = display.lineNumInnerWidth + padding;\n      display.lineNumChars = display.lineNumInnerWidth ? last.length : -1;\n      display.lineGutter.style.width = display.lineNumWidth + \"px\";\n      updateGutterSpace(cm.display);\n      return true\n    }\n    return false\n  }\n\n  function getGutters(gutters, lineNumbers) {\n    var result = [], sawLineNumbers = false;\n    for (var i = 0; i < gutters.length; i++) {\n      var name = gutters[i], style = null;\n      if (typeof name != \"string\") { style = name.style; name = name.className; }\n      if (name == \"CodeMirror-linenumbers\") {\n        if (!lineNumbers) { continue }\n        else { sawLineNumbers = true; }\n      }\n      result.push({className: name, style: style});\n    }\n    if (lineNumbers && !sawLineNumbers) { result.push({className: \"CodeMirror-linenumbers\", style: null}); }\n    return result\n  }\n\n  // Rebuild the gutter elements, ensure the margin to the left of the\n  // code matches their width.\n  function renderGutters(display) {\n    var gutters = display.gutters, specs = display.gutterSpecs;\n    removeChildren(gutters);\n    display.lineGutter = null;\n    for (var i = 0; i < specs.length; ++i) {\n      var ref = specs[i];\n      var className = ref.className;\n      var style = ref.style;\n      var gElt = gutters.appendChild(elt(\"div\", null, \"CodeMirror-gutter \" + className));\n      if (style) { gElt.style.cssText = style; }\n      if (className == \"CodeMirror-linenumbers\") {\n        display.lineGutter = gElt;\n        gElt.style.width = (display.lineNumWidth || 1) + \"px\";\n      }\n    }\n    gutters.style.display = specs.length ? \"\" : \"none\";\n    updateGutterSpace(display);\n  }\n\n  function updateGutters(cm) {\n    renderGutters(cm.display);\n    regChange(cm);\n    alignHorizontally(cm);\n  }\n\n  // The display handles the DOM integration, both for input reading\n  // and content drawing. It holds references to DOM nodes and\n  // display-related state.\n\n  function Display(place, doc, input, options) {\n    var d = this;\n    this.input = input;\n\n    // Covers bottom-right square when both scrollbars are present.\n    d.scrollbarFiller = elt(\"div\", null, \"CodeMirror-scrollbar-filler\");\n    d.scrollbarFiller.setAttribute(\"cm-not-content\", \"true\");\n    // Covers bottom of gutter when coverGutterNextToScrollbar is on\n    // and h scrollbar is present.\n    d.gutterFiller = elt(\"div\", null, \"CodeMirror-gutter-filler\");\n    d.gutterFiller.setAttribute(\"cm-not-content\", \"true\");\n    // Will contain the actual code, positioned to cover the viewport.\n    d.lineDiv = eltP(\"div\", null, \"CodeMirror-code\");\n    // Elements are added to these to represent selection and cursors.\n    d.selectionDiv = elt(\"div\", null, null, \"position: relative; z-index: 1\");\n    d.cursorDiv = elt(\"div\", null, \"CodeMirror-cursors\");\n    // A visibility: hidden element used to find the size of things.\n    d.measure = elt(\"div\", null, \"CodeMirror-measure\");\n    // When lines outside of the viewport are measured, they are drawn in this.\n    d.lineMeasure = elt(\"div\", null, \"CodeMirror-measure\");\n    // Wraps everything that needs to exist inside the vertically-padded coordinate system\n    d.lineSpace = eltP(\"div\", [d.measure, d.lineMeasure, d.selectionDiv, d.cursorDiv, d.lineDiv],\n                      null, \"position: relative; outline: none\");\n    var lines = eltP(\"div\", [d.lineSpace], \"CodeMirror-lines\");\n    // Moved around its parent to cover visible view.\n    d.mover = elt(\"div\", [lines], null, \"position: relative\");\n    // Set to the height of the document, allowing scrolling.\n    d.sizer = elt(\"div\", [d.mover], \"CodeMirror-sizer\");\n    d.sizerWidth = null;\n    // Behavior of elts with overflow: auto and padding is\n    // inconsistent across browsers. This is used to ensure the\n    // scrollable area is big enough.\n    d.heightForcer = elt(\"div\", null, null, \"position: absolute; height: \" + scrollerGap + \"px; width: 1px;\");\n    // Will contain the gutters, if any.\n    d.gutters = elt(\"div\", null, \"CodeMirror-gutters\");\n    d.lineGutter = null;\n    // Actual scrollable element.\n    d.scroller = elt(\"div\", [d.sizer, d.heightForcer, d.gutters], \"CodeMirror-scroll\");\n    d.scroller.setAttribute(\"tabIndex\", \"-1\");\n    // The element in which the editor lives.\n    d.wrapper = elt(\"div\", [d.scrollbarFiller, d.gutterFiller, d.scroller], \"CodeMirror\");\n\n    // Work around IE7 z-index bug (not perfect, hence IE7 not really being supported)\n    if (ie && ie_version < 8) { d.gutters.style.zIndex = -1; d.scroller.style.paddingRight = 0; }\n    if (!webkit && !(gecko && mobile)) { d.scroller.draggable = true; }\n\n    if (place) {\n      if (place.appendChild) { place.appendChild(d.wrapper); }\n      else { place(d.wrapper); }\n    }\n\n    // Current rendered range (may be bigger than the view window).\n    d.viewFrom = d.viewTo = doc.first;\n    d.reportedViewFrom = d.reportedViewTo = doc.first;\n    // Information about the rendered lines.\n    d.view = [];\n    d.renderedView = null;\n    // Holds info about a single rendered line when it was rendered\n    // for measurement, while not in view.\n    d.externalMeasured = null;\n    // Empty space (in pixels) above the view\n    d.viewOffset = 0;\n    d.lastWrapHeight = d.lastWrapWidth = 0;\n    d.updateLineNumbers = null;\n\n    d.nativeBarWidth = d.barHeight = d.barWidth = 0;\n    d.scrollbarsClipped = false;\n\n    // Used to only resize the line number gutter when necessary (when\n    // the amount of lines crosses a boundary that makes its width change)\n    d.lineNumWidth = d.lineNumInnerWidth = d.lineNumChars = null;\n    // Set to true when a non-horizontal-scrolling line widget is\n    // added. As an optimization, line widget aligning is skipped when\n    // this is false.\n    d.alignWidgets = false;\n\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n\n    // Tracks the maximum line length so that the horizontal scrollbar\n    // can be kept static when scrolling.\n    d.maxLine = null;\n    d.maxLineLength = 0;\n    d.maxLineChanged = false;\n\n    // Used for measuring wheel scrolling granularity\n    d.wheelDX = d.wheelDY = d.wheelStartX = d.wheelStartY = null;\n\n    // True when shift is held down.\n    d.shift = false;\n\n    // Used to track whether anything happened since the context menu\n    // was opened.\n    d.selForContextMenu = null;\n\n    d.activeTouch = null;\n\n    d.gutterSpecs = getGutters(options.gutters, options.lineNumbers);\n    renderGutters(d);\n\n    input.init(d);\n  }\n\n  // Since the delta values reported on mouse wheel events are\n  // unstandardized between browsers and even browser versions, and\n  // generally horribly unpredictable, this code starts by measuring\n  // the scroll effect that the first few mouse wheel events have,\n  // and, from that, detects the way it can convert deltas to pixel\n  // offsets afterwards.\n  //\n  // The reason we want to know the amount a wheel event will scroll\n  // is that it gives us a chance to update the display before the\n  // actual scrolling happens, reducing flickering.\n\n  var wheelSamples = 0, wheelPixelsPerUnit = null;\n  // Fill in a browser-detected starting value on browsers where we\n  // know one. These don't have to be accurate -- the result of them\n  // being wrong would just be a slight flicker on the first wheel\n  // scroll (if it is large enough).\n  if (ie) { wheelPixelsPerUnit = -.53; }\n  else if (gecko) { wheelPixelsPerUnit = 15; }\n  else if (chrome) { wheelPixelsPerUnit = -.7; }\n  else if (safari) { wheelPixelsPerUnit = -1/3; }\n\n  function wheelEventDelta(e) {\n    var dx = e.wheelDeltaX, dy = e.wheelDeltaY;\n    if (dx == null && e.detail && e.axis == e.HORIZONTAL_AXIS) { dx = e.detail; }\n    if (dy == null && e.detail && e.axis == e.VERTICAL_AXIS) { dy = e.detail; }\n    else if (dy == null) { dy = e.wheelDelta; }\n    return {x: dx, y: dy}\n  }\n  function wheelEventPixels(e) {\n    var delta = wheelEventDelta(e);\n    delta.x *= wheelPixelsPerUnit;\n    delta.y *= wheelPixelsPerUnit;\n    return delta\n  }\n\n  function onScrollWheel(cm, e) {\n    var delta = wheelEventDelta(e), dx = delta.x, dy = delta.y;\n\n    var display = cm.display, scroll = display.scroller;\n    // Quit if there's nothing to scroll here\n    var canScrollX = scroll.scrollWidth > scroll.clientWidth;\n    var canScrollY = scroll.scrollHeight > scroll.clientHeight;\n    if (!(dx && canScrollX || dy && canScrollY)) { return }\n\n    // Webkit browsers on OS X abort momentum scrolls when the target\n    // of the scroll event is removed from the scrollable element.\n    // This hack (see related code in patchDisplay) makes sure the\n    // element is kept around.\n    if (dy && mac && webkit) {\n      outer: for (var cur = e.target, view = display.view; cur != scroll; cur = cur.parentNode) {\n        for (var i = 0; i < view.length; i++) {\n          if (view[i].node == cur) {\n            cm.display.currentWheelTarget = cur;\n            break outer\n          }\n        }\n      }\n    }\n\n    // On some browsers, horizontal scrolling will cause redraws to\n    // happen before the gutter has been realigned, causing it to\n    // wriggle around in a most unseemly way. When we have an\n    // estimated pixels/delta value, we just handle horizontal\n    // scrolling entirely here. It'll be slightly off from native, but\n    // better than glitching out.\n    if (dx && !gecko && !presto && wheelPixelsPerUnit != null) {\n      if (dy && canScrollY)\n        { updateScrollTop(cm, Math.max(0, scroll.scrollTop + dy * wheelPixelsPerUnit)); }\n      setScrollLeft(cm, Math.max(0, scroll.scrollLeft + dx * wheelPixelsPerUnit));\n      // Only prevent default scrolling if vertical scrolling is\n      // actually possible. Otherwise, it causes vertical scroll\n      // jitter on OSX trackpads when deltaX is small and deltaY\n      // is large (issue #3579)\n      if (!dy || (dy && canScrollY))\n        { e_preventDefault(e); }\n      display.wheelStartX = null; // Abort measurement, if in progress\n      return\n    }\n\n    // 'Project' the visible viewport to cover the area that is being\n    // scrolled into view (if we know enough to estimate it).\n    if (dy && wheelPixelsPerUnit != null) {\n      var pixels = dy * wheelPixelsPerUnit;\n      var top = cm.doc.scrollTop, bot = top + display.wrapper.clientHeight;\n      if (pixels < 0) { top = Math.max(0, top + pixels - 50); }\n      else { bot = Math.min(cm.doc.height, bot + pixels + 50); }\n      updateDisplaySimple(cm, {top: top, bottom: bot});\n    }\n\n    if (wheelSamples < 20) {\n      if (display.wheelStartX == null) {\n        display.wheelStartX = scroll.scrollLeft; display.wheelStartY = scroll.scrollTop;\n        display.wheelDX = dx; display.wheelDY = dy;\n        setTimeout(function () {\n          if (display.wheelStartX == null) { return }\n          var movedX = scroll.scrollLeft - display.wheelStartX;\n          var movedY = scroll.scrollTop - display.wheelStartY;\n          var sample = (movedY && display.wheelDY && movedY / display.wheelDY) ||\n            (movedX && display.wheelDX && movedX / display.wheelDX);\n          display.wheelStartX = display.wheelStartY = null;\n          if (!sample) { return }\n          wheelPixelsPerUnit = (wheelPixelsPerUnit * wheelSamples + sample) / (wheelSamples + 1);\n          ++wheelSamples;\n        }, 200);\n      } else {\n        display.wheelDX += dx; display.wheelDY += dy;\n      }\n    }\n  }\n\n  // Selection objects are immutable. A new one is created every time\n  // the selection changes. A selection is one or more non-overlapping\n  // (and non-touching) ranges, sorted, and an integer that indicates\n  // which one is the primary selection (the one that's scrolled into\n  // view, that getCursor returns, etc).\n  var Selection = function(ranges, primIndex) {\n    this.ranges = ranges;\n    this.primIndex = primIndex;\n  };\n\n  Selection.prototype.primary = function () { return this.ranges[this.primIndex] };\n\n  Selection.prototype.equals = function (other) {\n    if (other == this) { return true }\n    if (other.primIndex != this.primIndex || other.ranges.length != this.ranges.length) { return false }\n    for (var i = 0; i < this.ranges.length; i++) {\n      var here = this.ranges[i], there = other.ranges[i];\n      if (!equalCursorPos(here.anchor, there.anchor) || !equalCursorPos(here.head, there.head)) { return false }\n    }\n    return true\n  };\n\n  Selection.prototype.deepCopy = function () {\n    var out = [];\n    for (var i = 0; i < this.ranges.length; i++)\n      { out[i] = new Range(copyPos(this.ranges[i].anchor), copyPos(this.ranges[i].head)); }\n    return new Selection(out, this.primIndex)\n  };\n\n  Selection.prototype.somethingSelected = function () {\n    for (var i = 0; i < this.ranges.length; i++)\n      { if (!this.ranges[i].empty()) { return true } }\n    return false\n  };\n\n  Selection.prototype.contains = function (pos, end) {\n    if (!end) { end = pos; }\n    for (var i = 0; i < this.ranges.length; i++) {\n      var range = this.ranges[i];\n      if (cmp(end, range.from()) >= 0 && cmp(pos, range.to()) <= 0)\n        { return i }\n    }\n    return -1\n  };\n\n  var Range = function(anchor, head) {\n    this.anchor = anchor; this.head = head;\n  };\n\n  Range.prototype.from = function () { return minPos(this.anchor, this.head) };\n  Range.prototype.to = function () { return maxPos(this.anchor, this.head) };\n  Range.prototype.empty = function () { return this.head.line == this.anchor.line && this.head.ch == this.anchor.ch };\n\n  // Take an unsorted, potentially overlapping set of ranges, and\n  // build a selection out of it. 'Consumes' ranges array (modifying\n  // it).\n  function normalizeSelection(cm, ranges, primIndex) {\n    var mayTouch = cm && cm.options.selectionsMayTouch;\n    var prim = ranges[primIndex];\n    ranges.sort(function (a, b) { return cmp(a.from(), b.from()); });\n    primIndex = indexOf(ranges, prim);\n    for (var i = 1; i < ranges.length; i++) {\n      var cur = ranges[i], prev = ranges[i - 1];\n      var diff = cmp(prev.to(), cur.from());\n      if (mayTouch && !cur.empty() ? diff > 0 : diff >= 0) {\n        var from = minPos(prev.from(), cur.from()), to = maxPos(prev.to(), cur.to());\n        var inv = prev.empty() ? cur.from() == cur.head : prev.from() == prev.head;\n        if (i <= primIndex) { --primIndex; }\n        ranges.splice(--i, 2, new Range(inv ? to : from, inv ? from : to));\n      }\n    }\n    return new Selection(ranges, primIndex)\n  }\n\n  function simpleSelection(anchor, head) {\n    return new Selection([new Range(anchor, head || anchor)], 0)\n  }\n\n  // Compute the position of the end of a change (its 'to' property\n  // refers to the pre-change end).\n  function changeEnd(change) {\n    if (!change.text) { return change.to }\n    return Pos(change.from.line + change.text.length - 1,\n               lst(change.text).length + (change.text.length == 1 ? change.from.ch : 0))\n  }\n\n  // Adjust a position to refer to the post-change position of the\n  // same text, or the end of the change if the change covers it.\n  function adjustForChange(pos, change) {\n    if (cmp(pos, change.from) < 0) { return pos }\n    if (cmp(pos, change.to) <= 0) { return changeEnd(change) }\n\n    var line = pos.line + change.text.length - (change.to.line - change.from.line) - 1, ch = pos.ch;\n    if (pos.line == change.to.line) { ch += changeEnd(change).ch - change.to.ch; }\n    return Pos(line, ch)\n  }\n\n  function computeSelAfterChange(doc, change) {\n    var out = [];\n    for (var i = 0; i < doc.sel.ranges.length; i++) {\n      var range = doc.sel.ranges[i];\n      out.push(new Range(adjustForChange(range.anchor, change),\n                         adjustForChange(range.head, change)));\n    }\n    return normalizeSelection(doc.cm, out, doc.sel.primIndex)\n  }\n\n  function offsetPos(pos, old, nw) {\n    if (pos.line == old.line)\n      { return Pos(nw.line, pos.ch - old.ch + nw.ch) }\n    else\n      { return Pos(nw.line + (pos.line - old.line), pos.ch) }\n  }\n\n  // Used by replaceSelections to allow moving the selection to the\n  // start or around the replaced test. Hint may be \"start\" or \"around\".\n  function computeReplacedSel(doc, changes, hint) {\n    var out = [];\n    var oldPrev = Pos(doc.first, 0), newPrev = oldPrev;\n    for (var i = 0; i < changes.length; i++) {\n      var change = changes[i];\n      var from = offsetPos(change.from, oldPrev, newPrev);\n      var to = offsetPos(changeEnd(change), oldPrev, newPrev);\n      oldPrev = change.to;\n      newPrev = to;\n      if (hint == \"around\") {\n        var range = doc.sel.ranges[i], inv = cmp(range.head, range.anchor) < 0;\n        out[i] = new Range(inv ? to : from, inv ? from : to);\n      } else {\n        out[i] = new Range(from, from);\n      }\n    }\n    return new Selection(out, doc.sel.primIndex)\n  }\n\n  // Used to get the editor into a consistent state again when options change.\n\n  function loadMode(cm) {\n    cm.doc.mode = getMode(cm.options, cm.doc.modeOption);\n    resetModeState(cm);\n  }\n\n  function resetModeState(cm) {\n    cm.doc.iter(function (line) {\n      if (line.stateAfter) { line.stateAfter = null; }\n      if (line.styles) { line.styles = null; }\n    });\n    cm.doc.modeFrontier = cm.doc.highlightFrontier = cm.doc.first;\n    startWorker(cm, 100);\n    cm.state.modeGen++;\n    if (cm.curOp) { regChange(cm); }\n  }\n\n  // DOCUMENT DATA STRUCTURE\n\n  // By default, updates that start and end at the beginning of a line\n  // are treated specially, in order to make the association of line\n  // widgets and marker elements with the text behave more intuitive.\n  function isWholeLineUpdate(doc, change) {\n    return change.from.ch == 0 && change.to.ch == 0 && lst(change.text) == \"\" &&\n      (!doc.cm || doc.cm.options.wholeLineUpdateBefore)\n  }\n\n  // Perform a change on the document data structure.\n  function updateDoc(doc, change, markedSpans, estimateHeight) {\n    function spansFor(n) {return markedSpans ? markedSpans[n] : null}\n    function update(line, text, spans) {\n      updateLine(line, text, spans, estimateHeight);\n      signalLater(line, \"change\", line, change);\n    }\n    function linesFor(start, end) {\n      var result = [];\n      for (var i = start; i < end; ++i)\n        { result.push(new Line(text[i], spansFor(i), estimateHeight)); }\n      return result\n    }\n\n    var from = change.from, to = change.to, text = change.text;\n    var firstLine = getLine(doc, from.line), lastLine = getLine(doc, to.line);\n    var lastText = lst(text), lastSpans = spansFor(text.length - 1), nlines = to.line - from.line;\n\n    // Adjust the line structure\n    if (change.full) {\n      doc.insert(0, linesFor(0, text.length));\n      doc.remove(text.length, doc.size - text.length);\n    } else if (isWholeLineUpdate(doc, change)) {\n      // This is a whole-line replace. Treated specially to make\n      // sure line objects move the way they are supposed to.\n      var added = linesFor(0, text.length - 1);\n      update(lastLine, lastLine.text, lastSpans);\n      if (nlines) { doc.remove(from.line, nlines); }\n      if (added.length) { doc.insert(from.line, added); }\n    } else if (firstLine == lastLine) {\n      if (text.length == 1) {\n        update(firstLine, firstLine.text.slice(0, from.ch) + lastText + firstLine.text.slice(to.ch), lastSpans);\n      } else {\n        var added$1 = linesFor(1, text.length - 1);\n        added$1.push(new Line(lastText + firstLine.text.slice(to.ch), lastSpans, estimateHeight));\n        update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n        doc.insert(from.line + 1, added$1);\n      }\n    } else if (text.length == 1) {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0] + lastLine.text.slice(to.ch), spansFor(0));\n      doc.remove(from.line + 1, nlines);\n    } else {\n      update(firstLine, firstLine.text.slice(0, from.ch) + text[0], spansFor(0));\n      update(lastLine, lastText + lastLine.text.slice(to.ch), lastSpans);\n      var added$2 = linesFor(1, text.length - 1);\n      if (nlines > 1) { doc.remove(from.line + 1, nlines - 1); }\n      doc.insert(from.line + 1, added$2);\n    }\n\n    signalLater(doc, \"change\", doc, change);\n  }\n\n  // Call f for all linked documents.\n  function linkedDocs(doc, f, sharedHistOnly) {\n    function propagate(doc, skip, sharedHist) {\n      if (doc.linked) { for (var i = 0; i < doc.linked.length; ++i) {\n        var rel = doc.linked[i];\n        if (rel.doc == skip) { continue }\n        var shared = sharedHist && rel.sharedHist;\n        if (sharedHistOnly && !shared) { continue }\n        f(rel.doc, shared);\n        propagate(rel.doc, doc, shared);\n      } }\n    }\n    propagate(doc, null, true);\n  }\n\n  // Attach a document to an editor.\n  function attachDoc(cm, doc) {\n    if (doc.cm) { throw new Error(\"This document is already in use.\") }\n    cm.doc = doc;\n    doc.cm = cm;\n    estimateLineHeights(cm);\n    loadMode(cm);\n    setDirectionClass(cm);\n    if (!cm.options.lineWrapping) { findMaxLine(cm); }\n    cm.options.mode = doc.modeOption;\n    regChange(cm);\n  }\n\n  function setDirectionClass(cm) {\n  (cm.doc.direction == \"rtl\" ? addClass : rmClass)(cm.display.lineDiv, \"CodeMirror-rtl\");\n  }\n\n  function directionChanged(cm) {\n    runInOp(cm, function () {\n      setDirectionClass(cm);\n      regChange(cm);\n    });\n  }\n\n  function History(startGen) {\n    // Arrays of change events and selections. Doing something adds an\n    // event to done and clears undo. Undoing moves events from done\n    // to undone, redoing moves them in the other direction.\n    this.done = []; this.undone = [];\n    this.undoDepth = Infinity;\n    // Used to track when changes can be merged into a single undo\n    // event\n    this.lastModTime = this.lastSelTime = 0;\n    this.lastOp = this.lastSelOp = null;\n    this.lastOrigin = this.lastSelOrigin = null;\n    // Used by the isClean() method\n    this.generation = this.maxGeneration = startGen || 1;\n  }\n\n  // Create a history change event from an updateDoc-style change\n  // object.\n  function historyChangeFromChange(doc, change) {\n    var histChange = {from: copyPos(change.from), to: changeEnd(change), text: getBetween(doc, change.from, change.to)};\n    attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1);\n    linkedDocs(doc, function (doc) { return attachLocalSpans(doc, histChange, change.from.line, change.to.line + 1); }, true);\n    return histChange\n  }\n\n  // Pop all selection events off the end of a history array. Stop at\n  // a change event.\n  function clearSelectionEvents(array) {\n    while (array.length) {\n      var last = lst(array);\n      if (last.ranges) { array.pop(); }\n      else { break }\n    }\n  }\n\n  // Find the top change event in the history. Pop off selection\n  // events that are in the way.\n  function lastChangeEvent(hist, force) {\n    if (force) {\n      clearSelectionEvents(hist.done);\n      return lst(hist.done)\n    } else if (hist.done.length && !lst(hist.done).ranges) {\n      return lst(hist.done)\n    } else if (hist.done.length > 1 && !hist.done[hist.done.length - 2].ranges) {\n      hist.done.pop();\n      return lst(hist.done)\n    }\n  }\n\n  // Register a change in the history. Merges changes that are within\n  // a single operation, or are close together with an origin that\n  // allows merging (starting with \"+\") into a single event.\n  function addChangeToHistory(doc, change, selAfter, opId) {\n    var hist = doc.history;\n    hist.undone.length = 0;\n    var time = +new Date, cur;\n    var last;\n\n    if ((hist.lastOp == opId ||\n         hist.lastOrigin == change.origin && change.origin &&\n         ((change.origin.charAt(0) == \"+\" && hist.lastModTime > time - (doc.cm ? doc.cm.options.historyEventDelay : 500)) ||\n          change.origin.charAt(0) == \"*\")) &&\n        (cur = lastChangeEvent(hist, hist.lastOp == opId))) {\n      // Merge this change into the last event\n      last = lst(cur.changes);\n      if (cmp(change.from, change.to) == 0 && cmp(change.from, last.to) == 0) {\n        // Optimized case for simple insertion -- don't want to add\n        // new changesets for every character typed\n        last.to = changeEnd(change);\n      } else {\n        // Add new sub-event\n        cur.changes.push(historyChangeFromChange(doc, change));\n      }\n    } else {\n      // Can not be merged, start a new event.\n      var before = lst(hist.done);\n      if (!before || !before.ranges)\n        { pushSelectionToHistory(doc.sel, hist.done); }\n      cur = {changes: [historyChangeFromChange(doc, change)],\n             generation: hist.generation};\n      hist.done.push(cur);\n      while (hist.done.length > hist.undoDepth) {\n        hist.done.shift();\n        if (!hist.done[0].ranges) { hist.done.shift(); }\n      }\n    }\n    hist.done.push(selAfter);\n    hist.generation = ++hist.maxGeneration;\n    hist.lastModTime = hist.lastSelTime = time;\n    hist.lastOp = hist.lastSelOp = opId;\n    hist.lastOrigin = hist.lastSelOrigin = change.origin;\n\n    if (!last) { signal(doc, \"historyAdded\"); }\n  }\n\n  function selectionEventCanBeMerged(doc, origin, prev, sel) {\n    var ch = origin.charAt(0);\n    return ch == \"*\" ||\n      ch == \"+\" &&\n      prev.ranges.length == sel.ranges.length &&\n      prev.somethingSelected() == sel.somethingSelected() &&\n      new Date - doc.history.lastSelTime <= (doc.cm ? doc.cm.options.historyEventDelay : 500)\n  }\n\n  // Called whenever the selection changes, sets the new selection as\n  // the pending selection in the history, and pushes the old pending\n  // selection into the 'done' array when it was significantly\n  // different (in number of selected ranges, emptiness, or time).\n  function addSelectionToHistory(doc, sel, opId, options) {\n    var hist = doc.history, origin = options && options.origin;\n\n    // A new event is started when the previous origin does not match\n    // the current, or the origins don't allow matching. Origins\n    // starting with * are always merged, those starting with + are\n    // merged when similar and close together in time.\n    if (opId == hist.lastSelOp ||\n        (origin && hist.lastSelOrigin == origin &&\n         (hist.lastModTime == hist.lastSelTime && hist.lastOrigin == origin ||\n          selectionEventCanBeMerged(doc, origin, lst(hist.done), sel))))\n      { hist.done[hist.done.length - 1] = sel; }\n    else\n      { pushSelectionToHistory(sel, hist.done); }\n\n    hist.lastSelTime = +new Date;\n    hist.lastSelOrigin = origin;\n    hist.lastSelOp = opId;\n    if (options && options.clearRedo !== false)\n      { clearSelectionEvents(hist.undone); }\n  }\n\n  function pushSelectionToHistory(sel, dest) {\n    var top = lst(dest);\n    if (!(top && top.ranges && top.equals(sel)))\n      { dest.push(sel); }\n  }\n\n  // Used to store marked span information in the history.\n  function attachLocalSpans(doc, change, from, to) {\n    var existing = change[\"spans_\" + doc.id], n = 0;\n    doc.iter(Math.max(doc.first, from), Math.min(doc.first + doc.size, to), function (line) {\n      if (line.markedSpans)\n        { (existing || (existing = change[\"spans_\" + doc.id] = {}))[n] = line.markedSpans; }\n      ++n;\n    });\n  }\n\n  // When un/re-doing restores text containing marked spans, those\n  // that have been explicitly cleared should not be restored.\n  function removeClearedSpans(spans) {\n    if (!spans) { return null }\n    var out;\n    for (var i = 0; i < spans.length; ++i) {\n      if (spans[i].marker.explicitlyCleared) { if (!out) { out = spans.slice(0, i); } }\n      else if (out) { out.push(spans[i]); }\n    }\n    return !out ? spans : out.length ? out : null\n  }\n\n  // Retrieve and filter the old marked spans stored in a change event.\n  function getOldSpans(doc, change) {\n    var found = change[\"spans_\" + doc.id];\n    if (!found) { return null }\n    var nw = [];\n    for (var i = 0; i < change.text.length; ++i)\n      { nw.push(removeClearedSpans(found[i])); }\n    return nw\n  }\n\n  // Used for un/re-doing changes from the history. Combines the\n  // result of computing the existing spans with the set of spans that\n  // existed in the history (so that deleting around a span and then\n  // undoing brings back the span).\n  function mergeOldSpans(doc, change) {\n    var old = getOldSpans(doc, change);\n    var stretched = stretchSpansOverChange(doc, change);\n    if (!old) { return stretched }\n    if (!stretched) { return old }\n\n    for (var i = 0; i < old.length; ++i) {\n      var oldCur = old[i], stretchCur = stretched[i];\n      if (oldCur && stretchCur) {\n        spans: for (var j = 0; j < stretchCur.length; ++j) {\n          var span = stretchCur[j];\n          for (var k = 0; k < oldCur.length; ++k)\n            { if (oldCur[k].marker == span.marker) { continue spans } }\n          oldCur.push(span);\n        }\n      } else if (stretchCur) {\n        old[i] = stretchCur;\n      }\n    }\n    return old\n  }\n\n  // Used both to provide a JSON-safe object in .getHistory, and, when\n  // detaching a document, to split the history in two\n  function copyHistoryArray(events, newGroup, instantiateSel) {\n    var copy = [];\n    for (var i = 0; i < events.length; ++i) {\n      var event = events[i];\n      if (event.ranges) {\n        copy.push(instantiateSel ? Selection.prototype.deepCopy.call(event) : event);\n        continue\n      }\n      var changes = event.changes, newChanges = [];\n      copy.push({changes: newChanges});\n      for (var j = 0; j < changes.length; ++j) {\n        var change = changes[j], m = (void 0);\n        newChanges.push({from: change.from, to: change.to, text: change.text});\n        if (newGroup) { for (var prop in change) { if (m = prop.match(/^spans_(\\d+)$/)) {\n          if (indexOf(newGroup, Number(m[1])) > -1) {\n            lst(newChanges)[prop] = change[prop];\n            delete change[prop];\n          }\n        } } }\n      }\n    }\n    return copy\n  }\n\n  // The 'scroll' parameter given to many of these indicated whether\n  // the new cursor position should be scrolled into view after\n  // modifying the selection.\n\n  // If shift is held or the extend flag is set, extends a range to\n  // include a given position (and optionally a second position).\n  // Otherwise, simply returns the range between the given positions.\n  // Used for cursor motion and such.\n  function extendRange(range, head, other, extend) {\n    if (extend) {\n      var anchor = range.anchor;\n      if (other) {\n        var posBefore = cmp(head, anchor) < 0;\n        if (posBefore != (cmp(other, anchor) < 0)) {\n          anchor = head;\n          head = other;\n        } else if (posBefore != (cmp(head, other) < 0)) {\n          head = other;\n        }\n      }\n      return new Range(anchor, head)\n    } else {\n      return new Range(other || head, head)\n    }\n  }\n\n  // Extend the primary selection range, discard the rest.\n  function extendSelection(doc, head, other, options, extend) {\n    if (extend == null) { extend = doc.cm && (doc.cm.display.shift || doc.extend); }\n    setSelection(doc, new Selection([extendRange(doc.sel.primary(), head, other, extend)], 0), options);\n  }\n\n  // Extend all selections (pos is an array of selections with length\n  // equal the number of selections)\n  function extendSelections(doc, heads, options) {\n    var out = [];\n    var extend = doc.cm && (doc.cm.display.shift || doc.extend);\n    for (var i = 0; i < doc.sel.ranges.length; i++)\n      { out[i] = extendRange(doc.sel.ranges[i], heads[i], null, extend); }\n    var newSel = normalizeSelection(doc.cm, out, doc.sel.primIndex);\n    setSelection(doc, newSel, options);\n  }\n\n  // Updates a single range in the selection.\n  function replaceOneSelection(doc, i, range, options) {\n    var ranges = doc.sel.ranges.slice(0);\n    ranges[i] = range;\n    setSelection(doc, normalizeSelection(doc.cm, ranges, doc.sel.primIndex), options);\n  }\n\n  // Reset the selection to a single range.\n  function setSimpleSelection(doc, anchor, head, options) {\n    setSelection(doc, simpleSelection(anchor, head), options);\n  }\n\n  // Give beforeSelectionChange handlers a change to influence a\n  // selection update.\n  function filterSelectionChange(doc, sel, options) {\n    var obj = {\n      ranges: sel.ranges,\n      update: function(ranges) {\n        this.ranges = [];\n        for (var i = 0; i < ranges.length; i++)\n          { this.ranges[i] = new Range(clipPos(doc, ranges[i].anchor),\n                                     clipPos(doc, ranges[i].head)); }\n      },\n      origin: options && options.origin\n    };\n    signal(doc, \"beforeSelectionChange\", doc, obj);\n    if (doc.cm) { signal(doc.cm, \"beforeSelectionChange\", doc.cm, obj); }\n    if (obj.ranges != sel.ranges) { return normalizeSelection(doc.cm, obj.ranges, obj.ranges.length - 1) }\n    else { return sel }\n  }\n\n  function setSelectionReplaceHistory(doc, sel, options) {\n    var done = doc.history.done, last = lst(done);\n    if (last && last.ranges) {\n      done[done.length - 1] = sel;\n      setSelectionNoUndo(doc, sel, options);\n    } else {\n      setSelection(doc, sel, options);\n    }\n  }\n\n  // Set a new selection.\n  function setSelection(doc, sel, options) {\n    setSelectionNoUndo(doc, sel, options);\n    addSelectionToHistory(doc, doc.sel, doc.cm ? doc.cm.curOp.id : NaN, options);\n  }\n\n  function setSelectionNoUndo(doc, sel, options) {\n    if (hasHandler(doc, \"beforeSelectionChange\") || doc.cm && hasHandler(doc.cm, \"beforeSelectionChange\"))\n      { sel = filterSelectionChange(doc, sel, options); }\n\n    var bias = options && options.bias ||\n      (cmp(sel.primary().head, doc.sel.primary().head) < 0 ? -1 : 1);\n    setSelectionInner(doc, skipAtomicInSelection(doc, sel, bias, true));\n\n    if (!(options && options.scroll === false) && doc.cm)\n      { ensureCursorVisible(doc.cm); }\n  }\n\n  function setSelectionInner(doc, sel) {\n    if (sel.equals(doc.sel)) { return }\n\n    doc.sel = sel;\n\n    if (doc.cm) {\n      doc.cm.curOp.updateInput = 1;\n      doc.cm.curOp.selectionChanged = true;\n      signalCursorActivity(doc.cm);\n    }\n    signalLater(doc, \"cursorActivity\", doc);\n  }\n\n  // Verify that the selection does not partially select any atomic\n  // marked ranges.\n  function reCheckSelection(doc) {\n    setSelectionInner(doc, skipAtomicInSelection(doc, doc.sel, null, false));\n  }\n\n  // Return a selection that does not partially select any atomic\n  // ranges.\n  function skipAtomicInSelection(doc, sel, bias, mayClear) {\n    var out;\n    for (var i = 0; i < sel.ranges.length; i++) {\n      var range = sel.ranges[i];\n      var old = sel.ranges.length == doc.sel.ranges.length && doc.sel.ranges[i];\n      var newAnchor = skipAtomic(doc, range.anchor, old && old.anchor, bias, mayClear);\n      var newHead = skipAtomic(doc, range.head, old && old.head, bias, mayClear);\n      if (out || newAnchor != range.anchor || newHead != range.head) {\n        if (!out) { out = sel.ranges.slice(0, i); }\n        out[i] = new Range(newAnchor, newHead);\n      }\n    }\n    return out ? normalizeSelection(doc.cm, out, sel.primIndex) : sel\n  }\n\n  function skipAtomicInner(doc, pos, oldPos, dir, mayClear) {\n    var line = getLine(doc, pos.line);\n    if (line.markedSpans) { for (var i = 0; i < line.markedSpans.length; ++i) {\n      var sp = line.markedSpans[i], m = sp.marker;\n\n      // Determine if we should prevent the cursor being placed to the left/right of an atomic marker\n      // Historically this was determined using the inclusiveLeft/Right option, but the new way to control it\n      // is with selectLeft/Right\n      var preventCursorLeft = (\"selectLeft\" in m) ? !m.selectLeft : m.inclusiveLeft;\n      var preventCursorRight = (\"selectRight\" in m) ? !m.selectRight : m.inclusiveRight;\n\n      if ((sp.from == null || (preventCursorLeft ? sp.from <= pos.ch : sp.from < pos.ch)) &&\n          (sp.to == null || (preventCursorRight ? sp.to >= pos.ch : sp.to > pos.ch))) {\n        if (mayClear) {\n          signal(m, \"beforeCursorEnter\");\n          if (m.explicitlyCleared) {\n            if (!line.markedSpans) { break }\n            else {--i; continue}\n          }\n        }\n        if (!m.atomic) { continue }\n\n        if (oldPos) {\n          var near = m.find(dir < 0 ? 1 : -1), diff = (void 0);\n          if (dir < 0 ? preventCursorRight : preventCursorLeft)\n            { near = movePos(doc, near, -dir, near && near.line == pos.line ? line : null); }\n          if (near && near.line == pos.line && (diff = cmp(near, oldPos)) && (dir < 0 ? diff < 0 : diff > 0))\n            { return skipAtomicInner(doc, near, pos, dir, mayClear) }\n        }\n\n        var far = m.find(dir < 0 ? -1 : 1);\n        if (dir < 0 ? preventCursorLeft : preventCursorRight)\n          { far = movePos(doc, far, dir, far.line == pos.line ? line : null); }\n        return far ? skipAtomicInner(doc, far, pos, dir, mayClear) : null\n      }\n    } }\n    return pos\n  }\n\n  // Ensure a given position is not inside an atomic range.\n  function skipAtomic(doc, pos, oldPos, bias, mayClear) {\n    var dir = bias || 1;\n    var found = skipAtomicInner(doc, pos, oldPos, dir, mayClear) ||\n        (!mayClear && skipAtomicInner(doc, pos, oldPos, dir, true)) ||\n        skipAtomicInner(doc, pos, oldPos, -dir, mayClear) ||\n        (!mayClear && skipAtomicInner(doc, pos, oldPos, -dir, true));\n    if (!found) {\n      doc.cantEdit = true;\n      return Pos(doc.first, 0)\n    }\n    return found\n  }\n\n  function movePos(doc, pos, dir, line) {\n    if (dir < 0 && pos.ch == 0) {\n      if (pos.line > doc.first) { return clipPos(doc, Pos(pos.line - 1)) }\n      else { return null }\n    } else if (dir > 0 && pos.ch == (line || getLine(doc, pos.line)).text.length) {\n      if (pos.line < doc.first + doc.size - 1) { return Pos(pos.line + 1, 0) }\n      else { return null }\n    } else {\n      return new Pos(pos.line, pos.ch + dir)\n    }\n  }\n\n  function selectAll(cm) {\n    cm.setSelection(Pos(cm.firstLine(), 0), Pos(cm.lastLine()), sel_dontScroll);\n  }\n\n  // UPDATING\n\n  // Allow \"beforeChange\" event handlers to influence a change\n  function filterChange(doc, change, update) {\n    var obj = {\n      canceled: false,\n      from: change.from,\n      to: change.to,\n      text: change.text,\n      origin: change.origin,\n      cancel: function () { return obj.canceled = true; }\n    };\n    if (update) { obj.update = function (from, to, text, origin) {\n      if (from) { obj.from = clipPos(doc, from); }\n      if (to) { obj.to = clipPos(doc, to); }\n      if (text) { obj.text = text; }\n      if (origin !== undefined) { obj.origin = origin; }\n    }; }\n    signal(doc, \"beforeChange\", doc, obj);\n    if (doc.cm) { signal(doc.cm, \"beforeChange\", doc.cm, obj); }\n\n    if (obj.canceled) {\n      if (doc.cm) { doc.cm.curOp.updateInput = 2; }\n      return null\n    }\n    return {from: obj.from, to: obj.to, text: obj.text, origin: obj.origin}\n  }\n\n  // Apply a change to a document, and add it to the document's\n  // history, and propagating it to all linked documents.\n  function makeChange(doc, change, ignoreReadOnly) {\n    if (doc.cm) {\n      if (!doc.cm.curOp) { return operation(doc.cm, makeChange)(doc, change, ignoreReadOnly) }\n      if (doc.cm.state.suppressEdits) { return }\n    }\n\n    if (hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\")) {\n      change = filterChange(doc, change, true);\n      if (!change) { return }\n    }\n\n    // Possibly split or suppress the update based on the presence\n    // of read-only spans in its range.\n    var split = sawReadOnlySpans && !ignoreReadOnly && removeReadOnlyRanges(doc, change.from, change.to);\n    if (split) {\n      for (var i = split.length - 1; i >= 0; --i)\n        { makeChangeInner(doc, {from: split[i].from, to: split[i].to, text: i ? [\"\"] : change.text, origin: change.origin}); }\n    } else {\n      makeChangeInner(doc, change);\n    }\n  }\n\n  function makeChangeInner(doc, change) {\n    if (change.text.length == 1 && change.text[0] == \"\" && cmp(change.from, change.to) == 0) { return }\n    var selAfter = computeSelAfterChange(doc, change);\n    addChangeToHistory(doc, change, selAfter, doc.cm ? doc.cm.curOp.id : NaN);\n\n    makeChangeSingleDoc(doc, change, selAfter, stretchSpansOverChange(doc, change));\n    var rebased = [];\n\n    linkedDocs(doc, function (doc, sharedHist) {\n      if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n        rebaseHist(doc.history, change);\n        rebased.push(doc.history);\n      }\n      makeChangeSingleDoc(doc, change, null, stretchSpansOverChange(doc, change));\n    });\n  }\n\n  // Revert a change stored in a document's history.\n  function makeChangeFromHistory(doc, type, allowSelectionOnly) {\n    var suppress = doc.cm && doc.cm.state.suppressEdits;\n    if (suppress && !allowSelectionOnly) { return }\n\n    var hist = doc.history, event, selAfter = doc.sel;\n    var source = type == \"undo\" ? hist.done : hist.undone, dest = type == \"undo\" ? hist.undone : hist.done;\n\n    // Verify that there is a useable event (so that ctrl-z won't\n    // needlessly clear selection events)\n    var i = 0;\n    for (; i < source.length; i++) {\n      event = source[i];\n      if (allowSelectionOnly ? event.ranges && !event.equals(doc.sel) : !event.ranges)\n        { break }\n    }\n    if (i == source.length) { return }\n    hist.lastOrigin = hist.lastSelOrigin = null;\n\n    for (;;) {\n      event = source.pop();\n      if (event.ranges) {\n        pushSelectionToHistory(event, dest);\n        if (allowSelectionOnly && !event.equals(doc.sel)) {\n          setSelection(doc, event, {clearRedo: false});\n          return\n        }\n        selAfter = event;\n      } else if (suppress) {\n        source.push(event);\n        return\n      } else { break }\n    }\n\n    // Build up a reverse change object to add to the opposite history\n    // stack (redo when undoing, and vice versa).\n    var antiChanges = [];\n    pushSelectionToHistory(selAfter, dest);\n    dest.push({changes: antiChanges, generation: hist.generation});\n    hist.generation = event.generation || ++hist.maxGeneration;\n\n    var filter = hasHandler(doc, \"beforeChange\") || doc.cm && hasHandler(doc.cm, \"beforeChange\");\n\n    var loop = function ( i ) {\n      var change = event.changes[i];\n      change.origin = type;\n      if (filter && !filterChange(doc, change, false)) {\n        source.length = 0;\n        return {}\n      }\n\n      antiChanges.push(historyChangeFromChange(doc, change));\n\n      var after = i ? computeSelAfterChange(doc, change) : lst(source);\n      makeChangeSingleDoc(doc, change, after, mergeOldSpans(doc, change));\n      if (!i && doc.cm) { doc.cm.scrollIntoView({from: change.from, to: changeEnd(change)}); }\n      var rebased = [];\n\n      // Propagate to the linked documents\n      linkedDocs(doc, function (doc, sharedHist) {\n        if (!sharedHist && indexOf(rebased, doc.history) == -1) {\n          rebaseHist(doc.history, change);\n          rebased.push(doc.history);\n        }\n        makeChangeSingleDoc(doc, change, null, mergeOldSpans(doc, change));\n      });\n    };\n\n    for (var i$1 = event.changes.length - 1; i$1 >= 0; --i$1) {\n      var returned = loop( i$1 );\n\n      if ( returned ) return returned.v;\n    }\n  }\n\n  // Sub-views need their line numbers shifted when text is added\n  // above or below them in the parent document.\n  function shiftDoc(doc, distance) {\n    if (distance == 0) { return }\n    doc.first += distance;\n    doc.sel = new Selection(map(doc.sel.ranges, function (range) { return new Range(\n      Pos(range.anchor.line + distance, range.anchor.ch),\n      Pos(range.head.line + distance, range.head.ch)\n    ); }), doc.sel.primIndex);\n    if (doc.cm) {\n      regChange(doc.cm, doc.first, doc.first - distance, distance);\n      for (var d = doc.cm.display, l = d.viewFrom; l < d.viewTo; l++)\n        { regLineChange(doc.cm, l, \"gutter\"); }\n    }\n  }\n\n  // More lower-level change function, handling only a single document\n  // (not linked ones).\n  function makeChangeSingleDoc(doc, change, selAfter, spans) {\n    if (doc.cm && !doc.cm.curOp)\n      { return operation(doc.cm, makeChangeSingleDoc)(doc, change, selAfter, spans) }\n\n    if (change.to.line < doc.first) {\n      shiftDoc(doc, change.text.length - 1 - (change.to.line - change.from.line));\n      return\n    }\n    if (change.from.line > doc.lastLine()) { return }\n\n    // Clip the change to the size of this doc\n    if (change.from.line < doc.first) {\n      var shift = change.text.length - 1 - (doc.first - change.from.line);\n      shiftDoc(doc, shift);\n      change = {from: Pos(doc.first, 0), to: Pos(change.to.line + shift, change.to.ch),\n                text: [lst(change.text)], origin: change.origin};\n    }\n    var last = doc.lastLine();\n    if (change.to.line > last) {\n      change = {from: change.from, to: Pos(last, getLine(doc, last).text.length),\n                text: [change.text[0]], origin: change.origin};\n    }\n\n    change.removed = getBetween(doc, change.from, change.to);\n\n    if (!selAfter) { selAfter = computeSelAfterChange(doc, change); }\n    if (doc.cm) { makeChangeSingleDocInEditor(doc.cm, change, spans); }\n    else { updateDoc(doc, change, spans); }\n    setSelectionNoUndo(doc, selAfter, sel_dontScroll);\n\n    if (doc.cantEdit && skipAtomic(doc, Pos(doc.firstLine(), 0)))\n      { doc.cantEdit = false; }\n  }\n\n  // Handle the interaction of a change to a document with the editor\n  // that this document is part of.\n  function makeChangeSingleDocInEditor(cm, change, spans) {\n    var doc = cm.doc, display = cm.display, from = change.from, to = change.to;\n\n    var recomputeMaxLength = false, checkWidthStart = from.line;\n    if (!cm.options.lineWrapping) {\n      checkWidthStart = lineNo(visualLine(getLine(doc, from.line)));\n      doc.iter(checkWidthStart, to.line + 1, function (line) {\n        if (line == display.maxLine) {\n          recomputeMaxLength = true;\n          return true\n        }\n      });\n    }\n\n    if (doc.sel.contains(change.from, change.to) > -1)\n      { signalCursorActivity(cm); }\n\n    updateDoc(doc, change, spans, estimateHeight(cm));\n\n    if (!cm.options.lineWrapping) {\n      doc.iter(checkWidthStart, from.line + change.text.length, function (line) {\n        var len = lineLength(line);\n        if (len > display.maxLineLength) {\n          display.maxLine = line;\n          display.maxLineLength = len;\n          display.maxLineChanged = true;\n          recomputeMaxLength = false;\n        }\n      });\n      if (recomputeMaxLength) { cm.curOp.updateMaxLine = true; }\n    }\n\n    retreatFrontier(doc, from.line);\n    startWorker(cm, 400);\n\n    var lendiff = change.text.length - (to.line - from.line) - 1;\n    // Remember that these lines changed, for updating the display\n    if (change.full)\n      { regChange(cm); }\n    else if (from.line == to.line && change.text.length == 1 && !isWholeLineUpdate(cm.doc, change))\n      { regLineChange(cm, from.line, \"text\"); }\n    else\n      { regChange(cm, from.line, to.line + 1, lendiff); }\n\n    var changesHandler = hasHandler(cm, \"changes\"), changeHandler = hasHandler(cm, \"change\");\n    if (changeHandler || changesHandler) {\n      var obj = {\n        from: from, to: to,\n        text: change.text,\n        removed: change.removed,\n        origin: change.origin\n      };\n      if (changeHandler) { signalLater(cm, \"change\", cm, obj); }\n      if (changesHandler) { (cm.curOp.changeObjs || (cm.curOp.changeObjs = [])).push(obj); }\n    }\n    cm.display.selForContextMenu = null;\n  }\n\n  function replaceRange(doc, code, from, to, origin) {\n    var assign;\n\n    if (!to) { to = from; }\n    if (cmp(to, from) < 0) { (assign = [to, from], from = assign[0], to = assign[1]); }\n    if (typeof code == \"string\") { code = doc.splitLines(code); }\n    makeChange(doc, {from: from, to: to, text: code, origin: origin});\n  }\n\n  // Rebasing/resetting history to deal with externally-sourced changes\n\n  function rebaseHistSelSingle(pos, from, to, diff) {\n    if (to < pos.line) {\n      pos.line += diff;\n    } else if (from < pos.line) {\n      pos.line = from;\n      pos.ch = 0;\n    }\n  }\n\n  // Tries to rebase an array of history events given a change in the\n  // document. If the change touches the same lines as the event, the\n  // event, and everything 'behind' it, is discarded. If the change is\n  // before the event, the event's positions are updated. Uses a\n  // copy-on-write scheme for the positions, to avoid having to\n  // reallocate them all on every rebase, but also avoid problems with\n  // shared position objects being unsafely updated.\n  function rebaseHistArray(array, from, to, diff) {\n    for (var i = 0; i < array.length; ++i) {\n      var sub = array[i], ok = true;\n      if (sub.ranges) {\n        if (!sub.copied) { sub = array[i] = sub.deepCopy(); sub.copied = true; }\n        for (var j = 0; j < sub.ranges.length; j++) {\n          rebaseHistSelSingle(sub.ranges[j].anchor, from, to, diff);\n          rebaseHistSelSingle(sub.ranges[j].head, from, to, diff);\n        }\n        continue\n      }\n      for (var j$1 = 0; j$1 < sub.changes.length; ++j$1) {\n        var cur = sub.changes[j$1];\n        if (to < cur.from.line) {\n          cur.from = Pos(cur.from.line + diff, cur.from.ch);\n          cur.to = Pos(cur.to.line + diff, cur.to.ch);\n        } else if (from <= cur.to.line) {\n          ok = false;\n          break\n        }\n      }\n      if (!ok) {\n        array.splice(0, i + 1);\n        i = 0;\n      }\n    }\n  }\n\n  function rebaseHist(hist, change) {\n    var from = change.from.line, to = change.to.line, diff = change.text.length - (to - from) - 1;\n    rebaseHistArray(hist.done, from, to, diff);\n    rebaseHistArray(hist.undone, from, to, diff);\n  }\n\n  // Utility for applying a change to a line by handle or number,\n  // returning the number and optionally registering the line as\n  // changed.\n  function changeLine(doc, handle, changeType, op) {\n    var no = handle, line = handle;\n    if (typeof handle == \"number\") { line = getLine(doc, clipLine(doc, handle)); }\n    else { no = lineNo(handle); }\n    if (no == null) { return null }\n    if (op(line, no) && doc.cm) { regLineChange(doc.cm, no, changeType); }\n    return line\n  }\n\n  // The document is represented as a BTree consisting of leaves, with\n  // chunk of lines in them, and branches, with up to ten leaves or\n  // other branch nodes below them. The top node is always a branch\n  // node, and is the document object itself (meaning it has\n  // additional methods and properties).\n  //\n  // All nodes have parent links. The tree is used both to go from\n  // line numbers to line objects, and to go from objects to numbers.\n  // It also indexes by height, and is used to convert between height\n  // and line object, and to find the total height of the document.\n  //\n  // See also http://marijnhaverbeke.nl/blog/codemirror-line-tree.html\n\n  function LeafChunk(lines) {\n    this.lines = lines;\n    this.parent = null;\n    var height = 0;\n    for (var i = 0; i < lines.length; ++i) {\n      lines[i].parent = this;\n      height += lines[i].height;\n    }\n    this.height = height;\n  }\n\n  LeafChunk.prototype = {\n    chunkSize: function() { return this.lines.length },\n\n    // Remove the n lines at offset 'at'.\n    removeInner: function(at, n) {\n      for (var i = at, e = at + n; i < e; ++i) {\n        var line = this.lines[i];\n        this.height -= line.height;\n        cleanUpLine(line);\n        signalLater(line, \"delete\");\n      }\n      this.lines.splice(at, n);\n    },\n\n    // Helper used to collapse a small branch into a single leaf.\n    collapse: function(lines) {\n      lines.push.apply(lines, this.lines);\n    },\n\n    // Insert the given array of lines at offset 'at', count them as\n    // having the given height.\n    insertInner: function(at, lines, height) {\n      this.height += height;\n      this.lines = this.lines.slice(0, at).concat(lines).concat(this.lines.slice(at));\n      for (var i = 0; i < lines.length; ++i) { lines[i].parent = this; }\n    },\n\n    // Used to iterate over a part of the tree.\n    iterN: function(at, n, op) {\n      for (var e = at + n; at < e; ++at)\n        { if (op(this.lines[at])) { return true } }\n    }\n  };\n\n  function BranchChunk(children) {\n    this.children = children;\n    var size = 0, height = 0;\n    for (var i = 0; i < children.length; ++i) {\n      var ch = children[i];\n      size += ch.chunkSize(); height += ch.height;\n      ch.parent = this;\n    }\n    this.size = size;\n    this.height = height;\n    this.parent = null;\n  }\n\n  BranchChunk.prototype = {\n    chunkSize: function() { return this.size },\n\n    removeInner: function(at, n) {\n      this.size -= n;\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var rm = Math.min(n, sz - at), oldHeight = child.height;\n          child.removeInner(at, rm);\n          this.height -= oldHeight - child.height;\n          if (sz == rm) { this.children.splice(i--, 1); child.parent = null; }\n          if ((n -= rm) == 0) { break }\n          at = 0;\n        } else { at -= sz; }\n      }\n      // If the result is smaller than 25 lines, ensure that it is a\n      // single leaf node.\n      if (this.size - n < 25 &&\n          (this.children.length > 1 || !(this.children[0] instanceof LeafChunk))) {\n        var lines = [];\n        this.collapse(lines);\n        this.children = [new LeafChunk(lines)];\n        this.children[0].parent = this;\n      }\n    },\n\n    collapse: function(lines) {\n      for (var i = 0; i < this.children.length; ++i) { this.children[i].collapse(lines); }\n    },\n\n    insertInner: function(at, lines, height) {\n      this.size += lines.length;\n      this.height += height;\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at <= sz) {\n          child.insertInner(at, lines, height);\n          if (child.lines && child.lines.length > 50) {\n            // To avoid memory thrashing when child.lines is huge (e.g. first view of a large file), it's never spliced.\n            // Instead, small slices are taken. They're taken in order because sequential memory accesses are fastest.\n            var remaining = child.lines.length % 25 + 25;\n            for (var pos = remaining; pos < child.lines.length;) {\n              var leaf = new LeafChunk(child.lines.slice(pos, pos += 25));\n              child.height -= leaf.height;\n              this.children.splice(++i, 0, leaf);\n              leaf.parent = this;\n            }\n            child.lines = child.lines.slice(0, remaining);\n            this.maybeSpill();\n          }\n          break\n        }\n        at -= sz;\n      }\n    },\n\n    // When a node has grown, check whether it should be split.\n    maybeSpill: function() {\n      if (this.children.length <= 10) { return }\n      var me = this;\n      do {\n        var spilled = me.children.splice(me.children.length - 5, 5);\n        var sibling = new BranchChunk(spilled);\n        if (!me.parent) { // Become the parent node\n          var copy = new BranchChunk(me.children);\n          copy.parent = me;\n          me.children = [copy, sibling];\n          me = copy;\n       } else {\n          me.size -= sibling.size;\n          me.height -= sibling.height;\n          var myIndex = indexOf(me.parent.children, me);\n          me.parent.children.splice(myIndex + 1, 0, sibling);\n        }\n        sibling.parent = me.parent;\n      } while (me.children.length > 10)\n      me.parent.maybeSpill();\n    },\n\n    iterN: function(at, n, op) {\n      for (var i = 0; i < this.children.length; ++i) {\n        var child = this.children[i], sz = child.chunkSize();\n        if (at < sz) {\n          var used = Math.min(n, sz - at);\n          if (child.iterN(at, used, op)) { return true }\n          if ((n -= used) == 0) { break }\n          at = 0;\n        } else { at -= sz; }\n      }\n    }\n  };\n\n  // Line widgets are block elements displayed above or below a line.\n\n  var LineWidget = function(doc, node, options) {\n    if (options) { for (var opt in options) { if (options.hasOwnProperty(opt))\n      { this[opt] = options[opt]; } } }\n    this.doc = doc;\n    this.node = node;\n  };\n\n  LineWidget.prototype.clear = function () {\n    var cm = this.doc.cm, ws = this.line.widgets, line = this.line, no = lineNo(line);\n    if (no == null || !ws) { return }\n    for (var i = 0; i < ws.length; ++i) { if (ws[i] == this) { ws.splice(i--, 1); } }\n    if (!ws.length) { line.widgets = null; }\n    var height = widgetHeight(this);\n    updateLineHeight(line, Math.max(0, line.height - height));\n    if (cm) {\n      runInOp(cm, function () {\n        adjustScrollWhenAboveVisible(cm, line, -height);\n        regLineChange(cm, no, \"widget\");\n      });\n      signalLater(cm, \"lineWidgetCleared\", cm, this, no);\n    }\n  };\n\n  LineWidget.prototype.changed = function () {\n      var this$1 = this;\n\n    var oldH = this.height, cm = this.doc.cm, line = this.line;\n    this.height = null;\n    var diff = widgetHeight(this) - oldH;\n    if (!diff) { return }\n    if (!lineIsHidden(this.doc, line)) { updateLineHeight(line, line.height + diff); }\n    if (cm) {\n      runInOp(cm, function () {\n        cm.curOp.forceUpdate = true;\n        adjustScrollWhenAboveVisible(cm, line, diff);\n        signalLater(cm, \"lineWidgetChanged\", cm, this$1, lineNo(line));\n      });\n    }\n  };\n  eventMixin(LineWidget);\n\n  function adjustScrollWhenAboveVisible(cm, line, diff) {\n    if (heightAtLine(line) < ((cm.curOp && cm.curOp.scrollTop) || cm.doc.scrollTop))\n      { addToScrollTop(cm, diff); }\n  }\n\n  function addLineWidget(doc, handle, node, options) {\n    var widget = new LineWidget(doc, node, options);\n    var cm = doc.cm;\n    if (cm && widget.noHScroll) { cm.display.alignWidgets = true; }\n    changeLine(doc, handle, \"widget\", function (line) {\n      var widgets = line.widgets || (line.widgets = []);\n      if (widget.insertAt == null) { widgets.push(widget); }\n      else { widgets.splice(Math.min(widgets.length - 1, Math.max(0, widget.insertAt)), 0, widget); }\n      widget.line = line;\n      if (cm && !lineIsHidden(doc, line)) {\n        var aboveVisible = heightAtLine(line) < doc.scrollTop;\n        updateLineHeight(line, line.height + widgetHeight(widget));\n        if (aboveVisible) { addToScrollTop(cm, widget.height); }\n        cm.curOp.forceUpdate = true;\n      }\n      return true\n    });\n    if (cm) { signalLater(cm, \"lineWidgetAdded\", cm, widget, typeof handle == \"number\" ? handle : lineNo(handle)); }\n    return widget\n  }\n\n  // TEXTMARKERS\n\n  // Created with markText and setBookmark methods. A TextMarker is a\n  // handle that can be used to clear or find a marked position in the\n  // document. Line objects hold arrays (markedSpans) containing\n  // {from, to, marker} object pointing to such marker objects, and\n  // indicating that such a marker is present on that line. Multiple\n  // lines may point to the same marker when it spans across lines.\n  // The spans will have null for their from/to properties when the\n  // marker continues beyond the start/end of the line. Markers have\n  // links back to the lines they currently touch.\n\n  // Collapsed markers have unique ids, in order to be able to order\n  // them, which is needed for uniquely determining an outer marker\n  // when they overlap (they may nest, but not partially overlap).\n  var nextMarkerId = 0;\n\n  var TextMarker = function(doc, type) {\n    this.lines = [];\n    this.type = type;\n    this.doc = doc;\n    this.id = ++nextMarkerId;\n  };\n\n  // Clear the marker.\n  TextMarker.prototype.clear = function () {\n    if (this.explicitlyCleared) { return }\n    var cm = this.doc.cm, withOp = cm && !cm.curOp;\n    if (withOp) { startOperation(cm); }\n    if (hasHandler(this, \"clear\")) {\n      var found = this.find();\n      if (found) { signalLater(this, \"clear\", found.from, found.to); }\n    }\n    var min = null, max = null;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this);\n      if (cm && !this.collapsed) { regLineChange(cm, lineNo(line), \"text\"); }\n      else if (cm) {\n        if (span.to != null) { max = lineNo(line); }\n        if (span.from != null) { min = lineNo(line); }\n      }\n      line.markedSpans = removeMarkedSpan(line.markedSpans, span);\n      if (span.from == null && this.collapsed && !lineIsHidden(this.doc, line) && cm)\n        { updateLineHeight(line, textHeight(cm.display)); }\n    }\n    if (cm && this.collapsed && !cm.options.lineWrapping) { for (var i$1 = 0; i$1 < this.lines.length; ++i$1) {\n      var visual = visualLine(this.lines[i$1]), len = lineLength(visual);\n      if (len > cm.display.maxLineLength) {\n        cm.display.maxLine = visual;\n        cm.display.maxLineLength = len;\n        cm.display.maxLineChanged = true;\n      }\n    } }\n\n    if (min != null && cm && this.collapsed) { regChange(cm, min, max + 1); }\n    this.lines.length = 0;\n    this.explicitlyCleared = true;\n    if (this.atomic && this.doc.cantEdit) {\n      this.doc.cantEdit = false;\n      if (cm) { reCheckSelection(cm.doc); }\n    }\n    if (cm) { signalLater(cm, \"markerCleared\", cm, this, min, max); }\n    if (withOp) { endOperation(cm); }\n    if (this.parent) { this.parent.clear(); }\n  };\n\n  // Find the position of the marker in the document. Returns a {from,\n  // to} object by default. Side can be passed to get a specific side\n  // -- 0 (both), -1 (left), or 1 (right). When lineObj is true, the\n  // Pos objects returned contain a line object, rather than a line\n  // number (used to prevent looking up the same line twice).\n  TextMarker.prototype.find = function (side, lineObj) {\n    if (side == null && this.type == \"bookmark\") { side = 1; }\n    var from, to;\n    for (var i = 0; i < this.lines.length; ++i) {\n      var line = this.lines[i];\n      var span = getMarkedSpanFor(line.markedSpans, this);\n      if (span.from != null) {\n        from = Pos(lineObj ? line : lineNo(line), span.from);\n        if (side == -1) { return from }\n      }\n      if (span.to != null) {\n        to = Pos(lineObj ? line : lineNo(line), span.to);\n        if (side == 1) { return to }\n      }\n    }\n    return from && {from: from, to: to}\n  };\n\n  // Signals that the marker's widget changed, and surrounding layout\n  // should be recomputed.\n  TextMarker.prototype.changed = function () {\n      var this$1 = this;\n\n    var pos = this.find(-1, true), widget = this, cm = this.doc.cm;\n    if (!pos || !cm) { return }\n    runInOp(cm, function () {\n      var line = pos.line, lineN = lineNo(pos.line);\n      var view = findViewForLine(cm, lineN);\n      if (view) {\n        clearLineMeasurementCacheFor(view);\n        cm.curOp.selectionChanged = cm.curOp.forceUpdate = true;\n      }\n      cm.curOp.updateMaxLine = true;\n      if (!lineIsHidden(widget.doc, line) && widget.height != null) {\n        var oldHeight = widget.height;\n        widget.height = null;\n        var dHeight = widgetHeight(widget) - oldHeight;\n        if (dHeight)\n          { updateLineHeight(line, line.height + dHeight); }\n      }\n      signalLater(cm, \"markerChanged\", cm, this$1);\n    });\n  };\n\n  TextMarker.prototype.attachLine = function (line) {\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp;\n      if (!op.maybeHiddenMarkers || indexOf(op.maybeHiddenMarkers, this) == -1)\n        { (op.maybeUnhiddenMarkers || (op.maybeUnhiddenMarkers = [])).push(this); }\n    }\n    this.lines.push(line);\n  };\n\n  TextMarker.prototype.detachLine = function (line) {\n    this.lines.splice(indexOf(this.lines, line), 1);\n    if (!this.lines.length && this.doc.cm) {\n      var op = this.doc.cm.curOp\n      ;(op.maybeHiddenMarkers || (op.maybeHiddenMarkers = [])).push(this);\n    }\n  };\n  eventMixin(TextMarker);\n\n  // Create a marker, wire it up to the right lines, and\n  function markText(doc, from, to, options, type) {\n    // Shared markers (across linked documents) are handled separately\n    // (markTextShared will call out to this again, once per\n    // document).\n    if (options && options.shared) { return markTextShared(doc, from, to, options, type) }\n    // Ensure we are in an operation.\n    if (doc.cm && !doc.cm.curOp) { return operation(doc.cm, markText)(doc, from, to, options, type) }\n\n    var marker = new TextMarker(doc, type), diff = cmp(from, to);\n    if (options) { copyObj(options, marker, false); }\n    // Don't connect empty markers unless clearWhenEmpty is false\n    if (diff > 0 || diff == 0 && marker.clearWhenEmpty !== false)\n      { return marker }\n    if (marker.replacedWith) {\n      // Showing up as a widget implies collapsed (widget replaces text)\n      marker.collapsed = true;\n      marker.widgetNode = eltP(\"span\", [marker.replacedWith], \"CodeMirror-widget\");\n      if (!options.handleMouseEvents) { marker.widgetNode.setAttribute(\"cm-ignore-events\", \"true\"); }\n      if (options.insertLeft) { marker.widgetNode.insertLeft = true; }\n    }\n    if (marker.collapsed) {\n      if (conflictingCollapsedRange(doc, from.line, from, to, marker) ||\n          from.line != to.line && conflictingCollapsedRange(doc, to.line, from, to, marker))\n        { throw new Error(\"Inserting collapsed marker partially overlapping an existing one\") }\n      seeCollapsedSpans();\n    }\n\n    if (marker.addToHistory)\n      { addChangeToHistory(doc, {from: from, to: to, origin: \"markText\"}, doc.sel, NaN); }\n\n    var curLine = from.line, cm = doc.cm, updateMaxLine;\n    doc.iter(curLine, to.line + 1, function (line) {\n      if (cm && marker.collapsed && !cm.options.lineWrapping && visualLine(line) == cm.display.maxLine)\n        { updateMaxLine = true; }\n      if (marker.collapsed && curLine != from.line) { updateLineHeight(line, 0); }\n      addMarkedSpan(line, new MarkedSpan(marker,\n                                         curLine == from.line ? from.ch : null,\n                                         curLine == to.line ? to.ch : null));\n      ++curLine;\n    });\n    // lineIsHidden depends on the presence of the spans, so needs a second pass\n    if (marker.collapsed) { doc.iter(from.line, to.line + 1, function (line) {\n      if (lineIsHidden(doc, line)) { updateLineHeight(line, 0); }\n    }); }\n\n    if (marker.clearOnEnter) { on(marker, \"beforeCursorEnter\", function () { return marker.clear(); }); }\n\n    if (marker.readOnly) {\n      seeReadOnlySpans();\n      if (doc.history.done.length || doc.history.undone.length)\n        { doc.clearHistory(); }\n    }\n    if (marker.collapsed) {\n      marker.id = ++nextMarkerId;\n      marker.atomic = true;\n    }\n    if (cm) {\n      // Sync editor state\n      if (updateMaxLine) { cm.curOp.updateMaxLine = true; }\n      if (marker.collapsed)\n        { regChange(cm, from.line, to.line + 1); }\n      else if (marker.className || marker.startStyle || marker.endStyle || marker.css ||\n               marker.attributes || marker.title)\n        { for (var i = from.line; i <= to.line; i++) { regLineChange(cm, i, \"text\"); } }\n      if (marker.atomic) { reCheckSelection(cm.doc); }\n      signalLater(cm, \"markerAdded\", cm, marker);\n    }\n    return marker\n  }\n\n  // SHARED TEXTMARKERS\n\n  // A shared marker spans multiple linked documents. It is\n  // implemented as a meta-marker-object controlling multiple normal\n  // markers.\n  var SharedTextMarker = function(markers, primary) {\n    this.markers = markers;\n    this.primary = primary;\n    for (var i = 0; i < markers.length; ++i)\n      { markers[i].parent = this; }\n  };\n\n  SharedTextMarker.prototype.clear = function () {\n    if (this.explicitlyCleared) { return }\n    this.explicitlyCleared = true;\n    for (var i = 0; i < this.markers.length; ++i)\n      { this.markers[i].clear(); }\n    signalLater(this, \"clear\");\n  };\n\n  SharedTextMarker.prototype.find = function (side, lineObj) {\n    return this.primary.find(side, lineObj)\n  };\n  eventMixin(SharedTextMarker);\n\n  function markTextShared(doc, from, to, options, type) {\n    options = copyObj(options);\n    options.shared = false;\n    var markers = [markText(doc, from, to, options, type)], primary = markers[0];\n    var widget = options.widgetNode;\n    linkedDocs(doc, function (doc) {\n      if (widget) { options.widgetNode = widget.cloneNode(true); }\n      markers.push(markText(doc, clipPos(doc, from), clipPos(doc, to), options, type));\n      for (var i = 0; i < doc.linked.length; ++i)\n        { if (doc.linked[i].isParent) { return } }\n      primary = lst(markers);\n    });\n    return new SharedTextMarker(markers, primary)\n  }\n\n  function findSharedMarkers(doc) {\n    return doc.findMarks(Pos(doc.first, 0), doc.clipPos(Pos(doc.lastLine())), function (m) { return m.parent; })\n  }\n\n  function copySharedMarkers(doc, markers) {\n    for (var i = 0; i < markers.length; i++) {\n      var marker = markers[i], pos = marker.find();\n      var mFrom = doc.clipPos(pos.from), mTo = doc.clipPos(pos.to);\n      if (cmp(mFrom, mTo)) {\n        var subMark = markText(doc, mFrom, mTo, marker.primary, marker.primary.type);\n        marker.markers.push(subMark);\n        subMark.parent = marker;\n      }\n    }\n  }\n\n  function detachSharedMarkers(markers) {\n    var loop = function ( i ) {\n      var marker = markers[i], linked = [marker.primary.doc];\n      linkedDocs(marker.primary.doc, function (d) { return linked.push(d); });\n      for (var j = 0; j < marker.markers.length; j++) {\n        var subMarker = marker.markers[j];\n        if (indexOf(linked, subMarker.doc) == -1) {\n          subMarker.parent = null;\n          marker.markers.splice(j--, 1);\n        }\n      }\n    };\n\n    for (var i = 0; i < markers.length; i++) loop( i );\n  }\n\n  var nextDocId = 0;\n  var Doc = function(text, mode, firstLine, lineSep, direction) {\n    if (!(this instanceof Doc)) { return new Doc(text, mode, firstLine, lineSep, direction) }\n    if (firstLine == null) { firstLine = 0; }\n\n    BranchChunk.call(this, [new LeafChunk([new Line(\"\", null)])]);\n    this.first = firstLine;\n    this.scrollTop = this.scrollLeft = 0;\n    this.cantEdit = false;\n    this.cleanGeneration = 1;\n    this.modeFrontier = this.highlightFrontier = firstLine;\n    var start = Pos(firstLine, 0);\n    this.sel = simpleSelection(start);\n    this.history = new History(null);\n    this.id = ++nextDocId;\n    this.modeOption = mode;\n    this.lineSep = lineSep;\n    this.direction = (direction == \"rtl\") ? \"rtl\" : \"ltr\";\n    this.extend = false;\n\n    if (typeof text == \"string\") { text = this.splitLines(text); }\n    updateDoc(this, {from: start, to: start, text: text});\n    setSelection(this, simpleSelection(start), sel_dontScroll);\n  };\n\n  Doc.prototype = createObj(BranchChunk.prototype, {\n    constructor: Doc,\n    // Iterate over the document. Supports two forms -- with only one\n    // argument, it calls that for each line in the document. With\n    // three, it iterates over the range given by the first two (with\n    // the second being non-inclusive).\n    iter: function(from, to, op) {\n      if (op) { this.iterN(from - this.first, to - from, op); }\n      else { this.iterN(this.first, this.first + this.size, from); }\n    },\n\n    // Non-public interface for adding and removing lines.\n    insert: function(at, lines) {\n      var height = 0;\n      for (var i = 0; i < lines.length; ++i) { height += lines[i].height; }\n      this.insertInner(at - this.first, lines, height);\n    },\n    remove: function(at, n) { this.removeInner(at - this.first, n); },\n\n    // From here, the methods are part of the public interface. Most\n    // are also available from CodeMirror (editor) instances.\n\n    getValue: function(lineSep) {\n      var lines = getLines(this, this.first, this.first + this.size);\n      if (lineSep === false) { return lines }\n      return lines.join(lineSep || this.lineSeparator())\n    },\n    setValue: docMethodOp(function(code) {\n      var top = Pos(this.first, 0), last = this.first + this.size - 1;\n      makeChange(this, {from: top, to: Pos(last, getLine(this, last).text.length),\n                        text: this.splitLines(code), origin: \"setValue\", full: true}, true);\n      if (this.cm) { scrollToCoords(this.cm, 0, 0); }\n      setSelection(this, simpleSelection(top), sel_dontScroll);\n    }),\n    replaceRange: function(code, from, to, origin) {\n      from = clipPos(this, from);\n      to = to ? clipPos(this, to) : from;\n      replaceRange(this, code, from, to, origin);\n    },\n    getRange: function(from, to, lineSep) {\n      var lines = getBetween(this, clipPos(this, from), clipPos(this, to));\n      if (lineSep === false) { return lines }\n      return lines.join(lineSep || this.lineSeparator())\n    },\n\n    getLine: function(line) {var l = this.getLineHandle(line); return l && l.text},\n\n    getLineHandle: function(line) {if (isLine(this, line)) { return getLine(this, line) }},\n    getLineNumber: function(line) {return lineNo(line)},\n\n    getLineHandleVisualStart: function(line) {\n      if (typeof line == \"number\") { line = getLine(this, line); }\n      return visualLine(line)\n    },\n\n    lineCount: function() {return this.size},\n    firstLine: function() {return this.first},\n    lastLine: function() {return this.first + this.size - 1},\n\n    clipPos: function(pos) {return clipPos(this, pos)},\n\n    getCursor: function(start) {\n      var range = this.sel.primary(), pos;\n      if (start == null || start == \"head\") { pos = range.head; }\n      else if (start == \"anchor\") { pos = range.anchor; }\n      else if (start == \"end\" || start == \"to\" || start === false) { pos = range.to(); }\n      else { pos = range.from(); }\n      return pos\n    },\n    listSelections: function() { return this.sel.ranges },\n    somethingSelected: function() {return this.sel.somethingSelected()},\n\n    setCursor: docMethodOp(function(line, ch, options) {\n      setSimpleSelection(this, clipPos(this, typeof line == \"number\" ? Pos(line, ch || 0) : line), null, options);\n    }),\n    setSelection: docMethodOp(function(anchor, head, options) {\n      setSimpleSelection(this, clipPos(this, anchor), clipPos(this, head || anchor), options);\n    }),\n    extendSelection: docMethodOp(function(head, other, options) {\n      extendSelection(this, clipPos(this, head), other && clipPos(this, other), options);\n    }),\n    extendSelections: docMethodOp(function(heads, options) {\n      extendSelections(this, clipPosArray(this, heads), options);\n    }),\n    extendSelectionsBy: docMethodOp(function(f, options) {\n      var heads = map(this.sel.ranges, f);\n      extendSelections(this, clipPosArray(this, heads), options);\n    }),\n    setSelections: docMethodOp(function(ranges, primary, options) {\n      if (!ranges.length) { return }\n      var out = [];\n      for (var i = 0; i < ranges.length; i++)\n        { out[i] = new Range(clipPos(this, ranges[i].anchor),\n                           clipPos(this, ranges[i].head)); }\n      if (primary == null) { primary = Math.min(ranges.length - 1, this.sel.primIndex); }\n      setSelection(this, normalizeSelection(this.cm, out, primary), options);\n    }),\n    addSelection: docMethodOp(function(anchor, head, options) {\n      var ranges = this.sel.ranges.slice(0);\n      ranges.push(new Range(clipPos(this, anchor), clipPos(this, head || anchor)));\n      setSelection(this, normalizeSelection(this.cm, ranges, ranges.length - 1), options);\n    }),\n\n    getSelection: function(lineSep) {\n      var ranges = this.sel.ranges, lines;\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this, ranges[i].from(), ranges[i].to());\n        lines = lines ? lines.concat(sel) : sel;\n      }\n      if (lineSep === false) { return lines }\n      else { return lines.join(lineSep || this.lineSeparator()) }\n    },\n    getSelections: function(lineSep) {\n      var parts = [], ranges = this.sel.ranges;\n      for (var i = 0; i < ranges.length; i++) {\n        var sel = getBetween(this, ranges[i].from(), ranges[i].to());\n        if (lineSep !== false) { sel = sel.join(lineSep || this.lineSeparator()); }\n        parts[i] = sel;\n      }\n      return parts\n    },\n    replaceSelection: function(code, collapse, origin) {\n      var dup = [];\n      for (var i = 0; i < this.sel.ranges.length; i++)\n        { dup[i] = code; }\n      this.replaceSelections(dup, collapse, origin || \"+input\");\n    },\n    replaceSelections: docMethodOp(function(code, collapse, origin) {\n      var changes = [], sel = this.sel;\n      for (var i = 0; i < sel.ranges.length; i++) {\n        var range = sel.ranges[i];\n        changes[i] = {from: range.from(), to: range.to(), text: this.splitLines(code[i]), origin: origin};\n      }\n      var newSel = collapse && collapse != \"end\" && computeReplacedSel(this, changes, collapse);\n      for (var i$1 = changes.length - 1; i$1 >= 0; i$1--)\n        { makeChange(this, changes[i$1]); }\n      if (newSel) { setSelectionReplaceHistory(this, newSel); }\n      else if (this.cm) { ensureCursorVisible(this.cm); }\n    }),\n    undo: docMethodOp(function() {makeChangeFromHistory(this, \"undo\");}),\n    redo: docMethodOp(function() {makeChangeFromHistory(this, \"redo\");}),\n    undoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"undo\", true);}),\n    redoSelection: docMethodOp(function() {makeChangeFromHistory(this, \"redo\", true);}),\n\n    setExtending: function(val) {this.extend = val;},\n    getExtending: function() {return this.extend},\n\n    historySize: function() {\n      var hist = this.history, done = 0, undone = 0;\n      for (var i = 0; i < hist.done.length; i++) { if (!hist.done[i].ranges) { ++done; } }\n      for (var i$1 = 0; i$1 < hist.undone.length; i$1++) { if (!hist.undone[i$1].ranges) { ++undone; } }\n      return {undo: done, redo: undone}\n    },\n    clearHistory: function() {\n      var this$1 = this;\n\n      this.history = new History(this.history.maxGeneration);\n      linkedDocs(this, function (doc) { return doc.history = this$1.history; }, true);\n    },\n\n    markClean: function() {\n      this.cleanGeneration = this.changeGeneration(true);\n    },\n    changeGeneration: function(forceSplit) {\n      if (forceSplit)\n        { this.history.lastOp = this.history.lastSelOp = this.history.lastOrigin = null; }\n      return this.history.generation\n    },\n    isClean: function (gen) {\n      return this.history.generation == (gen || this.cleanGeneration)\n    },\n\n    getHistory: function() {\n      return {done: copyHistoryArray(this.history.done),\n              undone: copyHistoryArray(this.history.undone)}\n    },\n    setHistory: function(histData) {\n      var hist = this.history = new History(this.history.maxGeneration);\n      hist.done = copyHistoryArray(histData.done.slice(0), null, true);\n      hist.undone = copyHistoryArray(histData.undone.slice(0), null, true);\n    },\n\n    setGutterMarker: docMethodOp(function(line, gutterID, value) {\n      return changeLine(this, line, \"gutter\", function (line) {\n        var markers = line.gutterMarkers || (line.gutterMarkers = {});\n        markers[gutterID] = value;\n        if (!value && isEmpty(markers)) { line.gutterMarkers = null; }\n        return true\n      })\n    }),\n\n    clearGutter: docMethodOp(function(gutterID) {\n      var this$1 = this;\n\n      this.iter(function (line) {\n        if (line.gutterMarkers && line.gutterMarkers[gutterID]) {\n          changeLine(this$1, line, \"gutter\", function () {\n            line.gutterMarkers[gutterID] = null;\n            if (isEmpty(line.gutterMarkers)) { line.gutterMarkers = null; }\n            return true\n          });\n        }\n      });\n    }),\n\n    lineInfo: function(line) {\n      var n;\n      if (typeof line == \"number\") {\n        if (!isLine(this, line)) { return null }\n        n = line;\n        line = getLine(this, line);\n        if (!line) { return null }\n      } else {\n        n = lineNo(line);\n        if (n == null) { return null }\n      }\n      return {line: n, handle: line, text: line.text, gutterMarkers: line.gutterMarkers,\n              textClass: line.textClass, bgClass: line.bgClass, wrapClass: line.wrapClass,\n              widgets: line.widgets}\n    },\n\n    addLineClass: docMethodOp(function(handle, where, cls) {\n      return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n        var prop = where == \"text\" ? \"textClass\"\n                 : where == \"background\" ? \"bgClass\"\n                 : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n        if (!line[prop]) { line[prop] = cls; }\n        else if (classTest(cls).test(line[prop])) { return false }\n        else { line[prop] += \" \" + cls; }\n        return true\n      })\n    }),\n    removeLineClass: docMethodOp(function(handle, where, cls) {\n      return changeLine(this, handle, where == \"gutter\" ? \"gutter\" : \"class\", function (line) {\n        var prop = where == \"text\" ? \"textClass\"\n                 : where == \"background\" ? \"bgClass\"\n                 : where == \"gutter\" ? \"gutterClass\" : \"wrapClass\";\n        var cur = line[prop];\n        if (!cur) { return false }\n        else if (cls == null) { line[prop] = null; }\n        else {\n          var found = cur.match(classTest(cls));\n          if (!found) { return false }\n          var end = found.index + found[0].length;\n          line[prop] = cur.slice(0, found.index) + (!found.index || end == cur.length ? \"\" : \" \") + cur.slice(end) || null;\n        }\n        return true\n      })\n    }),\n\n    addLineWidget: docMethodOp(function(handle, node, options) {\n      return addLineWidget(this, handle, node, options)\n    }),\n    removeLineWidget: function(widget) { widget.clear(); },\n\n    markText: function(from, to, options) {\n      return markText(this, clipPos(this, from), clipPos(this, to), options, options && options.type || \"range\")\n    },\n    setBookmark: function(pos, options) {\n      var realOpts = {replacedWith: options && (options.nodeType == null ? options.widget : options),\n                      insertLeft: options && options.insertLeft,\n                      clearWhenEmpty: false, shared: options && options.shared,\n                      handleMouseEvents: options && options.handleMouseEvents};\n      pos = clipPos(this, pos);\n      return markText(this, pos, pos, realOpts, \"bookmark\")\n    },\n    findMarksAt: function(pos) {\n      pos = clipPos(this, pos);\n      var markers = [], spans = getLine(this, pos.line).markedSpans;\n      if (spans) { for (var i = 0; i < spans.length; ++i) {\n        var span = spans[i];\n        if ((span.from == null || span.from <= pos.ch) &&\n            (span.to == null || span.to >= pos.ch))\n          { markers.push(span.marker.parent || span.marker); }\n      } }\n      return markers\n    },\n    findMarks: function(from, to, filter) {\n      from = clipPos(this, from); to = clipPos(this, to);\n      var found = [], lineNo = from.line;\n      this.iter(from.line, to.line + 1, function (line) {\n        var spans = line.markedSpans;\n        if (spans) { for (var i = 0; i < spans.length; i++) {\n          var span = spans[i];\n          if (!(span.to != null && lineNo == from.line && from.ch >= span.to ||\n                span.from == null && lineNo != from.line ||\n                span.from != null && lineNo == to.line && span.from >= to.ch) &&\n              (!filter || filter(span.marker)))\n            { found.push(span.marker.parent || span.marker); }\n        } }\n        ++lineNo;\n      });\n      return found\n    },\n    getAllMarks: function() {\n      var markers = [];\n      this.iter(function (line) {\n        var sps = line.markedSpans;\n        if (sps) { for (var i = 0; i < sps.length; ++i)\n          { if (sps[i].from != null) { markers.push(sps[i].marker); } } }\n      });\n      return markers\n    },\n\n    posFromIndex: function(off) {\n      var ch, lineNo = this.first, sepSize = this.lineSeparator().length;\n      this.iter(function (line) {\n        var sz = line.text.length + sepSize;\n        if (sz > off) { ch = off; return true }\n        off -= sz;\n        ++lineNo;\n      });\n      return clipPos(this, Pos(lineNo, ch))\n    },\n    indexFromPos: function (coords) {\n      coords = clipPos(this, coords);\n      var index = coords.ch;\n      if (coords.line < this.first || coords.ch < 0) { return 0 }\n      var sepSize = this.lineSeparator().length;\n      this.iter(this.first, coords.line, function (line) { // iter aborts when callback returns a truthy value\n        index += line.text.length + sepSize;\n      });\n      return index\n    },\n\n    copy: function(copyHistory) {\n      var doc = new Doc(getLines(this, this.first, this.first + this.size),\n                        this.modeOption, this.first, this.lineSep, this.direction);\n      doc.scrollTop = this.scrollTop; doc.scrollLeft = this.scrollLeft;\n      doc.sel = this.sel;\n      doc.extend = false;\n      if (copyHistory) {\n        doc.history.undoDepth = this.history.undoDepth;\n        doc.setHistory(this.getHistory());\n      }\n      return doc\n    },\n\n    linkedDoc: function(options) {\n      if (!options) { options = {}; }\n      var from = this.first, to = this.first + this.size;\n      if (options.from != null && options.from > from) { from = options.from; }\n      if (options.to != null && options.to < to) { to = options.to; }\n      var copy = new Doc(getLines(this, from, to), options.mode || this.modeOption, from, this.lineSep, this.direction);\n      if (options.sharedHist) { copy.history = this.history\n      ; }(this.linked || (this.linked = [])).push({doc: copy, sharedHist: options.sharedHist});\n      copy.linked = [{doc: this, isParent: true, sharedHist: options.sharedHist}];\n      copySharedMarkers(copy, findSharedMarkers(this));\n      return copy\n    },\n    unlinkDoc: function(other) {\n      if (other instanceof CodeMirror) { other = other.doc; }\n      if (this.linked) { for (var i = 0; i < this.linked.length; ++i) {\n        var link = this.linked[i];\n        if (link.doc != other) { continue }\n        this.linked.splice(i, 1);\n        other.unlinkDoc(this);\n        detachSharedMarkers(findSharedMarkers(this));\n        break\n      } }\n      // If the histories were shared, split them again\n      if (other.history == this.history) {\n        var splitIds = [other.id];\n        linkedDocs(other, function (doc) { return splitIds.push(doc.id); }, true);\n        other.history = new History(null);\n        other.history.done = copyHistoryArray(this.history.done, splitIds);\n        other.history.undone = copyHistoryArray(this.history.undone, splitIds);\n      }\n    },\n    iterLinkedDocs: function(f) {linkedDocs(this, f);},\n\n    getMode: function() {return this.mode},\n    getEditor: function() {return this.cm},\n\n    splitLines: function(str) {\n      if (this.lineSep) { return str.split(this.lineSep) }\n      return splitLinesAuto(str)\n    },\n    lineSeparator: function() { return this.lineSep || \"\\n\" },\n\n    setDirection: docMethodOp(function (dir) {\n      if (dir != \"rtl\") { dir = \"ltr\"; }\n      if (dir == this.direction) { return }\n      this.direction = dir;\n      this.iter(function (line) { return line.order = null; });\n      if (this.cm) { directionChanged(this.cm); }\n    })\n  });\n\n  // Public alias.\n  Doc.prototype.eachLine = Doc.prototype.iter;\n\n  // Kludge to work around strange IE behavior where it'll sometimes\n  // re-fire a series of drag-related events right after the drop (#1551)\n  var lastDrop = 0;\n\n  function onDrop(e) {\n    var cm = this;\n    clearDragCursor(cm);\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e))\n      { return }\n    e_preventDefault(e);\n    if (ie) { lastDrop = +new Date; }\n    var pos = posFromMouse(cm, e, true), files = e.dataTransfer.files;\n    if (!pos || cm.isReadOnly()) { return }\n    // Might be a file drop, in which case we simply extract the text\n    // and insert it.\n    if (files && files.length && window.FileReader && window.File) {\n      var n = files.length, text = Array(n), read = 0;\n      var markAsReadAndPasteIfAllFilesAreRead = function () {\n        if (++read == n) {\n          operation(cm, function () {\n            pos = clipPos(cm.doc, pos);\n            var change = {from: pos, to: pos,\n                          text: cm.doc.splitLines(\n                              text.filter(function (t) { return t != null; }).join(cm.doc.lineSeparator())),\n                          origin: \"paste\"};\n            makeChange(cm.doc, change);\n            setSelectionReplaceHistory(cm.doc, simpleSelection(clipPos(cm.doc, pos), clipPos(cm.doc, changeEnd(change))));\n          })();\n        }\n      };\n      var readTextFromFile = function (file, i) {\n        if (cm.options.allowDropFileTypes &&\n            indexOf(cm.options.allowDropFileTypes, file.type) == -1) {\n          markAsReadAndPasteIfAllFilesAreRead();\n          return\n        }\n        var reader = new FileReader;\n        reader.onerror = function () { return markAsReadAndPasteIfAllFilesAreRead(); };\n        reader.onload = function () {\n          var content = reader.result;\n          if (/[\\x00-\\x08\\x0e-\\x1f]{2}/.test(content)) {\n            markAsReadAndPasteIfAllFilesAreRead();\n            return\n          }\n          text[i] = content;\n          markAsReadAndPasteIfAllFilesAreRead();\n        };\n        reader.readAsText(file);\n      };\n      for (var i = 0; i < files.length; i++) { readTextFromFile(files[i], i); }\n    } else { // Normal drop\n      // Don't do a replace if the drop happened inside of the selected text.\n      if (cm.state.draggingText && cm.doc.sel.contains(pos) > -1) {\n        cm.state.draggingText(e);\n        // Ensure the editor is re-focused\n        setTimeout(function () { return cm.display.input.focus(); }, 20);\n        return\n      }\n      try {\n        var text$1 = e.dataTransfer.getData(\"Text\");\n        if (text$1) {\n          var selected;\n          if (cm.state.draggingText && !cm.state.draggingText.copy)\n            { selected = cm.listSelections(); }\n          setSelectionNoUndo(cm.doc, simpleSelection(pos, pos));\n          if (selected) { for (var i$1 = 0; i$1 < selected.length; ++i$1)\n            { replaceRange(cm.doc, \"\", selected[i$1].anchor, selected[i$1].head, \"drag\"); } }\n          cm.replaceSelection(text$1, \"around\", \"paste\");\n          cm.display.input.focus();\n        }\n      }\n      catch(e$1){}\n    }\n  }\n\n  function onDragStart(cm, e) {\n    if (ie && (!cm.state.draggingText || +new Date - lastDrop < 100)) { e_stop(e); return }\n    if (signalDOMEvent(cm, e) || eventInWidget(cm.display, e)) { return }\n\n    e.dataTransfer.setData(\"Text\", cm.getSelection());\n    e.dataTransfer.effectAllowed = \"copyMove\";\n\n    // Use dummy image instead of default browsers image.\n    // Recent Safari (~6.0.2) have a tendency to segfault when this happens, so we don't do it there.\n    if (e.dataTransfer.setDragImage && !safari) {\n      var img = elt(\"img\", null, null, \"position: fixed; left: 0; top: 0;\");\n      img.src = \"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==\";\n      if (presto) {\n        img.width = img.height = 1;\n        cm.display.wrapper.appendChild(img);\n        // Force a relayout, or Opera won't use our image for some obscure reason\n        img._top = img.offsetTop;\n      }\n      e.dataTransfer.setDragImage(img, 0, 0);\n      if (presto) { img.parentNode.removeChild(img); }\n    }\n  }\n\n  function onDragOver(cm, e) {\n    var pos = posFromMouse(cm, e);\n    if (!pos) { return }\n    var frag = document.createDocumentFragment();\n    drawSelectionCursor(cm, pos, frag);\n    if (!cm.display.dragCursor) {\n      cm.display.dragCursor = elt(\"div\", null, \"CodeMirror-cursors CodeMirror-dragcursors\");\n      cm.display.lineSpace.insertBefore(cm.display.dragCursor, cm.display.cursorDiv);\n    }\n    removeChildrenAndAdd(cm.display.dragCursor, frag);\n  }\n\n  function clearDragCursor(cm) {\n    if (cm.display.dragCursor) {\n      cm.display.lineSpace.removeChild(cm.display.dragCursor);\n      cm.display.dragCursor = null;\n    }\n  }\n\n  // These must be handled carefully, because naively registering a\n  // handler for each editor will cause the editors to never be\n  // garbage collected.\n\n  function forEachCodeMirror(f) {\n    if (!document.getElementsByClassName) { return }\n    var byClass = document.getElementsByClassName(\"CodeMirror\"), editors = [];\n    for (var i = 0; i < byClass.length; i++) {\n      var cm = byClass[i].CodeMirror;\n      if (cm) { editors.push(cm); }\n    }\n    if (editors.length) { editors[0].operation(function () {\n      for (var i = 0; i < editors.length; i++) { f(editors[i]); }\n    }); }\n  }\n\n  var globalsRegistered = false;\n  function ensureGlobalHandlers() {\n    if (globalsRegistered) { return }\n    registerGlobalHandlers();\n    globalsRegistered = true;\n  }\n  function registerGlobalHandlers() {\n    // When the window resizes, we need to refresh active editors.\n    var resizeTimer;\n    on(window, \"resize\", function () {\n      if (resizeTimer == null) { resizeTimer = setTimeout(function () {\n        resizeTimer = null;\n        forEachCodeMirror(onResize);\n      }, 100); }\n    });\n    // When the window loses focus, we want to show the editor as blurred\n    on(window, \"blur\", function () { return forEachCodeMirror(onBlur); });\n  }\n  // Called when the window resizes\n  function onResize(cm) {\n    var d = cm.display;\n    // Might be a text scaling operation, clear size caches.\n    d.cachedCharWidth = d.cachedTextHeight = d.cachedPaddingH = null;\n    d.scrollbarsClipped = false;\n    cm.setSize();\n  }\n\n  var keyNames = {\n    3: \"Pause\", 8: \"Backspace\", 9: \"Tab\", 13: \"Enter\", 16: \"Shift\", 17: \"Ctrl\", 18: \"Alt\",\n    19: \"Pause\", 20: \"CapsLock\", 27: \"Esc\", 32: \"Space\", 33: \"PageUp\", 34: \"PageDown\", 35: \"End\",\n    36: \"Home\", 37: \"Left\", 38: \"Up\", 39: \"Right\", 40: \"Down\", 44: \"PrintScrn\", 45: \"Insert\",\n    46: \"Delete\", 59: \";\", 61: \"=\", 91: \"Mod\", 92: \"Mod\", 93: \"Mod\",\n    106: \"*\", 107: \"=\", 109: \"-\", 110: \".\", 111: \"/\", 145: \"ScrollLock\",\n    173: \"-\", 186: \";\", 187: \"=\", 188: \",\", 189: \"-\", 190: \".\", 191: \"/\", 192: \"`\", 219: \"[\", 220: \"\\\\\",\n    221: \"]\", 222: \"'\", 224: \"Mod\", 63232: \"Up\", 63233: \"Down\", 63234: \"Left\", 63235: \"Right\", 63272: \"Delete\",\n    63273: \"Home\", 63275: \"End\", 63276: \"PageUp\", 63277: \"PageDown\", 63302: \"Insert\"\n  };\n\n  // Number keys\n  for (var i = 0; i < 10; i++) { keyNames[i + 48] = keyNames[i + 96] = String(i); }\n  // Alphabetic keys\n  for (var i$1 = 65; i$1 <= 90; i$1++) { keyNames[i$1] = String.fromCharCode(i$1); }\n  // Function keys\n  for (var i$2 = 1; i$2 <= 12; i$2++) { keyNames[i$2 + 111] = keyNames[i$2 + 63235] = \"F\" + i$2; }\n\n  var keyMap = {};\n\n  keyMap.basic = {\n    \"Left\": \"goCharLeft\", \"Right\": \"goCharRight\", \"Up\": \"goLineUp\", \"Down\": \"goLineDown\",\n    \"End\": \"goLineEnd\", \"Home\": \"goLineStartSmart\", \"PageUp\": \"goPageUp\", \"PageDown\": \"goPageDown\",\n    \"Delete\": \"delCharAfter\", \"Backspace\": \"delCharBefore\", \"Shift-Backspace\": \"delCharBefore\",\n    \"Tab\": \"defaultTab\", \"Shift-Tab\": \"indentAuto\",\n    \"Enter\": \"newlineAndIndent\", \"Insert\": \"toggleOverwrite\",\n    \"Esc\": \"singleSelection\"\n  };\n  // Note that the save and find-related commands aren't defined by\n  // default. User code or addons can define them. Unknown commands\n  // are simply ignored.\n  keyMap.pcDefault = {\n    \"Ctrl-A\": \"selectAll\", \"Ctrl-D\": \"deleteLine\", \"Ctrl-Z\": \"undo\", \"Shift-Ctrl-Z\": \"redo\", \"Ctrl-Y\": \"redo\",\n    \"Ctrl-Home\": \"goDocStart\", \"Ctrl-End\": \"goDocEnd\", \"Ctrl-Up\": \"goLineUp\", \"Ctrl-Down\": \"goLineDown\",\n    \"Ctrl-Left\": \"goGroupLeft\", \"Ctrl-Right\": \"goGroupRight\", \"Alt-Left\": \"goLineStart\", \"Alt-Right\": \"goLineEnd\",\n    \"Ctrl-Backspace\": \"delGroupBefore\", \"Ctrl-Delete\": \"delGroupAfter\", \"Ctrl-S\": \"save\", \"Ctrl-F\": \"find\",\n    \"Ctrl-G\": \"findNext\", \"Shift-Ctrl-G\": \"findPrev\", \"Shift-Ctrl-F\": \"replace\", \"Shift-Ctrl-R\": \"replaceAll\",\n    \"Ctrl-[\": \"indentLess\", \"Ctrl-]\": \"indentMore\",\n    \"Ctrl-U\": \"undoSelection\", \"Shift-Ctrl-U\": \"redoSelection\", \"Alt-U\": \"redoSelection\",\n    \"fallthrough\": \"basic\"\n  };\n  // Very basic readline/emacs-style bindings, which are standard on Mac.\n  keyMap.emacsy = {\n    \"Ctrl-F\": \"goCharRight\", \"Ctrl-B\": \"goCharLeft\", \"Ctrl-P\": \"goLineUp\", \"Ctrl-N\": \"goLineDown\",\n    \"Alt-F\": \"goWordRight\", \"Alt-B\": \"goWordLeft\", \"Ctrl-A\": \"goLineStart\", \"Ctrl-E\": \"goLineEnd\",\n    \"Ctrl-V\": \"goPageDown\", \"Shift-Ctrl-V\": \"goPageUp\", \"Ctrl-D\": \"delCharAfter\", \"Ctrl-H\": \"delCharBefore\",\n    \"Alt-D\": \"delWordAfter\", \"Alt-Backspace\": \"delWordBefore\", \"Ctrl-K\": \"killLine\", \"Ctrl-T\": \"transposeChars\",\n    \"Ctrl-O\": \"openLine\"\n  };\n  keyMap.macDefault = {\n    \"Cmd-A\": \"selectAll\", \"Cmd-D\": \"deleteLine\", \"Cmd-Z\": \"undo\", \"Shift-Cmd-Z\": \"redo\", \"Cmd-Y\": \"redo\",\n    \"Cmd-Home\": \"goDocStart\", \"Cmd-Up\": \"goDocStart\", \"Cmd-End\": \"goDocEnd\", \"Cmd-Down\": \"goDocEnd\", \"Alt-Left\": \"goGroupLeft\",\n    \"Alt-Right\": \"goGroupRight\", \"Cmd-Left\": \"goLineLeft\", \"Cmd-Right\": \"goLineRight\", \"Alt-Backspace\": \"delGroupBefore\",\n    \"Ctrl-Alt-Backspace\": \"delGroupAfter\", \"Alt-Delete\": \"delGroupAfter\", \"Cmd-S\": \"save\", \"Cmd-F\": \"find\",\n    \"Cmd-G\": \"findNext\", \"Shift-Cmd-G\": \"findPrev\", \"Cmd-Alt-F\": \"replace\", \"Shift-Cmd-Alt-F\": \"replaceAll\",\n    \"Cmd-[\": \"indentLess\", \"Cmd-]\": \"indentMore\", \"Cmd-Backspace\": \"delWrappedLineLeft\", \"Cmd-Delete\": \"delWrappedLineRight\",\n    \"Cmd-U\": \"undoSelection\", \"Shift-Cmd-U\": \"redoSelection\", \"Ctrl-Up\": \"goDocStart\", \"Ctrl-Down\": \"goDocEnd\",\n    \"fallthrough\": [\"basic\", \"emacsy\"]\n  };\n  keyMap[\"default\"] = mac ? keyMap.macDefault : keyMap.pcDefault;\n\n  // KEYMAP DISPATCH\n\n  function normalizeKeyName(name) {\n    var parts = name.split(/-(?!$)/);\n    name = parts[parts.length - 1];\n    var alt, ctrl, shift, cmd;\n    for (var i = 0; i < parts.length - 1; i++) {\n      var mod = parts[i];\n      if (/^(cmd|meta|m)$/i.test(mod)) { cmd = true; }\n      else if (/^a(lt)?$/i.test(mod)) { alt = true; }\n      else if (/^(c|ctrl|control)$/i.test(mod)) { ctrl = true; }\n      else if (/^s(hift)?$/i.test(mod)) { shift = true; }\n      else { throw new Error(\"Unrecognized modifier name: \" + mod) }\n    }\n    if (alt) { name = \"Alt-\" + name; }\n    if (ctrl) { name = \"Ctrl-\" + name; }\n    if (cmd) { name = \"Cmd-\" + name; }\n    if (shift) { name = \"Shift-\" + name; }\n    return name\n  }\n\n  // This is a kludge to keep keymaps mostly working as raw objects\n  // (backwards compatibility) while at the same time support features\n  // like normalization and multi-stroke key bindings. It compiles a\n  // new normalized keymap, and then updates the old object to reflect\n  // this.\n  function normalizeKeyMap(keymap) {\n    var copy = {};\n    for (var keyname in keymap) { if (keymap.hasOwnProperty(keyname)) {\n      var value = keymap[keyname];\n      if (/^(name|fallthrough|(de|at)tach)$/.test(keyname)) { continue }\n      if (value == \"...\") { delete keymap[keyname]; continue }\n\n      var keys = map(keyname.split(\" \"), normalizeKeyName);\n      for (var i = 0; i < keys.length; i++) {\n        var val = (void 0), name = (void 0);\n        if (i == keys.length - 1) {\n          name = keys.join(\" \");\n          val = value;\n        } else {\n          name = keys.slice(0, i + 1).join(\" \");\n          val = \"...\";\n        }\n        var prev = copy[name];\n        if (!prev) { copy[name] = val; }\n        else if (prev != val) { throw new Error(\"Inconsistent bindings for \" + name) }\n      }\n      delete keymap[keyname];\n    } }\n    for (var prop in copy) { keymap[prop] = copy[prop]; }\n    return keymap\n  }\n\n  function lookupKey(key, map, handle, context) {\n    map = getKeyMap(map);\n    var found = map.call ? map.call(key, context) : map[key];\n    if (found === false) { return \"nothing\" }\n    if (found === \"...\") { return \"multi\" }\n    if (found != null && handle(found)) { return \"handled\" }\n\n    if (map.fallthrough) {\n      if (Object.prototype.toString.call(map.fallthrough) != \"[object Array]\")\n        { return lookupKey(key, map.fallthrough, handle, context) }\n      for (var i = 0; i < map.fallthrough.length; i++) {\n        var result = lookupKey(key, map.fallthrough[i], handle, context);\n        if (result) { return result }\n      }\n    }\n  }\n\n  // Modifier key presses don't count as 'real' key presses for the\n  // purpose of keymap fallthrough.\n  function isModifierKey(value) {\n    var name = typeof value == \"string\" ? value : keyNames[value.keyCode];\n    return name == \"Ctrl\" || name == \"Alt\" || name == \"Shift\" || name == \"Mod\"\n  }\n\n  function addModifierNames(name, event, noShift) {\n    var base = name;\n    if (event.altKey && base != \"Alt\") { name = \"Alt-\" + name; }\n    if ((flipCtrlCmd ? event.metaKey : event.ctrlKey) && base != \"Ctrl\") { name = \"Ctrl-\" + name; }\n    if ((flipCtrlCmd ? event.ctrlKey : event.metaKey) && base != \"Mod\") { name = \"Cmd-\" + name; }\n    if (!noShift && event.shiftKey && base != \"Shift\") { name = \"Shift-\" + name; }\n    return name\n  }\n\n  // Look up the name of a key as indicated by an event object.\n  function keyName(event, noShift) {\n    if (presto && event.keyCode == 34 && event[\"char\"]) { return false }\n    var name = keyNames[event.keyCode];\n    if (name == null || event.altGraphKey) { return false }\n    // Ctrl-ScrollLock has keyCode 3, same as Ctrl-Pause,\n    // so we'll use event.code when available (Chrome 48+, FF 38+, Safari 10.1+)\n    if (event.keyCode == 3 && event.code) { name = event.code; }\n    return addModifierNames(name, event, noShift)\n  }\n\n  function getKeyMap(val) {\n    return typeof val == \"string\" ? keyMap[val] : val\n  }\n\n  // Helper for deleting text near the selection(s), used to implement\n  // backspace, delete, and similar functionality.\n  function deleteNearSelection(cm, compute) {\n    var ranges = cm.doc.sel.ranges, kill = [];\n    // Build up a set of ranges to kill first, merging overlapping\n    // ranges.\n    for (var i = 0; i < ranges.length; i++) {\n      var toKill = compute(ranges[i]);\n      while (kill.length && cmp(toKill.from, lst(kill).to) <= 0) {\n        var replaced = kill.pop();\n        if (cmp(replaced.from, toKill.from) < 0) {\n          toKill.from = replaced.from;\n          break\n        }\n      }\n      kill.push(toKill);\n    }\n    // Next, remove those actual ranges.\n    runInOp(cm, function () {\n      for (var i = kill.length - 1; i >= 0; i--)\n        { replaceRange(cm.doc, \"\", kill[i].from, kill[i].to, \"+delete\"); }\n      ensureCursorVisible(cm);\n    });\n  }\n\n  function moveCharLogically(line, ch, dir) {\n    var target = skipExtendingChars(line.text, ch + dir, dir);\n    return target < 0 || target > line.text.length ? null : target\n  }\n\n  function moveLogically(line, start, dir) {\n    var ch = moveCharLogically(line, start.ch, dir);\n    return ch == null ? null : new Pos(start.line, ch, dir < 0 ? \"after\" : \"before\")\n  }\n\n  function endOfLine(visually, cm, lineObj, lineNo, dir) {\n    if (visually) {\n      if (cm.doc.direction == \"rtl\") { dir = -dir; }\n      var order = getOrder(lineObj, cm.doc.direction);\n      if (order) {\n        var part = dir < 0 ? lst(order) : order[0];\n        var moveInStorageOrder = (dir < 0) == (part.level == 1);\n        var sticky = moveInStorageOrder ? \"after\" : \"before\";\n        var ch;\n        // With a wrapped rtl chunk (possibly spanning multiple bidi parts),\n        // it could be that the last bidi part is not on the last visual line,\n        // since visual lines contain content order-consecutive chunks.\n        // Thus, in rtl, we are looking for the first (content-order) character\n        // in the rtl chunk that is on the last line (that is, the same line\n        // as the last (content-order) character).\n        if (part.level > 0 || cm.doc.direction == \"rtl\") {\n          var prep = prepareMeasureForLine(cm, lineObj);\n          ch = dir < 0 ? lineObj.text.length - 1 : 0;\n          var targetTop = measureCharPrepared(cm, prep, ch).top;\n          ch = findFirst(function (ch) { return measureCharPrepared(cm, prep, ch).top == targetTop; }, (dir < 0) == (part.level == 1) ? part.from : part.to - 1, ch);\n          if (sticky == \"before\") { ch = moveCharLogically(lineObj, ch, 1); }\n        } else { ch = dir < 0 ? part.to : part.from; }\n        return new Pos(lineNo, ch, sticky)\n      }\n    }\n    return new Pos(lineNo, dir < 0 ? lineObj.text.length : 0, dir < 0 ? \"before\" : \"after\")\n  }\n\n  function moveVisually(cm, line, start, dir) {\n    var bidi = getOrder(line, cm.doc.direction);\n    if (!bidi) { return moveLogically(line, start, dir) }\n    if (start.ch >= line.text.length) {\n      start.ch = line.text.length;\n      start.sticky = \"before\";\n    } else if (start.ch <= 0) {\n      start.ch = 0;\n      start.sticky = \"after\";\n    }\n    var partPos = getBidiPartAt(bidi, start.ch, start.sticky), part = bidi[partPos];\n    if (cm.doc.direction == \"ltr\" && part.level % 2 == 0 && (dir > 0 ? part.to > start.ch : part.from < start.ch)) {\n      // Case 1: We move within an ltr part in an ltr editor. Even with wrapped lines,\n      // nothing interesting happens.\n      return moveLogically(line, start, dir)\n    }\n\n    var mv = function (pos, dir) { return moveCharLogically(line, pos instanceof Pos ? pos.ch : pos, dir); };\n    var prep;\n    var getWrappedLineExtent = function (ch) {\n      if (!cm.options.lineWrapping) { return {begin: 0, end: line.text.length} }\n      prep = prep || prepareMeasureForLine(cm, line);\n      return wrappedLineExtentChar(cm, line, prep, ch)\n    };\n    var wrappedLineExtent = getWrappedLineExtent(start.sticky == \"before\" ? mv(start, -1) : start.ch);\n\n    if (cm.doc.direction == \"rtl\" || part.level == 1) {\n      var moveInStorageOrder = (part.level == 1) == (dir < 0);\n      var ch = mv(start, moveInStorageOrder ? 1 : -1);\n      if (ch != null && (!moveInStorageOrder ? ch >= part.from && ch >= wrappedLineExtent.begin : ch <= part.to && ch <= wrappedLineExtent.end)) {\n        // Case 2: We move within an rtl part or in an rtl editor on the same visual line\n        var sticky = moveInStorageOrder ? \"before\" : \"after\";\n        return new Pos(start.line, ch, sticky)\n      }\n    }\n\n    // Case 3: Could not move within this bidi part in this visual line, so leave\n    // the current bidi part\n\n    var searchInVisualLine = function (partPos, dir, wrappedLineExtent) {\n      var getRes = function (ch, moveInStorageOrder) { return moveInStorageOrder\n        ? new Pos(start.line, mv(ch, 1), \"before\")\n        : new Pos(start.line, ch, \"after\"); };\n\n      for (; partPos >= 0 && partPos < bidi.length; partPos += dir) {\n        var part = bidi[partPos];\n        var moveInStorageOrder = (dir > 0) == (part.level != 1);\n        var ch = moveInStorageOrder ? wrappedLineExtent.begin : mv(wrappedLineExtent.end, -1);\n        if (part.from <= ch && ch < part.to) { return getRes(ch, moveInStorageOrder) }\n        ch = moveInStorageOrder ? part.from : mv(part.to, -1);\n        if (wrappedLineExtent.begin <= ch && ch < wrappedLineExtent.end) { return getRes(ch, moveInStorageOrder) }\n      }\n    };\n\n    // Case 3a: Look for other bidi parts on the same visual line\n    var res = searchInVisualLine(partPos + dir, dir, wrappedLineExtent);\n    if (res) { return res }\n\n    // Case 3b: Look for other bidi parts on the next visual line\n    var nextCh = dir > 0 ? wrappedLineExtent.end : mv(wrappedLineExtent.begin, -1);\n    if (nextCh != null && !(dir > 0 && nextCh == line.text.length)) {\n      res = searchInVisualLine(dir > 0 ? 0 : bidi.length - 1, dir, getWrappedLineExtent(nextCh));\n      if (res) { return res }\n    }\n\n    // Case 4: Nowhere to move\n    return null\n  }\n\n  // Commands are parameter-less actions that can be performed on an\n  // editor, mostly used for keybindings.\n  var commands = {\n    selectAll: selectAll,\n    singleSelection: function (cm) { return cm.setSelection(cm.getCursor(\"anchor\"), cm.getCursor(\"head\"), sel_dontScroll); },\n    killLine: function (cm) { return deleteNearSelection(cm, function (range) {\n      if (range.empty()) {\n        var len = getLine(cm.doc, range.head.line).text.length;\n        if (range.head.ch == len && range.head.line < cm.lastLine())\n          { return {from: range.head, to: Pos(range.head.line + 1, 0)} }\n        else\n          { return {from: range.head, to: Pos(range.head.line, len)} }\n      } else {\n        return {from: range.from(), to: range.to()}\n      }\n    }); },\n    deleteLine: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n      from: Pos(range.from().line, 0),\n      to: clipPos(cm.doc, Pos(range.to().line + 1, 0))\n    }); }); },\n    delLineLeft: function (cm) { return deleteNearSelection(cm, function (range) { return ({\n      from: Pos(range.from().line, 0), to: range.from()\n    }); }); },\n    delWrappedLineLeft: function (cm) { return deleteNearSelection(cm, function (range) {\n      var top = cm.charCoords(range.head, \"div\").top + 5;\n      var leftPos = cm.coordsChar({left: 0, top: top}, \"div\");\n      return {from: leftPos, to: range.from()}\n    }); },\n    delWrappedLineRight: function (cm) { return deleteNearSelection(cm, function (range) {\n      var top = cm.charCoords(range.head, \"div\").top + 5;\n      var rightPos = cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\");\n      return {from: range.from(), to: rightPos }\n    }); },\n    undo: function (cm) { return cm.undo(); },\n    redo: function (cm) { return cm.redo(); },\n    undoSelection: function (cm) { return cm.undoSelection(); },\n    redoSelection: function (cm) { return cm.redoSelection(); },\n    goDocStart: function (cm) { return cm.extendSelection(Pos(cm.firstLine(), 0)); },\n    goDocEnd: function (cm) { return cm.extendSelection(Pos(cm.lastLine())); },\n    goLineStart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStart(cm, range.head.line); },\n      {origin: \"+move\", bias: 1}\n    ); },\n    goLineStartSmart: function (cm) { return cm.extendSelectionsBy(function (range) { return lineStartSmart(cm, range.head); },\n      {origin: \"+move\", bias: 1}\n    ); },\n    goLineEnd: function (cm) { return cm.extendSelectionsBy(function (range) { return lineEnd(cm, range.head.line); },\n      {origin: \"+move\", bias: -1}\n    ); },\n    goLineRight: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      return cm.coordsChar({left: cm.display.lineDiv.offsetWidth + 100, top: top}, \"div\")\n    }, sel_move); },\n    goLineLeft: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      return cm.coordsChar({left: 0, top: top}, \"div\")\n    }, sel_move); },\n    goLineLeftSmart: function (cm) { return cm.extendSelectionsBy(function (range) {\n      var top = cm.cursorCoords(range.head, \"div\").top + 5;\n      var pos = cm.coordsChar({left: 0, top: top}, \"div\");\n      if (pos.ch < cm.getLine(pos.line).search(/\\S/)) { return lineStartSmart(cm, range.head) }\n      return pos\n    }, sel_move); },\n    goLineUp: function (cm) { return cm.moveV(-1, \"line\"); },\n    goLineDown: function (cm) { return cm.moveV(1, \"line\"); },\n    goPageUp: function (cm) { return cm.moveV(-1, \"page\"); },\n    goPageDown: function (cm) { return cm.moveV(1, \"page\"); },\n    goCharLeft: function (cm) { return cm.moveH(-1, \"char\"); },\n    goCharRight: function (cm) { return cm.moveH(1, \"char\"); },\n    goColumnLeft: function (cm) { return cm.moveH(-1, \"column\"); },\n    goColumnRight: function (cm) { return cm.moveH(1, \"column\"); },\n    goWordLeft: function (cm) { return cm.moveH(-1, \"word\"); },\n    goGroupRight: function (cm) { return cm.moveH(1, \"group\"); },\n    goGroupLeft: function (cm) { return cm.moveH(-1, \"group\"); },\n    goWordRight: function (cm) { return cm.moveH(1, \"word\"); },\n    delCharBefore: function (cm) { return cm.deleteH(-1, \"codepoint\"); },\n    delCharAfter: function (cm) { return cm.deleteH(1, \"char\"); },\n    delWordBefore: function (cm) { return cm.deleteH(-1, \"word\"); },\n    delWordAfter: function (cm) { return cm.deleteH(1, \"word\"); },\n    delGroupBefore: function (cm) { return cm.deleteH(-1, \"group\"); },\n    delGroupAfter: function (cm) { return cm.deleteH(1, \"group\"); },\n    indentAuto: function (cm) { return cm.indentSelection(\"smart\"); },\n    indentMore: function (cm) { return cm.indentSelection(\"add\"); },\n    indentLess: function (cm) { return cm.indentSelection(\"subtract\"); },\n    insertTab: function (cm) { return cm.replaceSelection(\"\\t\"); },\n    insertSoftTab: function (cm) {\n      var spaces = [], ranges = cm.listSelections(), tabSize = cm.options.tabSize;\n      for (var i = 0; i < ranges.length; i++) {\n        var pos = ranges[i].from();\n        var col = countColumn(cm.getLine(pos.line), pos.ch, tabSize);\n        spaces.push(spaceStr(tabSize - col % tabSize));\n      }\n      cm.replaceSelections(spaces);\n    },\n    defaultTab: function (cm) {\n      if (cm.somethingSelected()) { cm.indentSelection(\"add\"); }\n      else { cm.execCommand(\"insertTab\"); }\n    },\n    // Swap the two chars left and right of each selection's head.\n    // Move cursor behind the two swapped characters afterwards.\n    //\n    // Doesn't consider line feeds a character.\n    // Doesn't scan more than one line above to find a character.\n    // Doesn't do anything on an empty line.\n    // Doesn't do anything with non-empty selections.\n    transposeChars: function (cm) { return runInOp(cm, function () {\n      var ranges = cm.listSelections(), newSel = [];\n      for (var i = 0; i < ranges.length; i++) {\n        if (!ranges[i].empty()) { continue }\n        var cur = ranges[i].head, line = getLine(cm.doc, cur.line).text;\n        if (line) {\n          if (cur.ch == line.length) { cur = new Pos(cur.line, cur.ch - 1); }\n          if (cur.ch > 0) {\n            cur = new Pos(cur.line, cur.ch + 1);\n            cm.replaceRange(line.charAt(cur.ch - 1) + line.charAt(cur.ch - 2),\n                            Pos(cur.line, cur.ch - 2), cur, \"+transpose\");\n          } else if (cur.line > cm.doc.first) {\n            var prev = getLine(cm.doc, cur.line - 1).text;\n            if (prev) {\n              cur = new Pos(cur.line, 1);\n              cm.replaceRange(line.charAt(0) + cm.doc.lineSeparator() +\n                              prev.charAt(prev.length - 1),\n                              Pos(cur.line - 1, prev.length - 1), cur, \"+transpose\");\n            }\n          }\n        }\n        newSel.push(new Range(cur, cur));\n      }\n      cm.setSelections(newSel);\n    }); },\n    newlineAndIndent: function (cm) { return runInOp(cm, function () {\n      var sels = cm.listSelections();\n      for (var i = sels.length - 1; i >= 0; i--)\n        { cm.replaceRange(cm.doc.lineSeparator(), sels[i].anchor, sels[i].head, \"+input\"); }\n      sels = cm.listSelections();\n      for (var i$1 = 0; i$1 < sels.length; i$1++)\n        { cm.indentLine(sels[i$1].from().line, null, true); }\n      ensureCursorVisible(cm);\n    }); },\n    openLine: function (cm) { return cm.replaceSelection(\"\\n\", \"start\"); },\n    toggleOverwrite: function (cm) { return cm.toggleOverwrite(); }\n  };\n\n\n  function lineStart(cm, lineN) {\n    var line = getLine(cm.doc, lineN);\n    var visual = visualLine(line);\n    if (visual != line) { lineN = lineNo(visual); }\n    return endOfLine(true, cm, visual, lineN, 1)\n  }\n  function lineEnd(cm, lineN) {\n    var line = getLine(cm.doc, lineN);\n    var visual = visualLineEnd(line);\n    if (visual != line) { lineN = lineNo(visual); }\n    return endOfLine(true, cm, line, lineN, -1)\n  }\n  function lineStartSmart(cm, pos) {\n    var start = lineStart(cm, pos.line);\n    var line = getLine(cm.doc, start.line);\n    var order = getOrder(line, cm.doc.direction);\n    if (!order || order[0].level == 0) {\n      var firstNonWS = Math.max(start.ch, line.text.search(/\\S/));\n      var inWS = pos.line == start.line && pos.ch <= firstNonWS && pos.ch;\n      return Pos(start.line, inWS ? 0 : firstNonWS, start.sticky)\n    }\n    return start\n  }\n\n  // Run a handler that was bound to a key.\n  function doHandleBinding(cm, bound, dropShift) {\n    if (typeof bound == \"string\") {\n      bound = commands[bound];\n      if (!bound) { return false }\n    }\n    // Ensure previous input has been read, so that the handler sees a\n    // consistent view of the document\n    cm.display.input.ensurePolled();\n    var prevShift = cm.display.shift, done = false;\n    try {\n      if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n      if (dropShift) { cm.display.shift = false; }\n      done = bound(cm) != Pass;\n    } finally {\n      cm.display.shift = prevShift;\n      cm.state.suppressEdits = false;\n    }\n    return done\n  }\n\n  function lookupKeyForEditor(cm, name, handle) {\n    for (var i = 0; i < cm.state.keyMaps.length; i++) {\n      var result = lookupKey(name, cm.state.keyMaps[i], handle, cm);\n      if (result) { return result }\n    }\n    return (cm.options.extraKeys && lookupKey(name, cm.options.extraKeys, handle, cm))\n      || lookupKey(name, cm.options.keyMap, handle, cm)\n  }\n\n  // Note that, despite the name, this function is also used to check\n  // for bound mouse clicks.\n\n  var stopSeq = new Delayed;\n\n  function dispatchKey(cm, name, e, handle) {\n    var seq = cm.state.keySeq;\n    if (seq) {\n      if (isModifierKey(name)) { return \"handled\" }\n      if (/\\'$/.test(name))\n        { cm.state.keySeq = null; }\n      else\n        { stopSeq.set(50, function () {\n          if (cm.state.keySeq == seq) {\n            cm.state.keySeq = null;\n            cm.display.input.reset();\n          }\n        }); }\n      if (dispatchKeyInner(cm, seq + \" \" + name, e, handle)) { return true }\n    }\n    return dispatchKeyInner(cm, name, e, handle)\n  }\n\n  function dispatchKeyInner(cm, name, e, handle) {\n    var result = lookupKeyForEditor(cm, name, handle);\n\n    if (result == \"multi\")\n      { cm.state.keySeq = name; }\n    if (result == \"handled\")\n      { signalLater(cm, \"keyHandled\", cm, name, e); }\n\n    if (result == \"handled\" || result == \"multi\") {\n      e_preventDefault(e);\n      restartBlink(cm);\n    }\n\n    return !!result\n  }\n\n  // Handle a key from the keydown event.\n  function handleKeyBinding(cm, e) {\n    var name = keyName(e, true);\n    if (!name) { return false }\n\n    if (e.shiftKey && !cm.state.keySeq) {\n      // First try to resolve full name (including 'Shift-'). Failing\n      // that, see if there is a cursor-motion command (starting with\n      // 'go') bound to the keyname without 'Shift-'.\n      return dispatchKey(cm, \"Shift-\" + name, e, function (b) { return doHandleBinding(cm, b, true); })\n          || dispatchKey(cm, name, e, function (b) {\n               if (typeof b == \"string\" ? /^go[A-Z]/.test(b) : b.motion)\n                 { return doHandleBinding(cm, b) }\n             })\n    } else {\n      return dispatchKey(cm, name, e, function (b) { return doHandleBinding(cm, b); })\n    }\n  }\n\n  // Handle a key from the keypress event\n  function handleCharBinding(cm, e, ch) {\n    return dispatchKey(cm, \"'\" + ch + \"'\", e, function (b) { return doHandleBinding(cm, b, true); })\n  }\n\n  var lastStoppedKey = null;\n  function onKeyDown(e) {\n    var cm = this;\n    if (e.target && e.target != cm.display.input.getField()) { return }\n    cm.curOp.focus = activeElt();\n    if (signalDOMEvent(cm, e)) { return }\n    // IE does strange things with escape.\n    if (ie && ie_version < 11 && e.keyCode == 27) { e.returnValue = false; }\n    var code = e.keyCode;\n    cm.display.shift = code == 16 || e.shiftKey;\n    var handled = handleKeyBinding(cm, e);\n    if (presto) {\n      lastStoppedKey = handled ? code : null;\n      // Opera has no cut event... we try to at least catch the key combo\n      if (!handled && code == 88 && !hasCopyEvent && (mac ? e.metaKey : e.ctrlKey))\n        { cm.replaceSelection(\"\", null, \"cut\"); }\n    }\n    if (gecko && !mac && !handled && code == 46 && e.shiftKey && !e.ctrlKey && document.execCommand)\n      { document.execCommand(\"cut\"); }\n\n    // Turn mouse into crosshair when Alt is held on Mac.\n    if (code == 18 && !/\\bCodeMirror-crosshair\\b/.test(cm.display.lineDiv.className))\n      { showCrossHair(cm); }\n  }\n\n  function showCrossHair(cm) {\n    var lineDiv = cm.display.lineDiv;\n    addClass(lineDiv, \"CodeMirror-crosshair\");\n\n    function up(e) {\n      if (e.keyCode == 18 || !e.altKey) {\n        rmClass(lineDiv, \"CodeMirror-crosshair\");\n        off(document, \"keyup\", up);\n        off(document, \"mouseover\", up);\n      }\n    }\n    on(document, \"keyup\", up);\n    on(document, \"mouseover\", up);\n  }\n\n  function onKeyUp(e) {\n    if (e.keyCode == 16) { this.doc.sel.shift = false; }\n    signalDOMEvent(this, e);\n  }\n\n  function onKeyPress(e) {\n    var cm = this;\n    if (e.target && e.target != cm.display.input.getField()) { return }\n    if (eventInWidget(cm.display, e) || signalDOMEvent(cm, e) || e.ctrlKey && !e.altKey || mac && e.metaKey) { return }\n    var keyCode = e.keyCode, charCode = e.charCode;\n    if (presto && keyCode == lastStoppedKey) {lastStoppedKey = null; e_preventDefault(e); return}\n    if ((presto && (!e.which || e.which < 10)) && handleKeyBinding(cm, e)) { return }\n    var ch = String.fromCharCode(charCode == null ? keyCode : charCode);\n    // Some browsers fire keypress events for backspace\n    if (ch == \"\\x08\") { return }\n    if (handleCharBinding(cm, e, ch)) { return }\n    cm.display.input.onKeyPress(e);\n  }\n\n  var DOUBLECLICK_DELAY = 400;\n\n  var PastClick = function(time, pos, button) {\n    this.time = time;\n    this.pos = pos;\n    this.button = button;\n  };\n\n  PastClick.prototype.compare = function (time, pos, button) {\n    return this.time + DOUBLECLICK_DELAY > time &&\n      cmp(pos, this.pos) == 0 && button == this.button\n  };\n\n  var lastClick, lastDoubleClick;\n  function clickRepeat(pos, button) {\n    var now = +new Date;\n    if (lastDoubleClick && lastDoubleClick.compare(now, pos, button)) {\n      lastClick = lastDoubleClick = null;\n      return \"triple\"\n    } else if (lastClick && lastClick.compare(now, pos, button)) {\n      lastDoubleClick = new PastClick(now, pos, button);\n      lastClick = null;\n      return \"double\"\n    } else {\n      lastClick = new PastClick(now, pos, button);\n      lastDoubleClick = null;\n      return \"single\"\n    }\n  }\n\n  // A mouse down can be a single click, double click, triple click,\n  // start of selection drag, start of text drag, new cursor\n  // (ctrl-click), rectangle drag (alt-drag), or xwin\n  // middle-click-paste. Or it might be a click on something we should\n  // not interfere with, such as a scrollbar or widget.\n  function onMouseDown(e) {\n    var cm = this, display = cm.display;\n    if (signalDOMEvent(cm, e) || display.activeTouch && display.input.supportsTouch()) { return }\n    display.input.ensurePolled();\n    display.shift = e.shiftKey;\n\n    if (eventInWidget(display, e)) {\n      if (!webkit) {\n        // Briefly turn off draggability, to allow widgets to do\n        // normal dragging things.\n        display.scroller.draggable = false;\n        setTimeout(function () { return display.scroller.draggable = true; }, 100);\n      }\n      return\n    }\n    if (clickInGutter(cm, e)) { return }\n    var pos = posFromMouse(cm, e), button = e_button(e), repeat = pos ? clickRepeat(pos, button) : \"single\";\n    window.focus();\n\n    // #3261: make sure, that we're not starting a second selection\n    if (button == 1 && cm.state.selectingText)\n      { cm.state.selectingText(e); }\n\n    if (pos && handleMappedButton(cm, button, pos, repeat, e)) { return }\n\n    if (button == 1) {\n      if (pos) { leftButtonDown(cm, pos, repeat, e); }\n      else if (e_target(e) == display.scroller) { e_preventDefault(e); }\n    } else if (button == 2) {\n      if (pos) { extendSelection(cm.doc, pos); }\n      setTimeout(function () { return display.input.focus(); }, 20);\n    } else if (button == 3) {\n      if (captureRightClick) { cm.display.input.onContextMenu(e); }\n      else { delayBlurEvent(cm); }\n    }\n  }\n\n  function handleMappedButton(cm, button, pos, repeat, event) {\n    var name = \"Click\";\n    if (repeat == \"double\") { name = \"Double\" + name; }\n    else if (repeat == \"triple\") { name = \"Triple\" + name; }\n    name = (button == 1 ? \"Left\" : button == 2 ? \"Middle\" : \"Right\") + name;\n\n    return dispatchKey(cm,  addModifierNames(name, event), event, function (bound) {\n      if (typeof bound == \"string\") { bound = commands[bound]; }\n      if (!bound) { return false }\n      var done = false;\n      try {\n        if (cm.isReadOnly()) { cm.state.suppressEdits = true; }\n        done = bound(cm, pos) != Pass;\n      } finally {\n        cm.state.suppressEdits = false;\n      }\n      return done\n    })\n  }\n\n  function configureMouse(cm, repeat, event) {\n    var option = cm.getOption(\"configureMouse\");\n    var value = option ? option(cm, repeat, event) : {};\n    if (value.unit == null) {\n      var rect = chromeOS ? event.shiftKey && event.metaKey : event.altKey;\n      value.unit = rect ? \"rectangle\" : repeat == \"single\" ? \"char\" : repeat == \"double\" ? \"word\" : \"line\";\n    }\n    if (value.extend == null || cm.doc.extend) { value.extend = cm.doc.extend || event.shiftKey; }\n    if (value.addNew == null) { value.addNew = mac ? event.metaKey : event.ctrlKey; }\n    if (value.moveOnDrag == null) { value.moveOnDrag = !(mac ? event.altKey : event.ctrlKey); }\n    return value\n  }\n\n  function leftButtonDown(cm, pos, repeat, event) {\n    if (ie) { setTimeout(bind(ensureFocus, cm), 0); }\n    else { cm.curOp.focus = activeElt(); }\n\n    var behavior = configureMouse(cm, repeat, event);\n\n    var sel = cm.doc.sel, contained;\n    if (cm.options.dragDrop && dragAndDrop && !cm.isReadOnly() &&\n        repeat == \"single\" && (contained = sel.contains(pos)) > -1 &&\n        (cmp((contained = sel.ranges[contained]).from(), pos) < 0 || pos.xRel > 0) &&\n        (cmp(contained.to(), pos) > 0 || pos.xRel < 0))\n      { leftButtonStartDrag(cm, event, pos, behavior); }\n    else\n      { leftButtonSelect(cm, event, pos, behavior); }\n  }\n\n  // Start a text drag. When it ends, see if any dragging actually\n  // happen, and treat as a click if it didn't.\n  function leftButtonStartDrag(cm, event, pos, behavior) {\n    var display = cm.display, moved = false;\n    var dragEnd = operation(cm, function (e) {\n      if (webkit) { display.scroller.draggable = false; }\n      cm.state.draggingText = false;\n      off(display.wrapper.ownerDocument, \"mouseup\", dragEnd);\n      off(display.wrapper.ownerDocument, \"mousemove\", mouseMove);\n      off(display.scroller, \"dragstart\", dragStart);\n      off(display.scroller, \"drop\", dragEnd);\n      if (!moved) {\n        e_preventDefault(e);\n        if (!behavior.addNew)\n          { extendSelection(cm.doc, pos, null, null, behavior.extend); }\n        // Work around unexplainable focus problem in IE9 (#2127) and Chrome (#3081)\n        if ((webkit && !safari) || ie && ie_version == 9)\n          { setTimeout(function () {display.wrapper.ownerDocument.body.focus({preventScroll: true}); display.input.focus();}, 20); }\n        else\n          { display.input.focus(); }\n      }\n    });\n    var mouseMove = function(e2) {\n      moved = moved || Math.abs(event.clientX - e2.clientX) + Math.abs(event.clientY - e2.clientY) >= 10;\n    };\n    var dragStart = function () { return moved = true; };\n    // Let the drag handler handle this.\n    if (webkit) { display.scroller.draggable = true; }\n    cm.state.draggingText = dragEnd;\n    dragEnd.copy = !behavior.moveOnDrag;\n    // IE's approach to draggable\n    if (display.scroller.dragDrop) { display.scroller.dragDrop(); }\n    on(display.wrapper.ownerDocument, \"mouseup\", dragEnd);\n    on(display.wrapper.ownerDocument, \"mousemove\", mouseMove);\n    on(display.scroller, \"dragstart\", dragStart);\n    on(display.scroller, \"drop\", dragEnd);\n\n    delayBlurEvent(cm);\n    setTimeout(function () { return display.input.focus(); }, 20);\n  }\n\n  function rangeForUnit(cm, pos, unit) {\n    if (unit == \"char\") { return new Range(pos, pos) }\n    if (unit == \"word\") { return cm.findWordAt(pos) }\n    if (unit == \"line\") { return new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))) }\n    var result = unit(cm, pos);\n    return new Range(result.from, result.to)\n  }\n\n  // Normal selection, as opposed to text dragging.\n  function leftButtonSelect(cm, event, start, behavior) {\n    var display = cm.display, doc = cm.doc;\n    e_preventDefault(event);\n\n    var ourRange, ourIndex, startSel = doc.sel, ranges = startSel.ranges;\n    if (behavior.addNew && !behavior.extend) {\n      ourIndex = doc.sel.contains(start);\n      if (ourIndex > -1)\n        { ourRange = ranges[ourIndex]; }\n      else\n        { ourRange = new Range(start, start); }\n    } else {\n      ourRange = doc.sel.primary();\n      ourIndex = doc.sel.primIndex;\n    }\n\n    if (behavior.unit == \"rectangle\") {\n      if (!behavior.addNew) { ourRange = new Range(start, start); }\n      start = posFromMouse(cm, event, true, true);\n      ourIndex = -1;\n    } else {\n      var range = rangeForUnit(cm, start, behavior.unit);\n      if (behavior.extend)\n        { ourRange = extendRange(ourRange, range.anchor, range.head, behavior.extend); }\n      else\n        { ourRange = range; }\n    }\n\n    if (!behavior.addNew) {\n      ourIndex = 0;\n      setSelection(doc, new Selection([ourRange], 0), sel_mouse);\n      startSel = doc.sel;\n    } else if (ourIndex == -1) {\n      ourIndex = ranges.length;\n      setSelection(doc, normalizeSelection(cm, ranges.concat([ourRange]), ourIndex),\n                   {scroll: false, origin: \"*mouse\"});\n    } else if (ranges.length > 1 && ranges[ourIndex].empty() && behavior.unit == \"char\" && !behavior.extend) {\n      setSelection(doc, normalizeSelection(cm, ranges.slice(0, ourIndex).concat(ranges.slice(ourIndex + 1)), 0),\n                   {scroll: false, origin: \"*mouse\"});\n      startSel = doc.sel;\n    } else {\n      replaceOneSelection(doc, ourIndex, ourRange, sel_mouse);\n    }\n\n    var lastPos = start;\n    function extendTo(pos) {\n      if (cmp(lastPos, pos) == 0) { return }\n      lastPos = pos;\n\n      if (behavior.unit == \"rectangle\") {\n        var ranges = [], tabSize = cm.options.tabSize;\n        var startCol = countColumn(getLine(doc, start.line).text, start.ch, tabSize);\n        var posCol = countColumn(getLine(doc, pos.line).text, pos.ch, tabSize);\n        var left = Math.min(startCol, posCol), right = Math.max(startCol, posCol);\n        for (var line = Math.min(start.line, pos.line), end = Math.min(cm.lastLine(), Math.max(start.line, pos.line));\n             line <= end; line++) {\n          var text = getLine(doc, line).text, leftPos = findColumn(text, left, tabSize);\n          if (left == right)\n            { ranges.push(new Range(Pos(line, leftPos), Pos(line, leftPos))); }\n          else if (text.length > leftPos)\n            { ranges.push(new Range(Pos(line, leftPos), Pos(line, findColumn(text, right, tabSize)))); }\n        }\n        if (!ranges.length) { ranges.push(new Range(start, start)); }\n        setSelection(doc, normalizeSelection(cm, startSel.ranges.slice(0, ourIndex).concat(ranges), ourIndex),\n                     {origin: \"*mouse\", scroll: false});\n        cm.scrollIntoView(pos);\n      } else {\n        var oldRange = ourRange;\n        var range = rangeForUnit(cm, pos, behavior.unit);\n        var anchor = oldRange.anchor, head;\n        if (cmp(range.anchor, anchor) > 0) {\n          head = range.head;\n          anchor = minPos(oldRange.from(), range.anchor);\n        } else {\n          head = range.anchor;\n          anchor = maxPos(oldRange.to(), range.head);\n        }\n        var ranges$1 = startSel.ranges.slice(0);\n        ranges$1[ourIndex] = bidiSimplify(cm, new Range(clipPos(doc, anchor), head));\n        setSelection(doc, normalizeSelection(cm, ranges$1, ourIndex), sel_mouse);\n      }\n    }\n\n    var editorSize = display.wrapper.getBoundingClientRect();\n    // Used to ensure timeout re-tries don't fire when another extend\n    // happened in the meantime (clearTimeout isn't reliable -- at\n    // least on Chrome, the timeouts still happen even when cleared,\n    // if the clear happens after their scheduled firing time).\n    var counter = 0;\n\n    function extend(e) {\n      var curCount = ++counter;\n      var cur = posFromMouse(cm, e, true, behavior.unit == \"rectangle\");\n      if (!cur) { return }\n      if (cmp(cur, lastPos) != 0) {\n        cm.curOp.focus = activeElt();\n        extendTo(cur);\n        var visible = visibleLines(display, doc);\n        if (cur.line >= visible.to || cur.line < visible.from)\n          { setTimeout(operation(cm, function () {if (counter == curCount) { extend(e); }}), 150); }\n      } else {\n        var outside = e.clientY < editorSize.top ? -20 : e.clientY > editorSize.bottom ? 20 : 0;\n        if (outside) { setTimeout(operation(cm, function () {\n          if (counter != curCount) { return }\n          display.scroller.scrollTop += outside;\n          extend(e);\n        }), 50); }\n      }\n    }\n\n    function done(e) {\n      cm.state.selectingText = false;\n      counter = Infinity;\n      // If e is null or undefined we interpret this as someone trying\n      // to explicitly cancel the selection rather than the user\n      // letting go of the mouse button.\n      if (e) {\n        e_preventDefault(e);\n        display.input.focus();\n      }\n      off(display.wrapper.ownerDocument, \"mousemove\", move);\n      off(display.wrapper.ownerDocument, \"mouseup\", up);\n      doc.history.lastSelOrigin = null;\n    }\n\n    var move = operation(cm, function (e) {\n      if (e.buttons === 0 || !e_button(e)) { done(e); }\n      else { extend(e); }\n    });\n    var up = operation(cm, done);\n    cm.state.selectingText = up;\n    on(display.wrapper.ownerDocument, \"mousemove\", move);\n    on(display.wrapper.ownerDocument, \"mouseup\", up);\n  }\n\n  // Used when mouse-selecting to adjust the anchor to the proper side\n  // of a bidi jump depending on the visual position of the head.\n  function bidiSimplify(cm, range) {\n    var anchor = range.anchor;\n    var head = range.head;\n    var anchorLine = getLine(cm.doc, anchor.line);\n    if (cmp(anchor, head) == 0 && anchor.sticky == head.sticky) { return range }\n    var order = getOrder(anchorLine);\n    if (!order) { return range }\n    var index = getBidiPartAt(order, anchor.ch, anchor.sticky), part = order[index];\n    if (part.from != anchor.ch && part.to != anchor.ch) { return range }\n    var boundary = index + ((part.from == anchor.ch) == (part.level != 1) ? 0 : 1);\n    if (boundary == 0 || boundary == order.length) { return range }\n\n    // Compute the relative visual position of the head compared to the\n    // anchor (<0 is to the left, >0 to the right)\n    var leftSide;\n    if (head.line != anchor.line) {\n      leftSide = (head.line - anchor.line) * (cm.doc.direction == \"ltr\" ? 1 : -1) > 0;\n    } else {\n      var headIndex = getBidiPartAt(order, head.ch, head.sticky);\n      var dir = headIndex - index || (head.ch - anchor.ch) * (part.level == 1 ? -1 : 1);\n      if (headIndex == boundary - 1 || headIndex == boundary)\n        { leftSide = dir < 0; }\n      else\n        { leftSide = dir > 0; }\n    }\n\n    var usePart = order[boundary + (leftSide ? -1 : 0)];\n    var from = leftSide == (usePart.level == 1);\n    var ch = from ? usePart.from : usePart.to, sticky = from ? \"after\" : \"before\";\n    return anchor.ch == ch && anchor.sticky == sticky ? range : new Range(new Pos(anchor.line, ch, sticky), head)\n  }\n\n\n  // Determines whether an event happened in the gutter, and fires the\n  // handlers for the corresponding event.\n  function gutterEvent(cm, e, type, prevent) {\n    var mX, mY;\n    if (e.touches) {\n      mX = e.touches[0].clientX;\n      mY = e.touches[0].clientY;\n    } else {\n      try { mX = e.clientX; mY = e.clientY; }\n      catch(e$1) { return false }\n    }\n    if (mX >= Math.floor(cm.display.gutters.getBoundingClientRect().right)) { return false }\n    if (prevent) { e_preventDefault(e); }\n\n    var display = cm.display;\n    var lineBox = display.lineDiv.getBoundingClientRect();\n\n    if (mY > lineBox.bottom || !hasHandler(cm, type)) { return e_defaultPrevented(e) }\n    mY -= lineBox.top - display.viewOffset;\n\n    for (var i = 0; i < cm.display.gutterSpecs.length; ++i) {\n      var g = display.gutters.childNodes[i];\n      if (g && g.getBoundingClientRect().right >= mX) {\n        var line = lineAtHeight(cm.doc, mY);\n        var gutter = cm.display.gutterSpecs[i];\n        signal(cm, type, cm, line, gutter.className, e);\n        return e_defaultPrevented(e)\n      }\n    }\n  }\n\n  function clickInGutter(cm, e) {\n    return gutterEvent(cm, e, \"gutterClick\", true)\n  }\n\n  // CONTEXT MENU HANDLING\n\n  // To make the context menu work, we need to briefly unhide the\n  // textarea (making it as unobtrusive as possible) to let the\n  // right-click take effect on it.\n  function onContextMenu(cm, e) {\n    if (eventInWidget(cm.display, e) || contextMenuInGutter(cm, e)) { return }\n    if (signalDOMEvent(cm, e, \"contextmenu\")) { return }\n    if (!captureRightClick) { cm.display.input.onContextMenu(e); }\n  }\n\n  function contextMenuInGutter(cm, e) {\n    if (!hasHandler(cm, \"gutterContextMenu\")) { return false }\n    return gutterEvent(cm, e, \"gutterContextMenu\", false)\n  }\n\n  function themeChanged(cm) {\n    cm.display.wrapper.className = cm.display.wrapper.className.replace(/\\s*cm-s-\\S+/g, \"\") +\n      cm.options.theme.replace(/(^|\\s)\\s*/g, \" cm-s-\");\n    clearCaches(cm);\n  }\n\n  var Init = {toString: function(){return \"CodeMirror.Init\"}};\n\n  var defaults = {};\n  var optionHandlers = {};\n\n  function defineOptions(CodeMirror) {\n    var optionHandlers = CodeMirror.optionHandlers;\n\n    function option(name, deflt, handle, notOnInit) {\n      CodeMirror.defaults[name] = deflt;\n      if (handle) { optionHandlers[name] =\n        notOnInit ? function (cm, val, old) {if (old != Init) { handle(cm, val, old); }} : handle; }\n    }\n\n    CodeMirror.defineOption = option;\n\n    // Passed to option handlers when there is no old value.\n    CodeMirror.Init = Init;\n\n    // These two are, on init, called from the constructor because they\n    // have to be initialized before the editor can start at all.\n    option(\"value\", \"\", function (cm, val) { return cm.setValue(val); }, true);\n    option(\"mode\", null, function (cm, val) {\n      cm.doc.modeOption = val;\n      loadMode(cm);\n    }, true);\n\n    option(\"indentUnit\", 2, loadMode, true);\n    option(\"indentWithTabs\", false);\n    option(\"smartIndent\", true);\n    option(\"tabSize\", 4, function (cm) {\n      resetModeState(cm);\n      clearCaches(cm);\n      regChange(cm);\n    }, true);\n\n    option(\"lineSeparator\", null, function (cm, val) {\n      cm.doc.lineSep = val;\n      if (!val) { return }\n      var newBreaks = [], lineNo = cm.doc.first;\n      cm.doc.iter(function (line) {\n        for (var pos = 0;;) {\n          var found = line.text.indexOf(val, pos);\n          if (found == -1) { break }\n          pos = found + val.length;\n          newBreaks.push(Pos(lineNo, found));\n        }\n        lineNo++;\n      });\n      for (var i = newBreaks.length - 1; i >= 0; i--)\n        { replaceRange(cm.doc, val, newBreaks[i], Pos(newBreaks[i].line, newBreaks[i].ch + val.length)); }\n    });\n    option(\"specialChars\", /[\\u0000-\\u001f\\u007f-\\u009f\\u00ad\\u061c\\u200b-\\u200c\\u200e\\u200f\\u2028\\u2029\\ufeff\\ufff9-\\ufffc]/g, function (cm, val, old) {\n      cm.state.specialChars = new RegExp(val.source + (val.test(\"\\t\") ? \"\" : \"|\\t\"), \"g\");\n      if (old != Init) { cm.refresh(); }\n    });\n    option(\"specialCharPlaceholder\", defaultSpecialCharPlaceholder, function (cm) { return cm.refresh(); }, true);\n    option(\"electricChars\", true);\n    option(\"inputStyle\", mobile ? \"contenteditable\" : \"textarea\", function () {\n      throw new Error(\"inputStyle can not (yet) be changed in a running editor\") // FIXME\n    }, true);\n    option(\"spellcheck\", false, function (cm, val) { return cm.getInputField().spellcheck = val; }, true);\n    option(\"autocorrect\", false, function (cm, val) { return cm.getInputField().autocorrect = val; }, true);\n    option(\"autocapitalize\", false, function (cm, val) { return cm.getInputField().autocapitalize = val; }, true);\n    option(\"rtlMoveVisually\", !windows);\n    option(\"wholeLineUpdateBefore\", true);\n\n    option(\"theme\", \"default\", function (cm) {\n      themeChanged(cm);\n      updateGutters(cm);\n    }, true);\n    option(\"keyMap\", \"default\", function (cm, val, old) {\n      var next = getKeyMap(val);\n      var prev = old != Init && getKeyMap(old);\n      if (prev && prev.detach) { prev.detach(cm, next); }\n      if (next.attach) { next.attach(cm, prev || null); }\n    });\n    option(\"extraKeys\", null);\n    option(\"configureMouse\", null);\n\n    option(\"lineWrapping\", false, wrappingChanged, true);\n    option(\"gutters\", [], function (cm, val) {\n      cm.display.gutterSpecs = getGutters(val, cm.options.lineNumbers);\n      updateGutters(cm);\n    }, true);\n    option(\"fixedGutter\", true, function (cm, val) {\n      cm.display.gutters.style.left = val ? compensateForHScroll(cm.display) + \"px\" : \"0\";\n      cm.refresh();\n    }, true);\n    option(\"coverGutterNextToScrollbar\", false, function (cm) { return updateScrollbars(cm); }, true);\n    option(\"scrollbarStyle\", \"native\", function (cm) {\n      initScrollbars(cm);\n      updateScrollbars(cm);\n      cm.display.scrollbars.setScrollTop(cm.doc.scrollTop);\n      cm.display.scrollbars.setScrollLeft(cm.doc.scrollLeft);\n    }, true);\n    option(\"lineNumbers\", false, function (cm, val) {\n      cm.display.gutterSpecs = getGutters(cm.options.gutters, val);\n      updateGutters(cm);\n    }, true);\n    option(\"firstLineNumber\", 1, updateGutters, true);\n    option(\"lineNumberFormatter\", function (integer) { return integer; }, updateGutters, true);\n    option(\"showCursorWhenSelecting\", false, updateSelection, true);\n\n    option(\"resetSelectionOnContextMenu\", true);\n    option(\"lineWiseCopyCut\", true);\n    option(\"pasteLinesPerSelection\", true);\n    option(\"selectionsMayTouch\", false);\n\n    option(\"readOnly\", false, function (cm, val) {\n      if (val == \"nocursor\") {\n        onBlur(cm);\n        cm.display.input.blur();\n      }\n      cm.display.input.readOnlyChanged(val);\n    });\n\n    option(\"screenReaderLabel\", null, function (cm, val) {\n      val = (val === '') ? null : val;\n      cm.display.input.screenReaderLabelChanged(val);\n    });\n\n    option(\"disableInput\", false, function (cm, val) {if (!val) { cm.display.input.reset(); }}, true);\n    option(\"dragDrop\", true, dragDropChanged);\n    option(\"allowDropFileTypes\", null);\n\n    option(\"cursorBlinkRate\", 530);\n    option(\"cursorScrollMargin\", 0);\n    option(\"cursorHeight\", 1, updateSelection, true);\n    option(\"singleCursorHeightPerLine\", true, updateSelection, true);\n    option(\"workTime\", 100);\n    option(\"workDelay\", 100);\n    option(\"flattenSpans\", true, resetModeState, true);\n    option(\"addModeClass\", false, resetModeState, true);\n    option(\"pollInterval\", 100);\n    option(\"undoDepth\", 200, function (cm, val) { return cm.doc.history.undoDepth = val; });\n    option(\"historyEventDelay\", 1250);\n    option(\"viewportMargin\", 10, function (cm) { return cm.refresh(); }, true);\n    option(\"maxHighlightLength\", 10000, resetModeState, true);\n    option(\"moveInputWithCursor\", true, function (cm, val) {\n      if (!val) { cm.display.input.resetPosition(); }\n    });\n\n    option(\"tabindex\", null, function (cm, val) { return cm.display.input.getField().tabIndex = val || \"\"; });\n    option(\"autofocus\", null);\n    option(\"direction\", \"ltr\", function (cm, val) { return cm.doc.setDirection(val); }, true);\n    option(\"phrases\", null);\n  }\n\n  function dragDropChanged(cm, value, old) {\n    var wasOn = old && old != Init;\n    if (!value != !wasOn) {\n      var funcs = cm.display.dragFunctions;\n      var toggle = value ? on : off;\n      toggle(cm.display.scroller, \"dragstart\", funcs.start);\n      toggle(cm.display.scroller, \"dragenter\", funcs.enter);\n      toggle(cm.display.scroller, \"dragover\", funcs.over);\n      toggle(cm.display.scroller, \"dragleave\", funcs.leave);\n      toggle(cm.display.scroller, \"drop\", funcs.drop);\n    }\n  }\n\n  function wrappingChanged(cm) {\n    if (cm.options.lineWrapping) {\n      addClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      cm.display.sizer.style.minWidth = \"\";\n      cm.display.sizerWidth = null;\n    } else {\n      rmClass(cm.display.wrapper, \"CodeMirror-wrap\");\n      findMaxLine(cm);\n    }\n    estimateLineHeights(cm);\n    regChange(cm);\n    clearCaches(cm);\n    setTimeout(function () { return updateScrollbars(cm); }, 100);\n  }\n\n  // A CodeMirror instance represents an editor. This is the object\n  // that user code is usually dealing with.\n\n  function CodeMirror(place, options) {\n    var this$1 = this;\n\n    if (!(this instanceof CodeMirror)) { return new CodeMirror(place, options) }\n\n    this.options = options = options ? copyObj(options) : {};\n    // Determine effective options based on given values and defaults.\n    copyObj(defaults, options, false);\n\n    var doc = options.value;\n    if (typeof doc == \"string\") { doc = new Doc(doc, options.mode, null, options.lineSeparator, options.direction); }\n    else if (options.mode) { doc.modeOption = options.mode; }\n    this.doc = doc;\n\n    var input = new CodeMirror.inputStyles[options.inputStyle](this);\n    var display = this.display = new Display(place, doc, input, options);\n    display.wrapper.CodeMirror = this;\n    themeChanged(this);\n    if (options.lineWrapping)\n      { this.display.wrapper.className += \" CodeMirror-wrap\"; }\n    initScrollbars(this);\n\n    this.state = {\n      keyMaps: [],  // stores maps added by addKeyMap\n      overlays: [], // highlighting overlays, as added by addOverlay\n      modeGen: 0,   // bumped when mode/overlay changes, used to invalidate highlighting info\n      overwrite: false,\n      delayingBlurEvent: false,\n      focused: false,\n      suppressEdits: false, // used to disable editing during key handlers when in readOnly mode\n      pasteIncoming: -1, cutIncoming: -1, // help recognize paste/cut edits in input.poll\n      selectingText: false,\n      draggingText: false,\n      highlight: new Delayed(), // stores highlight worker timeout\n      keySeq: null,  // Unfinished key sequence\n      specialChars: null\n    };\n\n    if (options.autofocus && !mobile) { display.input.focus(); }\n\n    // Override magic textarea content restore that IE sometimes does\n    // on our hidden textarea on reload\n    if (ie && ie_version < 11) { setTimeout(function () { return this$1.display.input.reset(true); }, 20); }\n\n    registerEventHandlers(this);\n    ensureGlobalHandlers();\n\n    startOperation(this);\n    this.curOp.forceUpdate = true;\n    attachDoc(this, doc);\n\n    if ((options.autofocus && !mobile) || this.hasFocus())\n      { setTimeout(function () {\n        if (this$1.hasFocus() && !this$1.state.focused) { onFocus(this$1); }\n      }, 20); }\n    else\n      { onBlur(this); }\n\n    for (var opt in optionHandlers) { if (optionHandlers.hasOwnProperty(opt))\n      { optionHandlers[opt](this, options[opt], Init); } }\n    maybeUpdateLineNumberWidth(this);\n    if (options.finishInit) { options.finishInit(this); }\n    for (var i = 0; i < initHooks.length; ++i) { initHooks[i](this); }\n    endOperation(this);\n    // Suppress optimizelegibility in Webkit, since it breaks text\n    // measuring on line wrapping boundaries.\n    if (webkit && options.lineWrapping &&\n        getComputedStyle(display.lineDiv).textRendering == \"optimizelegibility\")\n      { display.lineDiv.style.textRendering = \"auto\"; }\n  }\n\n  // The default configuration options.\n  CodeMirror.defaults = defaults;\n  // Functions to run when options are changed.\n  CodeMirror.optionHandlers = optionHandlers;\n\n  // Attach the necessary event handlers when initializing the editor\n  function registerEventHandlers(cm) {\n    var d = cm.display;\n    on(d.scroller, \"mousedown\", operation(cm, onMouseDown));\n    // Older IE's will not fire a second mousedown for a double click\n    if (ie && ie_version < 11)\n      { on(d.scroller, \"dblclick\", operation(cm, function (e) {\n        if (signalDOMEvent(cm, e)) { return }\n        var pos = posFromMouse(cm, e);\n        if (!pos || clickInGutter(cm, e) || eventInWidget(cm.display, e)) { return }\n        e_preventDefault(e);\n        var word = cm.findWordAt(pos);\n        extendSelection(cm.doc, word.anchor, word.head);\n      })); }\n    else\n      { on(d.scroller, \"dblclick\", function (e) { return signalDOMEvent(cm, e) || e_preventDefault(e); }); }\n    // Some browsers fire contextmenu *after* opening the menu, at\n    // which point we can't mess with it anymore. Context menu is\n    // handled in onMouseDown for these browsers.\n    on(d.scroller, \"contextmenu\", function (e) { return onContextMenu(cm, e); });\n    on(d.input.getField(), \"contextmenu\", function (e) {\n      if (!d.scroller.contains(e.target)) { onContextMenu(cm, e); }\n    });\n\n    // Used to suppress mouse event handling when a touch happens\n    var touchFinished, prevTouch = {end: 0};\n    function finishTouch() {\n      if (d.activeTouch) {\n        touchFinished = setTimeout(function () { return d.activeTouch = null; }, 1000);\n        prevTouch = d.activeTouch;\n        prevTouch.end = +new Date;\n      }\n    }\n    function isMouseLikeTouchEvent(e) {\n      if (e.touches.length != 1) { return false }\n      var touch = e.touches[0];\n      return touch.radiusX <= 1 && touch.radiusY <= 1\n    }\n    function farAway(touch, other) {\n      if (other.left == null) { return true }\n      var dx = other.left - touch.left, dy = other.top - touch.top;\n      return dx * dx + dy * dy > 20 * 20\n    }\n    on(d.scroller, \"touchstart\", function (e) {\n      if (!signalDOMEvent(cm, e) && !isMouseLikeTouchEvent(e) && !clickInGutter(cm, e)) {\n        d.input.ensurePolled();\n        clearTimeout(touchFinished);\n        var now = +new Date;\n        d.activeTouch = {start: now, moved: false,\n                         prev: now - prevTouch.end <= 300 ? prevTouch : null};\n        if (e.touches.length == 1) {\n          d.activeTouch.left = e.touches[0].pageX;\n          d.activeTouch.top = e.touches[0].pageY;\n        }\n      }\n    });\n    on(d.scroller, \"touchmove\", function () {\n      if (d.activeTouch) { d.activeTouch.moved = true; }\n    });\n    on(d.scroller, \"touchend\", function (e) {\n      var touch = d.activeTouch;\n      if (touch && !eventInWidget(d, e) && touch.left != null &&\n          !touch.moved && new Date - touch.start < 300) {\n        var pos = cm.coordsChar(d.activeTouch, \"page\"), range;\n        if (!touch.prev || farAway(touch, touch.prev)) // Single tap\n          { range = new Range(pos, pos); }\n        else if (!touch.prev.prev || farAway(touch, touch.prev.prev)) // Double tap\n          { range = cm.findWordAt(pos); }\n        else // Triple tap\n          { range = new Range(Pos(pos.line, 0), clipPos(cm.doc, Pos(pos.line + 1, 0))); }\n        cm.setSelection(range.anchor, range.head);\n        cm.focus();\n        e_preventDefault(e);\n      }\n      finishTouch();\n    });\n    on(d.scroller, \"touchcancel\", finishTouch);\n\n    // Sync scrolling between fake scrollbars and real scrollable\n    // area, ensure viewport is updated when scrolling.\n    on(d.scroller, \"scroll\", function () {\n      if (d.scroller.clientHeight) {\n        updateScrollTop(cm, d.scroller.scrollTop);\n        setScrollLeft(cm, d.scroller.scrollLeft, true);\n        signal(cm, \"scroll\", cm);\n      }\n    });\n\n    // Listen to wheel events in order to try and update the viewport on time.\n    on(d.scroller, \"mousewheel\", function (e) { return onScrollWheel(cm, e); });\n    on(d.scroller, \"DOMMouseScroll\", function (e) { return onScrollWheel(cm, e); });\n\n    // Prevent wrapper from ever scrolling\n    on(d.wrapper, \"scroll\", function () { return d.wrapper.scrollTop = d.wrapper.scrollLeft = 0; });\n\n    d.dragFunctions = {\n      enter: function (e) {if (!signalDOMEvent(cm, e)) { e_stop(e); }},\n      over: function (e) {if (!signalDOMEvent(cm, e)) { onDragOver(cm, e); e_stop(e); }},\n      start: function (e) { return onDragStart(cm, e); },\n      drop: operation(cm, onDrop),\n      leave: function (e) {if (!signalDOMEvent(cm, e)) { clearDragCursor(cm); }}\n    };\n\n    var inp = d.input.getField();\n    on(inp, \"keyup\", function (e) { return onKeyUp.call(cm, e); });\n    on(inp, \"keydown\", operation(cm, onKeyDown));\n    on(inp, \"keypress\", operation(cm, onKeyPress));\n    on(inp, \"focus\", function (e) { return onFocus(cm, e); });\n    on(inp, \"blur\", function (e) { return onBlur(cm, e); });\n  }\n\n  var initHooks = [];\n  CodeMirror.defineInitHook = function (f) { return initHooks.push(f); };\n\n  // Indent the given line. The how parameter can be \"smart\",\n  // \"add\"/null, \"subtract\", or \"prev\". When aggressive is false\n  // (typically set to true for forced single-line indents), empty\n  // lines are not indented, and places where the mode returns Pass\n  // are left alone.\n  function indentLine(cm, n, how, aggressive) {\n    var doc = cm.doc, state;\n    if (how == null) { how = \"add\"; }\n    if (how == \"smart\") {\n      // Fall back to \"prev\" when the mode doesn't have an indentation\n      // method.\n      if (!doc.mode.indent) { how = \"prev\"; }\n      else { state = getContextBefore(cm, n).state; }\n    }\n\n    var tabSize = cm.options.tabSize;\n    var line = getLine(doc, n), curSpace = countColumn(line.text, null, tabSize);\n    if (line.stateAfter) { line.stateAfter = null; }\n    var curSpaceString = line.text.match(/^\\s*/)[0], indentation;\n    if (!aggressive && !/\\S/.test(line.text)) {\n      indentation = 0;\n      how = \"not\";\n    } else if (how == \"smart\") {\n      indentation = doc.mode.indent(state, line.text.slice(curSpaceString.length), line.text);\n      if (indentation == Pass || indentation > 150) {\n        if (!aggressive) { return }\n        how = \"prev\";\n      }\n    }\n    if (how == \"prev\") {\n      if (n > doc.first) { indentation = countColumn(getLine(doc, n-1).text, null, tabSize); }\n      else { indentation = 0; }\n    } else if (how == \"add\") {\n      indentation = curSpace + cm.options.indentUnit;\n    } else if (how == \"subtract\") {\n      indentation = curSpace - cm.options.indentUnit;\n    } else if (typeof how == \"number\") {\n      indentation = curSpace + how;\n    }\n    indentation = Math.max(0, indentation);\n\n    var indentString = \"\", pos = 0;\n    if (cm.options.indentWithTabs)\n      { for (var i = Math.floor(indentation / tabSize); i; --i) {pos += tabSize; indentString += \"\\t\";} }\n    if (pos < indentation) { indentString += spaceStr(indentation - pos); }\n\n    if (indentString != curSpaceString) {\n      replaceRange(doc, indentString, Pos(n, 0), Pos(n, curSpaceString.length), \"+input\");\n      line.stateAfter = null;\n      return true\n    } else {\n      // Ensure that, if the cursor was in the whitespace at the start\n      // of the line, it is moved to the end of that space.\n      for (var i$1 = 0; i$1 < doc.sel.ranges.length; i$1++) {\n        var range = doc.sel.ranges[i$1];\n        if (range.head.line == n && range.head.ch < curSpaceString.length) {\n          var pos$1 = Pos(n, curSpaceString.length);\n          replaceOneSelection(doc, i$1, new Range(pos$1, pos$1));\n          break\n        }\n      }\n    }\n  }\n\n  // This will be set to a {lineWise: bool, text: [string]} object, so\n  // that, when pasting, we know what kind of selections the copied\n  // text was made out of.\n  var lastCopied = null;\n\n  function setLastCopied(newLastCopied) {\n    lastCopied = newLastCopied;\n  }\n\n  function applyTextInput(cm, inserted, deleted, sel, origin) {\n    var doc = cm.doc;\n    cm.display.shift = false;\n    if (!sel) { sel = doc.sel; }\n\n    var recent = +new Date - 200;\n    var paste = origin == \"paste\" || cm.state.pasteIncoming > recent;\n    var textLines = splitLinesAuto(inserted), multiPaste = null;\n    // When pasting N lines into N selections, insert one line per selection\n    if (paste && sel.ranges.length > 1) {\n      if (lastCopied && lastCopied.text.join(\"\\n\") == inserted) {\n        if (sel.ranges.length % lastCopied.text.length == 0) {\n          multiPaste = [];\n          for (var i = 0; i < lastCopied.text.length; i++)\n            { multiPaste.push(doc.splitLines(lastCopied.text[i])); }\n        }\n      } else if (textLines.length == sel.ranges.length && cm.options.pasteLinesPerSelection) {\n        multiPaste = map(textLines, function (l) { return [l]; });\n      }\n    }\n\n    var updateInput = cm.curOp.updateInput;\n    // Normal behavior is to insert the new text into every selection\n    for (var i$1 = sel.ranges.length - 1; i$1 >= 0; i$1--) {\n      var range = sel.ranges[i$1];\n      var from = range.from(), to = range.to();\n      if (range.empty()) {\n        if (deleted && deleted > 0) // Handle deletion\n          { from = Pos(from.line, from.ch - deleted); }\n        else if (cm.state.overwrite && !paste) // Handle overwrite\n          { to = Pos(to.line, Math.min(getLine(doc, to.line).text.length, to.ch + lst(textLines).length)); }\n        else if (paste && lastCopied && lastCopied.lineWise && lastCopied.text.join(\"\\n\") == textLines.join(\"\\n\"))\n          { from = to = Pos(from.line, 0); }\n      }\n      var changeEvent = {from: from, to: to, text: multiPaste ? multiPaste[i$1 % multiPaste.length] : textLines,\n                         origin: origin || (paste ? \"paste\" : cm.state.cutIncoming > recent ? \"cut\" : \"+input\")};\n      makeChange(cm.doc, changeEvent);\n      signalLater(cm, \"inputRead\", cm, changeEvent);\n    }\n    if (inserted && !paste)\n      { triggerElectric(cm, inserted); }\n\n    ensureCursorVisible(cm);\n    if (cm.curOp.updateInput < 2) { cm.curOp.updateInput = updateInput; }\n    cm.curOp.typing = true;\n    cm.state.pasteIncoming = cm.state.cutIncoming = -1;\n  }\n\n  function handlePaste(e, cm) {\n    var pasted = e.clipboardData && e.clipboardData.getData(\"Text\");\n    if (pasted) {\n      e.preventDefault();\n      if (!cm.isReadOnly() && !cm.options.disableInput)\n        { runInOp(cm, function () { return applyTextInput(cm, pasted, 0, null, \"paste\"); }); }\n      return true\n    }\n  }\n\n  function triggerElectric(cm, inserted) {\n    // When an 'electric' character is inserted, immediately trigger a reindent\n    if (!cm.options.electricChars || !cm.options.smartIndent) { return }\n    var sel = cm.doc.sel;\n\n    for (var i = sel.ranges.length - 1; i >= 0; i--) {\n      var range = sel.ranges[i];\n      if (range.head.ch > 100 || (i && sel.ranges[i - 1].head.line == range.head.line)) { continue }\n      var mode = cm.getModeAt(range.head);\n      var indented = false;\n      if (mode.electricChars) {\n        for (var j = 0; j < mode.electricChars.length; j++)\n          { if (inserted.indexOf(mode.electricChars.charAt(j)) > -1) {\n            indented = indentLine(cm, range.head.line, \"smart\");\n            break\n          } }\n      } else if (mode.electricInput) {\n        if (mode.electricInput.test(getLine(cm.doc, range.head.line).text.slice(0, range.head.ch)))\n          { indented = indentLine(cm, range.head.line, \"smart\"); }\n      }\n      if (indented) { signalLater(cm, \"electricInput\", cm, range.head.line); }\n    }\n  }\n\n  function copyableRanges(cm) {\n    var text = [], ranges = [];\n    for (var i = 0; i < cm.doc.sel.ranges.length; i++) {\n      var line = cm.doc.sel.ranges[i].head.line;\n      var lineRange = {anchor: Pos(line, 0), head: Pos(line + 1, 0)};\n      ranges.push(lineRange);\n      text.push(cm.getRange(lineRange.anchor, lineRange.head));\n    }\n    return {text: text, ranges: ranges}\n  }\n\n  function disableBrowserMagic(field, spellcheck, autocorrect, autocapitalize) {\n    field.setAttribute(\"autocorrect\", autocorrect ? \"\" : \"off\");\n    field.setAttribute(\"autocapitalize\", autocapitalize ? \"\" : \"off\");\n    field.setAttribute(\"spellcheck\", !!spellcheck);\n  }\n\n  function hiddenTextarea() {\n    var te = elt(\"textarea\", null, null, \"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none\");\n    var div = elt(\"div\", [te], null, \"overflow: hidden; position: relative; width: 3px; height: 0px;\");\n    // The textarea is kept positioned near the cursor to prevent the\n    // fact that it'll be scrolled into view on input from scrolling\n    // our fake cursor out of view. On webkit, when wrap=off, paste is\n    // very slow. So make the area wide instead.\n    if (webkit) { te.style.width = \"1000px\"; }\n    else { te.setAttribute(\"wrap\", \"off\"); }\n    // If border: 0; -- iOS fails to open keyboard (issue #1287)\n    if (ios) { te.style.border = \"1px solid black\"; }\n    disableBrowserMagic(te);\n    return div\n  }\n\n  // The publicly visible API. Note that methodOp(f) means\n  // 'wrap f in an operation, performed on its `this` parameter'.\n\n  // This is not the complete set of editor methods. Most of the\n  // methods defined on the Doc type are also injected into\n  // CodeMirror.prototype, for backwards compatibility and\n  // convenience.\n\n  function addEditorMethods(CodeMirror) {\n    var optionHandlers = CodeMirror.optionHandlers;\n\n    var helpers = CodeMirror.helpers = {};\n\n    CodeMirror.prototype = {\n      constructor: CodeMirror,\n      focus: function(){window.focus(); this.display.input.focus();},\n\n      setOption: function(option, value) {\n        var options = this.options, old = options[option];\n        if (options[option] == value && option != \"mode\") { return }\n        options[option] = value;\n        if (optionHandlers.hasOwnProperty(option))\n          { operation(this, optionHandlers[option])(this, value, old); }\n        signal(this, \"optionChange\", this, option);\n      },\n\n      getOption: function(option) {return this.options[option]},\n      getDoc: function() {return this.doc},\n\n      addKeyMap: function(map, bottom) {\n        this.state.keyMaps[bottom ? \"push\" : \"unshift\"](getKeyMap(map));\n      },\n      removeKeyMap: function(map) {\n        var maps = this.state.keyMaps;\n        for (var i = 0; i < maps.length; ++i)\n          { if (maps[i] == map || maps[i].name == map) {\n            maps.splice(i, 1);\n            return true\n          } }\n      },\n\n      addOverlay: methodOp(function(spec, options) {\n        var mode = spec.token ? spec : CodeMirror.getMode(this.options, spec);\n        if (mode.startState) { throw new Error(\"Overlays may not be stateful.\") }\n        insertSorted(this.state.overlays,\n                     {mode: mode, modeSpec: spec, opaque: options && options.opaque,\n                      priority: (options && options.priority) || 0},\n                     function (overlay) { return overlay.priority; });\n        this.state.modeGen++;\n        regChange(this);\n      }),\n      removeOverlay: methodOp(function(spec) {\n        var overlays = this.state.overlays;\n        for (var i = 0; i < overlays.length; ++i) {\n          var cur = overlays[i].modeSpec;\n          if (cur == spec || typeof spec == \"string\" && cur.name == spec) {\n            overlays.splice(i, 1);\n            this.state.modeGen++;\n            regChange(this);\n            return\n          }\n        }\n      }),\n\n      indentLine: methodOp(function(n, dir, aggressive) {\n        if (typeof dir != \"string\" && typeof dir != \"number\") {\n          if (dir == null) { dir = this.options.smartIndent ? \"smart\" : \"prev\"; }\n          else { dir = dir ? \"add\" : \"subtract\"; }\n        }\n        if (isLine(this.doc, n)) { indentLine(this, n, dir, aggressive); }\n      }),\n      indentSelection: methodOp(function(how) {\n        var ranges = this.doc.sel.ranges, end = -1;\n        for (var i = 0; i < ranges.length; i++) {\n          var range = ranges[i];\n          if (!range.empty()) {\n            var from = range.from(), to = range.to();\n            var start = Math.max(end, from.line);\n            end = Math.min(this.lastLine(), to.line - (to.ch ? 0 : 1)) + 1;\n            for (var j = start; j < end; ++j)\n              { indentLine(this, j, how); }\n            var newRanges = this.doc.sel.ranges;\n            if (from.ch == 0 && ranges.length == newRanges.length && newRanges[i].from().ch > 0)\n              { replaceOneSelection(this.doc, i, new Range(from, newRanges[i].to()), sel_dontScroll); }\n          } else if (range.head.line > end) {\n            indentLine(this, range.head.line, how, true);\n            end = range.head.line;\n            if (i == this.doc.sel.primIndex) { ensureCursorVisible(this); }\n          }\n        }\n      }),\n\n      // Fetch the parser token for a given character. Useful for hacks\n      // that want to inspect the mode state (say, for completion).\n      getTokenAt: function(pos, precise) {\n        return takeToken(this, pos, precise)\n      },\n\n      getLineTokens: function(line, precise) {\n        return takeToken(this, Pos(line), precise, true)\n      },\n\n      getTokenTypeAt: function(pos) {\n        pos = clipPos(this.doc, pos);\n        var styles = getLineStyles(this, getLine(this.doc, pos.line));\n        var before = 0, after = (styles.length - 1) / 2, ch = pos.ch;\n        var type;\n        if (ch == 0) { type = styles[2]; }\n        else { for (;;) {\n          var mid = (before + after) >> 1;\n          if ((mid ? styles[mid * 2 - 1] : 0) >= ch) { after = mid; }\n          else if (styles[mid * 2 + 1] < ch) { before = mid + 1; }\n          else { type = styles[mid * 2 + 2]; break }\n        } }\n        var cut = type ? type.indexOf(\"overlay \") : -1;\n        return cut < 0 ? type : cut == 0 ? null : type.slice(0, cut - 1)\n      },\n\n      getModeAt: function(pos) {\n        var mode = this.doc.mode;\n        if (!mode.innerMode) { return mode }\n        return CodeMirror.innerMode(mode, this.getTokenAt(pos).state).mode\n      },\n\n      getHelper: function(pos, type) {\n        return this.getHelpers(pos, type)[0]\n      },\n\n      getHelpers: function(pos, type) {\n        var found = [];\n        if (!helpers.hasOwnProperty(type)) { return found }\n        var help = helpers[type], mode = this.getModeAt(pos);\n        if (typeof mode[type] == \"string\") {\n          if (help[mode[type]]) { found.push(help[mode[type]]); }\n        } else if (mode[type]) {\n          for (var i = 0; i < mode[type].length; i++) {\n            var val = help[mode[type][i]];\n            if (val) { found.push(val); }\n          }\n        } else if (mode.helperType && help[mode.helperType]) {\n          found.push(help[mode.helperType]);\n        } else if (help[mode.name]) {\n          found.push(help[mode.name]);\n        }\n        for (var i$1 = 0; i$1 < help._global.length; i$1++) {\n          var cur = help._global[i$1];\n          if (cur.pred(mode, this) && indexOf(found, cur.val) == -1)\n            { found.push(cur.val); }\n        }\n        return found\n      },\n\n      getStateAfter: function(line, precise) {\n        var doc = this.doc;\n        line = clipLine(doc, line == null ? doc.first + doc.size - 1: line);\n        return getContextBefore(this, line + 1, precise).state\n      },\n\n      cursorCoords: function(start, mode) {\n        var pos, range = this.doc.sel.primary();\n        if (start == null) { pos = range.head; }\n        else if (typeof start == \"object\") { pos = clipPos(this.doc, start); }\n        else { pos = start ? range.from() : range.to(); }\n        return cursorCoords(this, pos, mode || \"page\")\n      },\n\n      charCoords: function(pos, mode) {\n        return charCoords(this, clipPos(this.doc, pos), mode || \"page\")\n      },\n\n      coordsChar: function(coords, mode) {\n        coords = fromCoordSystem(this, coords, mode || \"page\");\n        return coordsChar(this, coords.left, coords.top)\n      },\n\n      lineAtHeight: function(height, mode) {\n        height = fromCoordSystem(this, {top: height, left: 0}, mode || \"page\").top;\n        return lineAtHeight(this.doc, height + this.display.viewOffset)\n      },\n      heightAtLine: function(line, mode, includeWidgets) {\n        var end = false, lineObj;\n        if (typeof line == \"number\") {\n          var last = this.doc.first + this.doc.size - 1;\n          if (line < this.doc.first) { line = this.doc.first; }\n          else if (line > last) { line = last; end = true; }\n          lineObj = getLine(this.doc, line);\n        } else {\n          lineObj = line;\n        }\n        return intoCoordSystem(this, lineObj, {top: 0, left: 0}, mode || \"page\", includeWidgets || end).top +\n          (end ? this.doc.height - heightAtLine(lineObj) : 0)\n      },\n\n      defaultTextHeight: function() { return textHeight(this.display) },\n      defaultCharWidth: function() { return charWidth(this.display) },\n\n      getViewport: function() { return {from: this.display.viewFrom, to: this.display.viewTo}},\n\n      addWidget: function(pos, node, scroll, vert, horiz) {\n        var display = this.display;\n        pos = cursorCoords(this, clipPos(this.doc, pos));\n        var top = pos.bottom, left = pos.left;\n        node.style.position = \"absolute\";\n        node.setAttribute(\"cm-ignore-events\", \"true\");\n        this.display.input.setUneditable(node);\n        display.sizer.appendChild(node);\n        if (vert == \"over\") {\n          top = pos.top;\n        } else if (vert == \"above\" || vert == \"near\") {\n          var vspace = Math.max(display.wrapper.clientHeight, this.doc.height),\n          hspace = Math.max(display.sizer.clientWidth, display.lineSpace.clientWidth);\n          // Default to positioning above (if specified and possible); otherwise default to positioning below\n          if ((vert == 'above' || pos.bottom + node.offsetHeight > vspace) && pos.top > node.offsetHeight)\n            { top = pos.top - node.offsetHeight; }\n          else if (pos.bottom + node.offsetHeight <= vspace)\n            { top = pos.bottom; }\n          if (left + node.offsetWidth > hspace)\n            { left = hspace - node.offsetWidth; }\n        }\n        node.style.top = top + \"px\";\n        node.style.left = node.style.right = \"\";\n        if (horiz == \"right\") {\n          left = display.sizer.clientWidth - node.offsetWidth;\n          node.style.right = \"0px\";\n        } else {\n          if (horiz == \"left\") { left = 0; }\n          else if (horiz == \"middle\") { left = (display.sizer.clientWidth - node.offsetWidth) / 2; }\n          node.style.left = left + \"px\";\n        }\n        if (scroll)\n          { scrollIntoView(this, {left: left, top: top, right: left + node.offsetWidth, bottom: top + node.offsetHeight}); }\n      },\n\n      triggerOnKeyDown: methodOp(onKeyDown),\n      triggerOnKeyPress: methodOp(onKeyPress),\n      triggerOnKeyUp: onKeyUp,\n      triggerOnMouseDown: methodOp(onMouseDown),\n\n      execCommand: function(cmd) {\n        if (commands.hasOwnProperty(cmd))\n          { return commands[cmd].call(null, this) }\n      },\n\n      triggerElectric: methodOp(function(text) { triggerElectric(this, text); }),\n\n      findPosH: function(from, amount, unit, visually) {\n        var dir = 1;\n        if (amount < 0) { dir = -1; amount = -amount; }\n        var cur = clipPos(this.doc, from);\n        for (var i = 0; i < amount; ++i) {\n          cur = findPosH(this.doc, cur, dir, unit, visually);\n          if (cur.hitSide) { break }\n        }\n        return cur\n      },\n\n      moveH: methodOp(function(dir, unit) {\n        var this$1 = this;\n\n        this.extendSelectionsBy(function (range) {\n          if (this$1.display.shift || this$1.doc.extend || range.empty())\n            { return findPosH(this$1.doc, range.head, dir, unit, this$1.options.rtlMoveVisually) }\n          else\n            { return dir < 0 ? range.from() : range.to() }\n        }, sel_move);\n      }),\n\n      deleteH: methodOp(function(dir, unit) {\n        var sel = this.doc.sel, doc = this.doc;\n        if (sel.somethingSelected())\n          { doc.replaceSelection(\"\", null, \"+delete\"); }\n        else\n          { deleteNearSelection(this, function (range) {\n            var other = findPosH(doc, range.head, dir, unit, false);\n            return dir < 0 ? {from: other, to: range.head} : {from: range.head, to: other}\n          }); }\n      }),\n\n      findPosV: function(from, amount, unit, goalColumn) {\n        var dir = 1, x = goalColumn;\n        if (amount < 0) { dir = -1; amount = -amount; }\n        var cur = clipPos(this.doc, from);\n        for (var i = 0; i < amount; ++i) {\n          var coords = cursorCoords(this, cur, \"div\");\n          if (x == null) { x = coords.left; }\n          else { coords.left = x; }\n          cur = findPosV(this, coords, dir, unit);\n          if (cur.hitSide) { break }\n        }\n        return cur\n      },\n\n      moveV: methodOp(function(dir, unit) {\n        var this$1 = this;\n\n        var doc = this.doc, goals = [];\n        var collapse = !this.display.shift && !doc.extend && doc.sel.somethingSelected();\n        doc.extendSelectionsBy(function (range) {\n          if (collapse)\n            { return dir < 0 ? range.from() : range.to() }\n          var headPos = cursorCoords(this$1, range.head, \"div\");\n          if (range.goalColumn != null) { headPos.left = range.goalColumn; }\n          goals.push(headPos.left);\n          var pos = findPosV(this$1, headPos, dir, unit);\n          if (unit == \"page\" && range == doc.sel.primary())\n            { addToScrollTop(this$1, charCoords(this$1, pos, \"div\").top - headPos.top); }\n          return pos\n        }, sel_move);\n        if (goals.length) { for (var i = 0; i < doc.sel.ranges.length; i++)\n          { doc.sel.ranges[i].goalColumn = goals[i]; } }\n      }),\n\n      // Find the word at the given position (as returned by coordsChar).\n      findWordAt: function(pos) {\n        var doc = this.doc, line = getLine(doc, pos.line).text;\n        var start = pos.ch, end = pos.ch;\n        if (line) {\n          var helper = this.getHelper(pos, \"wordChars\");\n          if ((pos.sticky == \"before\" || end == line.length) && start) { --start; } else { ++end; }\n          var startChar = line.charAt(start);\n          var check = isWordChar(startChar, helper)\n            ? function (ch) { return isWordChar(ch, helper); }\n            : /\\s/.test(startChar) ? function (ch) { return /\\s/.test(ch); }\n            : function (ch) { return (!/\\s/.test(ch) && !isWordChar(ch)); };\n          while (start > 0 && check(line.charAt(start - 1))) { --start; }\n          while (end < line.length && check(line.charAt(end))) { ++end; }\n        }\n        return new Range(Pos(pos.line, start), Pos(pos.line, end))\n      },\n\n      toggleOverwrite: function(value) {\n        if (value != null && value == this.state.overwrite) { return }\n        if (this.state.overwrite = !this.state.overwrite)\n          { addClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n        else\n          { rmClass(this.display.cursorDiv, \"CodeMirror-overwrite\"); }\n\n        signal(this, \"overwriteToggle\", this, this.state.overwrite);\n      },\n      hasFocus: function() { return this.display.input.getField() == activeElt() },\n      isReadOnly: function() { return !!(this.options.readOnly || this.doc.cantEdit) },\n\n      scrollTo: methodOp(function (x, y) { scrollToCoords(this, x, y); }),\n      getScrollInfo: function() {\n        var scroller = this.display.scroller;\n        return {left: scroller.scrollLeft, top: scroller.scrollTop,\n                height: scroller.scrollHeight - scrollGap(this) - this.display.barHeight,\n                width: scroller.scrollWidth - scrollGap(this) - this.display.barWidth,\n                clientHeight: displayHeight(this), clientWidth: displayWidth(this)}\n      },\n\n      scrollIntoView: methodOp(function(range, margin) {\n        if (range == null) {\n          range = {from: this.doc.sel.primary().head, to: null};\n          if (margin == null) { margin = this.options.cursorScrollMargin; }\n        } else if (typeof range == \"number\") {\n          range = {from: Pos(range, 0), to: null};\n        } else if (range.from == null) {\n          range = {from: range, to: null};\n        }\n        if (!range.to) { range.to = range.from; }\n        range.margin = margin || 0;\n\n        if (range.from.line != null) {\n          scrollToRange(this, range);\n        } else {\n          scrollToCoordsRange(this, range.from, range.to, range.margin);\n        }\n      }),\n\n      setSize: methodOp(function(width, height) {\n        var this$1 = this;\n\n        var interpret = function (val) { return typeof val == \"number\" || /^\\d+$/.test(String(val)) ? val + \"px\" : val; };\n        if (width != null) { this.display.wrapper.style.width = interpret(width); }\n        if (height != null) { this.display.wrapper.style.height = interpret(height); }\n        if (this.options.lineWrapping) { clearLineMeasurementCache(this); }\n        var lineNo = this.display.viewFrom;\n        this.doc.iter(lineNo, this.display.viewTo, function (line) {\n          if (line.widgets) { for (var i = 0; i < line.widgets.length; i++)\n            { if (line.widgets[i].noHScroll) { regLineChange(this$1, lineNo, \"widget\"); break } } }\n          ++lineNo;\n        });\n        this.curOp.forceUpdate = true;\n        signal(this, \"refresh\", this);\n      }),\n\n      operation: function(f){return runInOp(this, f)},\n      startOperation: function(){return startOperation(this)},\n      endOperation: function(){return endOperation(this)},\n\n      refresh: methodOp(function() {\n        var oldHeight = this.display.cachedTextHeight;\n        regChange(this);\n        this.curOp.forceUpdate = true;\n        clearCaches(this);\n        scrollToCoords(this, this.doc.scrollLeft, this.doc.scrollTop);\n        updateGutterSpace(this.display);\n        if (oldHeight == null || Math.abs(oldHeight - textHeight(this.display)) > .5 || this.options.lineWrapping)\n          { estimateLineHeights(this); }\n        signal(this, \"refresh\", this);\n      }),\n\n      swapDoc: methodOp(function(doc) {\n        var old = this.doc;\n        old.cm = null;\n        // Cancel the current text selection if any (#5821)\n        if (this.state.selectingText) { this.state.selectingText(); }\n        attachDoc(this, doc);\n        clearCaches(this);\n        this.display.input.reset();\n        scrollToCoords(this, doc.scrollLeft, doc.scrollTop);\n        this.curOp.forceScroll = true;\n        signalLater(this, \"swapDoc\", this, old);\n        return old\n      }),\n\n      phrase: function(phraseText) {\n        var phrases = this.options.phrases;\n        return phrases && Object.prototype.hasOwnProperty.call(phrases, phraseText) ? phrases[phraseText] : phraseText\n      },\n\n      getInputField: function(){return this.display.input.getField()},\n      getWrapperElement: function(){return this.display.wrapper},\n      getScrollerElement: function(){return this.display.scroller},\n      getGutterElement: function(){return this.display.gutters}\n    };\n    eventMixin(CodeMirror);\n\n    CodeMirror.registerHelper = function(type, name, value) {\n      if (!helpers.hasOwnProperty(type)) { helpers[type] = CodeMirror[type] = {_global: []}; }\n      helpers[type][name] = value;\n    };\n    CodeMirror.registerGlobalHelper = function(type, name, predicate, value) {\n      CodeMirror.registerHelper(type, name, value);\n      helpers[type]._global.push({pred: predicate, val: value});\n    };\n  }\n\n  // Used for horizontal relative motion. Dir is -1 or 1 (left or\n  // right), unit can be \"codepoint\", \"char\", \"column\" (like char, but\n  // doesn't cross line boundaries), \"word\" (across next word), or\n  // \"group\" (to the start of next group of word or\n  // non-word-non-whitespace chars). The visually param controls\n  // whether, in right-to-left text, direction 1 means to move towards\n  // the next index in the string, or towards the character to the right\n  // of the current position. The resulting position will have a\n  // hitSide=true property if it reached the end of the document.\n  function findPosH(doc, pos, dir, unit, visually) {\n    var oldPos = pos;\n    var origDir = dir;\n    var lineObj = getLine(doc, pos.line);\n    var lineDir = visually && doc.direction == \"rtl\" ? -dir : dir;\n    function findNextLine() {\n      var l = pos.line + lineDir;\n      if (l < doc.first || l >= doc.first + doc.size) { return false }\n      pos = new Pos(l, pos.ch, pos.sticky);\n      return lineObj = getLine(doc, l)\n    }\n    function moveOnce(boundToLine) {\n      var next;\n      if (unit == \"codepoint\") {\n        var ch = lineObj.text.charCodeAt(pos.ch + (unit > 0 ? 0 : -1));\n        if (isNaN(ch)) { next = null; }\n        else { next = new Pos(pos.line, Math.max(0, Math.min(lineObj.text.length, pos.ch + dir * (ch >= 0xD800 && ch < 0xDC00 ? 2 : 1))),\n                            -dir); }\n      } else if (visually) {\n        next = moveVisually(doc.cm, lineObj, pos, dir);\n      } else {\n        next = moveLogically(lineObj, pos, dir);\n      }\n      if (next == null) {\n        if (!boundToLine && findNextLine())\n          { pos = endOfLine(visually, doc.cm, lineObj, pos.line, lineDir); }\n        else\n          { return false }\n      } else {\n        pos = next;\n      }\n      return true\n    }\n\n    if (unit == \"char\" || unit == \"codepoint\") {\n      moveOnce();\n    } else if (unit == \"column\") {\n      moveOnce(true);\n    } else if (unit == \"word\" || unit == \"group\") {\n      var sawType = null, group = unit == \"group\";\n      var helper = doc.cm && doc.cm.getHelper(pos, \"wordChars\");\n      for (var first = true;; first = false) {\n        if (dir < 0 && !moveOnce(!first)) { break }\n        var cur = lineObj.text.charAt(pos.ch) || \"\\n\";\n        var type = isWordChar(cur, helper) ? \"w\"\n          : group && cur == \"\\n\" ? \"n\"\n          : !group || /\\s/.test(cur) ? null\n          : \"p\";\n        if (group && !first && !type) { type = \"s\"; }\n        if (sawType && sawType != type) {\n          if (dir < 0) {dir = 1; moveOnce(); pos.sticky = \"after\";}\n          break\n        }\n\n        if (type) { sawType = type; }\n        if (dir > 0 && !moveOnce(!first)) { break }\n      }\n    }\n    var result = skipAtomic(doc, pos, oldPos, origDir, true);\n    if (equalCursorPos(oldPos, result)) { result.hitSide = true; }\n    return result\n  }\n\n  // For relative vertical movement. Dir may be -1 or 1. Unit can be\n  // \"page\" or \"line\". The resulting position will have a hitSide=true\n  // property if it reached the end of the document.\n  function findPosV(cm, pos, dir, unit) {\n    var doc = cm.doc, x = pos.left, y;\n    if (unit == \"page\") {\n      var pageSize = Math.min(cm.display.wrapper.clientHeight, window.innerHeight || document.documentElement.clientHeight);\n      var moveAmount = Math.max(pageSize - .5 * textHeight(cm.display), 3);\n      y = (dir > 0 ? pos.bottom : pos.top) + dir * moveAmount;\n\n    } else if (unit == \"line\") {\n      y = dir > 0 ? pos.bottom + 3 : pos.top - 3;\n    }\n    var target;\n    for (;;) {\n      target = coordsChar(cm, x, y);\n      if (!target.outside) { break }\n      if (dir < 0 ? y <= 0 : y >= doc.height) { target.hitSide = true; break }\n      y += dir * 5;\n    }\n    return target\n  }\n\n  // CONTENTEDITABLE INPUT STYLE\n\n  var ContentEditableInput = function(cm) {\n    this.cm = cm;\n    this.lastAnchorNode = this.lastAnchorOffset = this.lastFocusNode = this.lastFocusOffset = null;\n    this.polling = new Delayed();\n    this.composing = null;\n    this.gracePeriod = false;\n    this.readDOMTimeout = null;\n  };\n\n  ContentEditableInput.prototype.init = function (display) {\n      var this$1 = this;\n\n    var input = this, cm = input.cm;\n    var div = input.div = display.lineDiv;\n    disableBrowserMagic(div, cm.options.spellcheck, cm.options.autocorrect, cm.options.autocapitalize);\n\n    function belongsToInput(e) {\n      for (var t = e.target; t; t = t.parentNode) {\n        if (t == div) { return true }\n        if (/\\bCodeMirror-(?:line)?widget\\b/.test(t.className)) { break }\n      }\n      return false\n    }\n\n    on(div, \"paste\", function (e) {\n      if (!belongsToInput(e) || signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n      // IE doesn't fire input events, so we schedule a read for the pasted content in this way\n      if (ie_version <= 11) { setTimeout(operation(cm, function () { return this$1.updateFromDOM(); }), 20); }\n    });\n\n    on(div, \"compositionstart\", function (e) {\n      this$1.composing = {data: e.data, done: false};\n    });\n    on(div, \"compositionupdate\", function (e) {\n      if (!this$1.composing) { this$1.composing = {data: e.data, done: false}; }\n    });\n    on(div, \"compositionend\", function (e) {\n      if (this$1.composing) {\n        if (e.data != this$1.composing.data) { this$1.readFromDOMSoon(); }\n        this$1.composing.done = true;\n      }\n    });\n\n    on(div, \"touchstart\", function () { return input.forceCompositionEnd(); });\n\n    on(div, \"input\", function () {\n      if (!this$1.composing) { this$1.readFromDOMSoon(); }\n    });\n\n    function onCopyCut(e) {\n      if (!belongsToInput(e) || signalDOMEvent(cm, e)) { return }\n      if (cm.somethingSelected()) {\n        setLastCopied({lineWise: false, text: cm.getSelections()});\n        if (e.type == \"cut\") { cm.replaceSelection(\"\", null, \"cut\"); }\n      } else if (!cm.options.lineWiseCopyCut) {\n        return\n      } else {\n        var ranges = copyableRanges(cm);\n        setLastCopied({lineWise: true, text: ranges.text});\n        if (e.type == \"cut\") {\n          cm.operation(function () {\n            cm.setSelections(ranges.ranges, 0, sel_dontScroll);\n            cm.replaceSelection(\"\", null, \"cut\");\n          });\n        }\n      }\n      if (e.clipboardData) {\n        e.clipboardData.clearData();\n        var content = lastCopied.text.join(\"\\n\");\n        // iOS exposes the clipboard API, but seems to discard content inserted into it\n        e.clipboardData.setData(\"Text\", content);\n        if (e.clipboardData.getData(\"Text\") == content) {\n          e.preventDefault();\n          return\n        }\n      }\n      // Old-fashioned briefly-focus-a-textarea hack\n      var kludge = hiddenTextarea(), te = kludge.firstChild;\n      cm.display.lineSpace.insertBefore(kludge, cm.display.lineSpace.firstChild);\n      te.value = lastCopied.text.join(\"\\n\");\n      var hadFocus = document.activeElement;\n      selectInput(te);\n      setTimeout(function () {\n        cm.display.lineSpace.removeChild(kludge);\n        hadFocus.focus();\n        if (hadFocus == div) { input.showPrimarySelection(); }\n      }, 50);\n    }\n    on(div, \"copy\", onCopyCut);\n    on(div, \"cut\", onCopyCut);\n  };\n\n  ContentEditableInput.prototype.screenReaderLabelChanged = function (label) {\n    // Label for screenreaders, accessibility\n    if(label) {\n      this.div.setAttribute('aria-label', label);\n    } else {\n      this.div.removeAttribute('aria-label');\n    }\n  };\n\n  ContentEditableInput.prototype.prepareSelection = function () {\n    var result = prepareSelection(this.cm, false);\n    result.focus = document.activeElement == this.div;\n    return result\n  };\n\n  ContentEditableInput.prototype.showSelection = function (info, takeFocus) {\n    if (!info || !this.cm.display.view.length) { return }\n    if (info.focus || takeFocus) { this.showPrimarySelection(); }\n    this.showMultipleSelections(info);\n  };\n\n  ContentEditableInput.prototype.getSelection = function () {\n    return this.cm.display.wrapper.ownerDocument.getSelection()\n  };\n\n  ContentEditableInput.prototype.showPrimarySelection = function () {\n    var sel = this.getSelection(), cm = this.cm, prim = cm.doc.sel.primary();\n    var from = prim.from(), to = prim.to();\n\n    if (cm.display.viewTo == cm.display.viewFrom || from.line >= cm.display.viewTo || to.line < cm.display.viewFrom) {\n      sel.removeAllRanges();\n      return\n    }\n\n    var curAnchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n    var curFocus = domToPos(cm, sel.focusNode, sel.focusOffset);\n    if (curAnchor && !curAnchor.bad && curFocus && !curFocus.bad &&\n        cmp(minPos(curAnchor, curFocus), from) == 0 &&\n        cmp(maxPos(curAnchor, curFocus), to) == 0)\n      { return }\n\n    var view = cm.display.view;\n    var start = (from.line >= cm.display.viewFrom && posToDOM(cm, from)) ||\n        {node: view[0].measure.map[2], offset: 0};\n    var end = to.line < cm.display.viewTo && posToDOM(cm, to);\n    if (!end) {\n      var measure = view[view.length - 1].measure;\n      var map = measure.maps ? measure.maps[measure.maps.length - 1] : measure.map;\n      end = {node: map[map.length - 1], offset: map[map.length - 2] - map[map.length - 3]};\n    }\n\n    if (!start || !end) {\n      sel.removeAllRanges();\n      return\n    }\n\n    var old = sel.rangeCount && sel.getRangeAt(0), rng;\n    try { rng = range(start.node, start.offset, end.offset, end.node); }\n    catch(e) {} // Our model of the DOM might be outdated, in which case the range we try to set can be impossible\n    if (rng) {\n      if (!gecko && cm.state.focused) {\n        sel.collapse(start.node, start.offset);\n        if (!rng.collapsed) {\n          sel.removeAllRanges();\n          sel.addRange(rng);\n        }\n      } else {\n        sel.removeAllRanges();\n        sel.addRange(rng);\n      }\n      if (old && sel.anchorNode == null) { sel.addRange(old); }\n      else if (gecko) { this.startGracePeriod(); }\n    }\n    this.rememberSelection();\n  };\n\n  ContentEditableInput.prototype.startGracePeriod = function () {\n      var this$1 = this;\n\n    clearTimeout(this.gracePeriod);\n    this.gracePeriod = setTimeout(function () {\n      this$1.gracePeriod = false;\n      if (this$1.selectionChanged())\n        { this$1.cm.operation(function () { return this$1.cm.curOp.selectionChanged = true; }); }\n    }, 20);\n  };\n\n  ContentEditableInput.prototype.showMultipleSelections = function (info) {\n    removeChildrenAndAdd(this.cm.display.cursorDiv, info.cursors);\n    removeChildrenAndAdd(this.cm.display.selectionDiv, info.selection);\n  };\n\n  ContentEditableInput.prototype.rememberSelection = function () {\n    var sel = this.getSelection();\n    this.lastAnchorNode = sel.anchorNode; this.lastAnchorOffset = sel.anchorOffset;\n    this.lastFocusNode = sel.focusNode; this.lastFocusOffset = sel.focusOffset;\n  };\n\n  ContentEditableInput.prototype.selectionInEditor = function () {\n    var sel = this.getSelection();\n    if (!sel.rangeCount) { return false }\n    var node = sel.getRangeAt(0).commonAncestorContainer;\n    return contains(this.div, node)\n  };\n\n  ContentEditableInput.prototype.focus = function () {\n    if (this.cm.options.readOnly != \"nocursor\") {\n      if (!this.selectionInEditor() || document.activeElement != this.div)\n        { this.showSelection(this.prepareSelection(), true); }\n      this.div.focus();\n    }\n  };\n  ContentEditableInput.prototype.blur = function () { this.div.blur(); };\n  ContentEditableInput.prototype.getField = function () { return this.div };\n\n  ContentEditableInput.prototype.supportsTouch = function () { return true };\n\n  ContentEditableInput.prototype.receivedFocus = function () {\n    var input = this;\n    if (this.selectionInEditor())\n      { this.pollSelection(); }\n    else\n      { runInOp(this.cm, function () { return input.cm.curOp.selectionChanged = true; }); }\n\n    function poll() {\n      if (input.cm.state.focused) {\n        input.pollSelection();\n        input.polling.set(input.cm.options.pollInterval, poll);\n      }\n    }\n    this.polling.set(this.cm.options.pollInterval, poll);\n  };\n\n  ContentEditableInput.prototype.selectionChanged = function () {\n    var sel = this.getSelection();\n    return sel.anchorNode != this.lastAnchorNode || sel.anchorOffset != this.lastAnchorOffset ||\n      sel.focusNode != this.lastFocusNode || sel.focusOffset != this.lastFocusOffset\n  };\n\n  ContentEditableInput.prototype.pollSelection = function () {\n    if (this.readDOMTimeout != null || this.gracePeriod || !this.selectionChanged()) { return }\n    var sel = this.getSelection(), cm = this.cm;\n    // On Android Chrome (version 56, at least), backspacing into an\n    // uneditable block element will put the cursor in that element,\n    // and then, because it's not editable, hide the virtual keyboard.\n    // Because Android doesn't allow us to actually detect backspace\n    // presses in a sane way, this code checks for when that happens\n    // and simulates a backspace press in this case.\n    if (android && chrome && this.cm.display.gutterSpecs.length && isInGutter(sel.anchorNode)) {\n      this.cm.triggerOnKeyDown({type: \"keydown\", keyCode: 8, preventDefault: Math.abs});\n      this.blur();\n      this.focus();\n      return\n    }\n    if (this.composing) { return }\n    this.rememberSelection();\n    var anchor = domToPos(cm, sel.anchorNode, sel.anchorOffset);\n    var head = domToPos(cm, sel.focusNode, sel.focusOffset);\n    if (anchor && head) { runInOp(cm, function () {\n      setSelection(cm.doc, simpleSelection(anchor, head), sel_dontScroll);\n      if (anchor.bad || head.bad) { cm.curOp.selectionChanged = true; }\n    }); }\n  };\n\n  ContentEditableInput.prototype.pollContent = function () {\n    if (this.readDOMTimeout != null) {\n      clearTimeout(this.readDOMTimeout);\n      this.readDOMTimeout = null;\n    }\n\n    var cm = this.cm, display = cm.display, sel = cm.doc.sel.primary();\n    var from = sel.from(), to = sel.to();\n    if (from.ch == 0 && from.line > cm.firstLine())\n      { from = Pos(from.line - 1, getLine(cm.doc, from.line - 1).length); }\n    if (to.ch == getLine(cm.doc, to.line).text.length && to.line < cm.lastLine())\n      { to = Pos(to.line + 1, 0); }\n    if (from.line < display.viewFrom || to.line > display.viewTo - 1) { return false }\n\n    var fromIndex, fromLine, fromNode;\n    if (from.line == display.viewFrom || (fromIndex = findViewIndex(cm, from.line)) == 0) {\n      fromLine = lineNo(display.view[0].line);\n      fromNode = display.view[0].node;\n    } else {\n      fromLine = lineNo(display.view[fromIndex].line);\n      fromNode = display.view[fromIndex - 1].node.nextSibling;\n    }\n    var toIndex = findViewIndex(cm, to.line);\n    var toLine, toNode;\n    if (toIndex == display.view.length - 1) {\n      toLine = display.viewTo - 1;\n      toNode = display.lineDiv.lastChild;\n    } else {\n      toLine = lineNo(display.view[toIndex + 1].line) - 1;\n      toNode = display.view[toIndex + 1].node.previousSibling;\n    }\n\n    if (!fromNode) { return false }\n    var newText = cm.doc.splitLines(domTextBetween(cm, fromNode, toNode, fromLine, toLine));\n    var oldText = getBetween(cm.doc, Pos(fromLine, 0), Pos(toLine, getLine(cm.doc, toLine).text.length));\n    while (newText.length > 1 && oldText.length > 1) {\n      if (lst(newText) == lst(oldText)) { newText.pop(); oldText.pop(); toLine--; }\n      else if (newText[0] == oldText[0]) { newText.shift(); oldText.shift(); fromLine++; }\n      else { break }\n    }\n\n    var cutFront = 0, cutEnd = 0;\n    var newTop = newText[0], oldTop = oldText[0], maxCutFront = Math.min(newTop.length, oldTop.length);\n    while (cutFront < maxCutFront && newTop.charCodeAt(cutFront) == oldTop.charCodeAt(cutFront))\n      { ++cutFront; }\n    var newBot = lst(newText), oldBot = lst(oldText);\n    var maxCutEnd = Math.min(newBot.length - (newText.length == 1 ? cutFront : 0),\n                             oldBot.length - (oldText.length == 1 ? cutFront : 0));\n    while (cutEnd < maxCutEnd &&\n           newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1))\n      { ++cutEnd; }\n    // Try to move start of change to start of selection if ambiguous\n    if (newText.length == 1 && oldText.length == 1 && fromLine == from.line) {\n      while (cutFront && cutFront > from.ch &&\n             newBot.charCodeAt(newBot.length - cutEnd - 1) == oldBot.charCodeAt(oldBot.length - cutEnd - 1)) {\n        cutFront--;\n        cutEnd++;\n      }\n    }\n\n    newText[newText.length - 1] = newBot.slice(0, newBot.length - cutEnd).replace(/^\\u200b+/, \"\");\n    newText[0] = newText[0].slice(cutFront).replace(/\\u200b+$/, \"\");\n\n    var chFrom = Pos(fromLine, cutFront);\n    var chTo = Pos(toLine, oldText.length ? lst(oldText).length - cutEnd : 0);\n    if (newText.length > 1 || newText[0] || cmp(chFrom, chTo)) {\n      replaceRange(cm.doc, newText, chFrom, chTo, \"+input\");\n      return true\n    }\n  };\n\n  ContentEditableInput.prototype.ensurePolled = function () {\n    this.forceCompositionEnd();\n  };\n  ContentEditableInput.prototype.reset = function () {\n    this.forceCompositionEnd();\n  };\n  ContentEditableInput.prototype.forceCompositionEnd = function () {\n    if (!this.composing) { return }\n    clearTimeout(this.readDOMTimeout);\n    this.composing = null;\n    this.updateFromDOM();\n    this.div.blur();\n    this.div.focus();\n  };\n  ContentEditableInput.prototype.readFromDOMSoon = function () {\n      var this$1 = this;\n\n    if (this.readDOMTimeout != null) { return }\n    this.readDOMTimeout = setTimeout(function () {\n      this$1.readDOMTimeout = null;\n      if (this$1.composing) {\n        if (this$1.composing.done) { this$1.composing = null; }\n        else { return }\n      }\n      this$1.updateFromDOM();\n    }, 80);\n  };\n\n  ContentEditableInput.prototype.updateFromDOM = function () {\n      var this$1 = this;\n\n    if (this.cm.isReadOnly() || !this.pollContent())\n      { runInOp(this.cm, function () { return regChange(this$1.cm); }); }\n  };\n\n  ContentEditableInput.prototype.setUneditable = function (node) {\n    node.contentEditable = \"false\";\n  };\n\n  ContentEditableInput.prototype.onKeyPress = function (e) {\n    if (e.charCode == 0 || this.composing) { return }\n    e.preventDefault();\n    if (!this.cm.isReadOnly())\n      { operation(this.cm, applyTextInput)(this.cm, String.fromCharCode(e.charCode == null ? e.keyCode : e.charCode), 0); }\n  };\n\n  ContentEditableInput.prototype.readOnlyChanged = function (val) {\n    this.div.contentEditable = String(val != \"nocursor\");\n  };\n\n  ContentEditableInput.prototype.onContextMenu = function () {};\n  ContentEditableInput.prototype.resetPosition = function () {};\n\n  ContentEditableInput.prototype.needsContentAttribute = true;\n\n  function posToDOM(cm, pos) {\n    var view = findViewForLine(cm, pos.line);\n    if (!view || view.hidden) { return null }\n    var line = getLine(cm.doc, pos.line);\n    var info = mapFromLineView(view, line, pos.line);\n\n    var order = getOrder(line, cm.doc.direction), side = \"left\";\n    if (order) {\n      var partPos = getBidiPartAt(order, pos.ch);\n      side = partPos % 2 ? \"right\" : \"left\";\n    }\n    var result = nodeAndOffsetInLineMap(info.map, pos.ch, side);\n    result.offset = result.collapse == \"right\" ? result.end : result.start;\n    return result\n  }\n\n  function isInGutter(node) {\n    for (var scan = node; scan; scan = scan.parentNode)\n      { if (/CodeMirror-gutter-wrapper/.test(scan.className)) { return true } }\n    return false\n  }\n\n  function badPos(pos, bad) { if (bad) { pos.bad = true; } return pos }\n\n  function domTextBetween(cm, from, to, fromLine, toLine) {\n    var text = \"\", closing = false, lineSep = cm.doc.lineSeparator(), extraLinebreak = false;\n    function recognizeMarker(id) { return function (marker) { return marker.id == id; } }\n    function close() {\n      if (closing) {\n        text += lineSep;\n        if (extraLinebreak) { text += lineSep; }\n        closing = extraLinebreak = false;\n      }\n    }\n    function addText(str) {\n      if (str) {\n        close();\n        text += str;\n      }\n    }\n    function walk(node) {\n      if (node.nodeType == 1) {\n        var cmText = node.getAttribute(\"cm-text\");\n        if (cmText) {\n          addText(cmText);\n          return\n        }\n        var markerID = node.getAttribute(\"cm-marker\"), range;\n        if (markerID) {\n          var found = cm.findMarks(Pos(fromLine, 0), Pos(toLine + 1, 0), recognizeMarker(+markerID));\n          if (found.length && (range = found[0].find(0)))\n            { addText(getBetween(cm.doc, range.from, range.to).join(lineSep)); }\n          return\n        }\n        if (node.getAttribute(\"contenteditable\") == \"false\") { return }\n        var isBlock = /^(pre|div|p|li|table|br)$/i.test(node.nodeName);\n        if (!/^br$/i.test(node.nodeName) && node.textContent.length == 0) { return }\n\n        if (isBlock) { close(); }\n        for (var i = 0; i < node.childNodes.length; i++)\n          { walk(node.childNodes[i]); }\n\n        if (/^(pre|p)$/i.test(node.nodeName)) { extraLinebreak = true; }\n        if (isBlock) { closing = true; }\n      } else if (node.nodeType == 3) {\n        addText(node.nodeValue.replace(/\\u200b/g, \"\").replace(/\\u00a0/g, \" \"));\n      }\n    }\n    for (;;) {\n      walk(from);\n      if (from == to) { break }\n      from = from.nextSibling;\n      extraLinebreak = false;\n    }\n    return text\n  }\n\n  function domToPos(cm, node, offset) {\n    var lineNode;\n    if (node == cm.display.lineDiv) {\n      lineNode = cm.display.lineDiv.childNodes[offset];\n      if (!lineNode) { return badPos(cm.clipPos(Pos(cm.display.viewTo - 1)), true) }\n      node = null; offset = 0;\n    } else {\n      for (lineNode = node;; lineNode = lineNode.parentNode) {\n        if (!lineNode || lineNode == cm.display.lineDiv) { return null }\n        if (lineNode.parentNode && lineNode.parentNode == cm.display.lineDiv) { break }\n      }\n    }\n    for (var i = 0; i < cm.display.view.length; i++) {\n      var lineView = cm.display.view[i];\n      if (lineView.node == lineNode)\n        { return locateNodeInLineView(lineView, node, offset) }\n    }\n  }\n\n  function locateNodeInLineView(lineView, node, offset) {\n    var wrapper = lineView.text.firstChild, bad = false;\n    if (!node || !contains(wrapper, node)) { return badPos(Pos(lineNo(lineView.line), 0), true) }\n    if (node == wrapper) {\n      bad = true;\n      node = wrapper.childNodes[offset];\n      offset = 0;\n      if (!node) {\n        var line = lineView.rest ? lst(lineView.rest) : lineView.line;\n        return badPos(Pos(lineNo(line), line.text.length), bad)\n      }\n    }\n\n    var textNode = node.nodeType == 3 ? node : null, topNode = node;\n    if (!textNode && node.childNodes.length == 1 && node.firstChild.nodeType == 3) {\n      textNode = node.firstChild;\n      if (offset) { offset = textNode.nodeValue.length; }\n    }\n    while (topNode.parentNode != wrapper) { topNode = topNode.parentNode; }\n    var measure = lineView.measure, maps = measure.maps;\n\n    function find(textNode, topNode, offset) {\n      for (var i = -1; i < (maps ? maps.length : 0); i++) {\n        var map = i < 0 ? measure.map : maps[i];\n        for (var j = 0; j < map.length; j += 3) {\n          var curNode = map[j + 2];\n          if (curNode == textNode || curNode == topNode) {\n            var line = lineNo(i < 0 ? lineView.line : lineView.rest[i]);\n            var ch = map[j] + offset;\n            if (offset < 0 || curNode != textNode) { ch = map[j + (offset ? 1 : 0)]; }\n            return Pos(line, ch)\n          }\n        }\n      }\n    }\n    var found = find(textNode, topNode, offset);\n    if (found) { return badPos(found, bad) }\n\n    // FIXME this is all really shaky. might handle the few cases it needs to handle, but likely to cause problems\n    for (var after = topNode.nextSibling, dist = textNode ? textNode.nodeValue.length - offset : 0; after; after = after.nextSibling) {\n      found = find(after, after.firstChild, 0);\n      if (found)\n        { return badPos(Pos(found.line, found.ch - dist), bad) }\n      else\n        { dist += after.textContent.length; }\n    }\n    for (var before = topNode.previousSibling, dist$1 = offset; before; before = before.previousSibling) {\n      found = find(before, before.firstChild, -1);\n      if (found)\n        { return badPos(Pos(found.line, found.ch + dist$1), bad) }\n      else\n        { dist$1 += before.textContent.length; }\n    }\n  }\n\n  // TEXTAREA INPUT STYLE\n\n  var TextareaInput = function(cm) {\n    this.cm = cm;\n    // See input.poll and input.reset\n    this.prevInput = \"\";\n\n    // Flag that indicates whether we expect input to appear real soon\n    // now (after some event like 'keypress' or 'input') and are\n    // polling intensively.\n    this.pollingFast = false;\n    // Self-resetting timeout for the poller\n    this.polling = new Delayed();\n    // Used to work around IE issue with selection being forgotten when focus moves away from textarea\n    this.hasSelection = false;\n    this.composing = null;\n  };\n\n  TextareaInput.prototype.init = function (display) {\n      var this$1 = this;\n\n    var input = this, cm = this.cm;\n    this.createField(display);\n    var te = this.textarea;\n\n    display.wrapper.insertBefore(this.wrapper, display.wrapper.firstChild);\n\n    // Needed to hide big blue blinking cursor on Mobile Safari (doesn't seem to work in iOS 8 anymore)\n    if (ios) { te.style.width = \"0px\"; }\n\n    on(te, \"input\", function () {\n      if (ie && ie_version >= 9 && this$1.hasSelection) { this$1.hasSelection = null; }\n      input.poll();\n    });\n\n    on(te, \"paste\", function (e) {\n      if (signalDOMEvent(cm, e) || handlePaste(e, cm)) { return }\n\n      cm.state.pasteIncoming = +new Date;\n      input.fastPoll();\n    });\n\n    function prepareCopyCut(e) {\n      if (signalDOMEvent(cm, e)) { return }\n      if (cm.somethingSelected()) {\n        setLastCopied({lineWise: false, text: cm.getSelections()});\n      } else if (!cm.options.lineWiseCopyCut) {\n        return\n      } else {\n        var ranges = copyableRanges(cm);\n        setLastCopied({lineWise: true, text: ranges.text});\n        if (e.type == \"cut\") {\n          cm.setSelections(ranges.ranges, null, sel_dontScroll);\n        } else {\n          input.prevInput = \"\";\n          te.value = ranges.text.join(\"\\n\");\n          selectInput(te);\n        }\n      }\n      if (e.type == \"cut\") { cm.state.cutIncoming = +new Date; }\n    }\n    on(te, \"cut\", prepareCopyCut);\n    on(te, \"copy\", prepareCopyCut);\n\n    on(display.scroller, \"paste\", function (e) {\n      if (eventInWidget(display, e) || signalDOMEvent(cm, e)) { return }\n      if (!te.dispatchEvent) {\n        cm.state.pasteIncoming = +new Date;\n        input.focus();\n        return\n      }\n\n      // Pass the `paste` event to the textarea so it's handled by its event listener.\n      var event = new Event(\"paste\");\n      event.clipboardData = e.clipboardData;\n      te.dispatchEvent(event);\n    });\n\n    // Prevent normal selection in the editor (we handle our own)\n    on(display.lineSpace, \"selectstart\", function (e) {\n      if (!eventInWidget(display, e)) { e_preventDefault(e); }\n    });\n\n    on(te, \"compositionstart\", function () {\n      var start = cm.getCursor(\"from\");\n      if (input.composing) { input.composing.range.clear(); }\n      input.composing = {\n        start: start,\n        range: cm.markText(start, cm.getCursor(\"to\"), {className: \"CodeMirror-composing\"})\n      };\n    });\n    on(te, \"compositionend\", function () {\n      if (input.composing) {\n        input.poll();\n        input.composing.range.clear();\n        input.composing = null;\n      }\n    });\n  };\n\n  TextareaInput.prototype.createField = function (_display) {\n    // Wraps and hides input textarea\n    this.wrapper = hiddenTextarea();\n    // The semihidden textarea that is focused when the editor is\n    // focused, and receives input.\n    this.textarea = this.wrapper.firstChild;\n  };\n\n  TextareaInput.prototype.screenReaderLabelChanged = function (label) {\n    // Label for screenreaders, accessibility\n    if(label) {\n      this.textarea.setAttribute('aria-label', label);\n    } else {\n      this.textarea.removeAttribute('aria-label');\n    }\n  };\n\n  TextareaInput.prototype.prepareSelection = function () {\n    // Redraw the selection and/or cursor\n    var cm = this.cm, display = cm.display, doc = cm.doc;\n    var result = prepareSelection(cm);\n\n    // Move the hidden textarea near the cursor to prevent scrolling artifacts\n    if (cm.options.moveInputWithCursor) {\n      var headPos = cursorCoords(cm, doc.sel.primary().head, \"div\");\n      var wrapOff = display.wrapper.getBoundingClientRect(), lineOff = display.lineDiv.getBoundingClientRect();\n      result.teTop = Math.max(0, Math.min(display.wrapper.clientHeight - 10,\n                                          headPos.top + lineOff.top - wrapOff.top));\n      result.teLeft = Math.max(0, Math.min(display.wrapper.clientWidth - 10,\n                                           headPos.left + lineOff.left - wrapOff.left));\n    }\n\n    return result\n  };\n\n  TextareaInput.prototype.showSelection = function (drawn) {\n    var cm = this.cm, display = cm.display;\n    removeChildrenAndAdd(display.cursorDiv, drawn.cursors);\n    removeChildrenAndAdd(display.selectionDiv, drawn.selection);\n    if (drawn.teTop != null) {\n      this.wrapper.style.top = drawn.teTop + \"px\";\n      this.wrapper.style.left = drawn.teLeft + \"px\";\n    }\n  };\n\n  // Reset the input to correspond to the selection (or to be empty,\n  // when not typing and nothing is selected)\n  TextareaInput.prototype.reset = function (typing) {\n    if (this.contextMenuPending || this.composing) { return }\n    var cm = this.cm;\n    if (cm.somethingSelected()) {\n      this.prevInput = \"\";\n      var content = cm.getSelection();\n      this.textarea.value = content;\n      if (cm.state.focused) { selectInput(this.textarea); }\n      if (ie && ie_version >= 9) { this.hasSelection = content; }\n    } else if (!typing) {\n      this.prevInput = this.textarea.value = \"\";\n      if (ie && ie_version >= 9) { this.hasSelection = null; }\n    }\n  };\n\n  TextareaInput.prototype.getField = function () { return this.textarea };\n\n  TextareaInput.prototype.supportsTouch = function () { return false };\n\n  TextareaInput.prototype.focus = function () {\n    if (this.cm.options.readOnly != \"nocursor\" && (!mobile || activeElt() != this.textarea)) {\n      try { this.textarea.focus(); }\n      catch (e) {} // IE8 will throw if the textarea is display: none or not in DOM\n    }\n  };\n\n  TextareaInput.prototype.blur = function () { this.textarea.blur(); };\n\n  TextareaInput.prototype.resetPosition = function () {\n    this.wrapper.style.top = this.wrapper.style.left = 0;\n  };\n\n  TextareaInput.prototype.receivedFocus = function () { this.slowPoll(); };\n\n  // Poll for input changes, using the normal rate of polling. This\n  // runs as long as the editor is focused.\n  TextareaInput.prototype.slowPoll = function () {\n      var this$1 = this;\n\n    if (this.pollingFast) { return }\n    this.polling.set(this.cm.options.pollInterval, function () {\n      this$1.poll();\n      if (this$1.cm.state.focused) { this$1.slowPoll(); }\n    });\n  };\n\n  // When an event has just come in that is likely to add or change\n  // something in the input textarea, we poll faster, to ensure that\n  // the change appears on the screen quickly.\n  TextareaInput.prototype.fastPoll = function () {\n    var missed = false, input = this;\n    input.pollingFast = true;\n    function p() {\n      var changed = input.poll();\n      if (!changed && !missed) {missed = true; input.polling.set(60, p);}\n      else {input.pollingFast = false; input.slowPoll();}\n    }\n    input.polling.set(20, p);\n  };\n\n  // Read input from the textarea, and update the document to match.\n  // When something is selected, it is present in the textarea, and\n  // selected (unless it is huge, in which case a placeholder is\n  // used). When nothing is selected, the cursor sits after previously\n  // seen text (can be empty), which is stored in prevInput (we must\n  // not reset the textarea when typing, because that breaks IME).\n  TextareaInput.prototype.poll = function () {\n      var this$1 = this;\n\n    var cm = this.cm, input = this.textarea, prevInput = this.prevInput;\n    // Since this is called a *lot*, try to bail out as cheaply as\n    // possible when it is clear that nothing happened. hasSelection\n    // will be the case when there is a lot of text in the textarea,\n    // in which case reading its value would be expensive.\n    if (this.contextMenuPending || !cm.state.focused ||\n        (hasSelection(input) && !prevInput && !this.composing) ||\n        cm.isReadOnly() || cm.options.disableInput || cm.state.keySeq)\n      { return false }\n\n    var text = input.value;\n    // If nothing changed, bail.\n    if (text == prevInput && !cm.somethingSelected()) { return false }\n    // Work around nonsensical selection resetting in IE9/10, and\n    // inexplicable appearance of private area unicode characters on\n    // some key combos in Mac (#2689).\n    if (ie && ie_version >= 9 && this.hasSelection === text ||\n        mac && /[\\uf700-\\uf7ff]/.test(text)) {\n      cm.display.input.reset();\n      return false\n    }\n\n    if (cm.doc.sel == cm.display.selForContextMenu) {\n      var first = text.charCodeAt(0);\n      if (first == 0x200b && !prevInput) { prevInput = \"\\u200b\"; }\n      if (first == 0x21da) { this.reset(); return this.cm.execCommand(\"undo\") }\n    }\n    // Find the part of the input that is actually new\n    var same = 0, l = Math.min(prevInput.length, text.length);\n    while (same < l && prevInput.charCodeAt(same) == text.charCodeAt(same)) { ++same; }\n\n    runInOp(cm, function () {\n      applyTextInput(cm, text.slice(same), prevInput.length - same,\n                     null, this$1.composing ? \"*compose\" : null);\n\n      // Don't leave long text in the textarea, since it makes further polling slow\n      if (text.length > 1000 || text.indexOf(\"\\n\") > -1) { input.value = this$1.prevInput = \"\"; }\n      else { this$1.prevInput = text; }\n\n      if (this$1.composing) {\n        this$1.composing.range.clear();\n        this$1.composing.range = cm.markText(this$1.composing.start, cm.getCursor(\"to\"),\n                                           {className: \"CodeMirror-composing\"});\n      }\n    });\n    return true\n  };\n\n  TextareaInput.prototype.ensurePolled = function () {\n    if (this.pollingFast && this.poll()) { this.pollingFast = false; }\n  };\n\n  TextareaInput.prototype.onKeyPress = function () {\n    if (ie && ie_version >= 9) { this.hasSelection = null; }\n    this.fastPoll();\n  };\n\n  TextareaInput.prototype.onContextMenu = function (e) {\n    var input = this, cm = input.cm, display = cm.display, te = input.textarea;\n    if (input.contextMenuPending) { input.contextMenuPending(); }\n    var pos = posFromMouse(cm, e), scrollPos = display.scroller.scrollTop;\n    if (!pos || presto) { return } // Opera is difficult.\n\n    // Reset the current text selection only if the click is done outside of the selection\n    // and 'resetSelectionOnContextMenu' option is true.\n    var reset = cm.options.resetSelectionOnContextMenu;\n    if (reset && cm.doc.sel.contains(pos) == -1)\n      { operation(cm, setSelection)(cm.doc, simpleSelection(pos), sel_dontScroll); }\n\n    var oldCSS = te.style.cssText, oldWrapperCSS = input.wrapper.style.cssText;\n    var wrapperBox = input.wrapper.offsetParent.getBoundingClientRect();\n    input.wrapper.style.cssText = \"position: static\";\n    te.style.cssText = \"position: absolute; width: 30px; height: 30px;\\n      top: \" + (e.clientY - wrapperBox.top - 5) + \"px; left: \" + (e.clientX - wrapperBox.left - 5) + \"px;\\n      z-index: 1000; background: \" + (ie ? \"rgba(255, 255, 255, .05)\" : \"transparent\") + \";\\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);\";\n    var oldScrollY;\n    if (webkit) { oldScrollY = window.scrollY; } // Work around Chrome issue (#2712)\n    display.input.focus();\n    if (webkit) { window.scrollTo(null, oldScrollY); }\n    display.input.reset();\n    // Adds \"Select all\" to context menu in FF\n    if (!cm.somethingSelected()) { te.value = input.prevInput = \" \"; }\n    input.contextMenuPending = rehide;\n    display.selForContextMenu = cm.doc.sel;\n    clearTimeout(display.detectingSelectAll);\n\n    // Select-all will be greyed out if there's nothing to select, so\n    // this adds a zero-width space so that we can later check whether\n    // it got selected.\n    function prepareSelectAllHack() {\n      if (te.selectionStart != null) {\n        var selected = cm.somethingSelected();\n        var extval = \"\\u200b\" + (selected ? te.value : \"\");\n        te.value = \"\\u21da\"; // Used to catch context-menu undo\n        te.value = extval;\n        input.prevInput = selected ? \"\" : \"\\u200b\";\n        te.selectionStart = 1; te.selectionEnd = extval.length;\n        // Re-set this, in case some other handler touched the\n        // selection in the meantime.\n        display.selForContextMenu = cm.doc.sel;\n      }\n    }\n    function rehide() {\n      if (input.contextMenuPending != rehide) { return }\n      input.contextMenuPending = false;\n      input.wrapper.style.cssText = oldWrapperCSS;\n      te.style.cssText = oldCSS;\n      if (ie && ie_version < 9) { display.scrollbars.setScrollTop(display.scroller.scrollTop = scrollPos); }\n\n      // Try to detect the user choosing select-all\n      if (te.selectionStart != null) {\n        if (!ie || (ie && ie_version < 9)) { prepareSelectAllHack(); }\n        var i = 0, poll = function () {\n          if (display.selForContextMenu == cm.doc.sel && te.selectionStart == 0 &&\n              te.selectionEnd > 0 && input.prevInput == \"\\u200b\") {\n            operation(cm, selectAll)(cm);\n          } else if (i++ < 10) {\n            display.detectingSelectAll = setTimeout(poll, 500);\n          } else {\n            display.selForContextMenu = null;\n            display.input.reset();\n          }\n        };\n        display.detectingSelectAll = setTimeout(poll, 200);\n      }\n    }\n\n    if (ie && ie_version >= 9) { prepareSelectAllHack(); }\n    if (captureRightClick) {\n      e_stop(e);\n      var mouseup = function () {\n        off(window, \"mouseup\", mouseup);\n        setTimeout(rehide, 20);\n      };\n      on(window, \"mouseup\", mouseup);\n    } else {\n      setTimeout(rehide, 50);\n    }\n  };\n\n  TextareaInput.prototype.readOnlyChanged = function (val) {\n    if (!val) { this.reset(); }\n    this.textarea.disabled = val == \"nocursor\";\n    this.textarea.readOnly = !!val;\n  };\n\n  TextareaInput.prototype.setUneditable = function () {};\n\n  TextareaInput.prototype.needsContentAttribute = false;\n\n  function fromTextArea(textarea, options) {\n    options = options ? copyObj(options) : {};\n    options.value = textarea.value;\n    if (!options.tabindex && textarea.tabIndex)\n      { options.tabindex = textarea.tabIndex; }\n    if (!options.placeholder && textarea.placeholder)\n      { options.placeholder = textarea.placeholder; }\n    // Set autofocus to true if this textarea is focused, or if it has\n    // autofocus and no other element is focused.\n    if (options.autofocus == null) {\n      var hasFocus = activeElt();\n      options.autofocus = hasFocus == textarea ||\n        textarea.getAttribute(\"autofocus\") != null && hasFocus == document.body;\n    }\n\n    function save() {textarea.value = cm.getValue();}\n\n    var realSubmit;\n    if (textarea.form) {\n      on(textarea.form, \"submit\", save);\n      // Deplorable hack to make the submit method do the right thing.\n      if (!options.leaveSubmitMethodAlone) {\n        var form = textarea.form;\n        realSubmit = form.submit;\n        try {\n          var wrappedSubmit = form.submit = function () {\n            save();\n            form.submit = realSubmit;\n            form.submit();\n            form.submit = wrappedSubmit;\n          };\n        } catch(e) {}\n      }\n    }\n\n    options.finishInit = function (cm) {\n      cm.save = save;\n      cm.getTextArea = function () { return textarea; };\n      cm.toTextArea = function () {\n        cm.toTextArea = isNaN; // Prevent this from being ran twice\n        save();\n        textarea.parentNode.removeChild(cm.getWrapperElement());\n        textarea.style.display = \"\";\n        if (textarea.form) {\n          off(textarea.form, \"submit\", save);\n          if (!options.leaveSubmitMethodAlone && typeof textarea.form.submit == \"function\")\n            { textarea.form.submit = realSubmit; }\n        }\n      };\n    };\n\n    textarea.style.display = \"none\";\n    var cm = CodeMirror(function (node) { return textarea.parentNode.insertBefore(node, textarea.nextSibling); },\n      options);\n    return cm\n  }\n\n  function addLegacyProps(CodeMirror) {\n    CodeMirror.off = off;\n    CodeMirror.on = on;\n    CodeMirror.wheelEventPixels = wheelEventPixels;\n    CodeMirror.Doc = Doc;\n    CodeMirror.splitLines = splitLinesAuto;\n    CodeMirror.countColumn = countColumn;\n    CodeMirror.findColumn = findColumn;\n    CodeMirror.isWordChar = isWordCharBasic;\n    CodeMirror.Pass = Pass;\n    CodeMirror.signal = signal;\n    CodeMirror.Line = Line;\n    CodeMirror.changeEnd = changeEnd;\n    CodeMirror.scrollbarModel = scrollbarModel;\n    CodeMirror.Pos = Pos;\n    CodeMirror.cmpPos = cmp;\n    CodeMirror.modes = modes;\n    CodeMirror.mimeModes = mimeModes;\n    CodeMirror.resolveMode = resolveMode;\n    CodeMirror.getMode = getMode;\n    CodeMirror.modeExtensions = modeExtensions;\n    CodeMirror.extendMode = extendMode;\n    CodeMirror.copyState = copyState;\n    CodeMirror.startState = startState;\n    CodeMirror.innerMode = innerMode;\n    CodeMirror.commands = commands;\n    CodeMirror.keyMap = keyMap;\n    CodeMirror.keyName = keyName;\n    CodeMirror.isModifierKey = isModifierKey;\n    CodeMirror.lookupKey = lookupKey;\n    CodeMirror.normalizeKeyMap = normalizeKeyMap;\n    CodeMirror.StringStream = StringStream;\n    CodeMirror.SharedTextMarker = SharedTextMarker;\n    CodeMirror.TextMarker = TextMarker;\n    CodeMirror.LineWidget = LineWidget;\n    CodeMirror.e_preventDefault = e_preventDefault;\n    CodeMirror.e_stopPropagation = e_stopPropagation;\n    CodeMirror.e_stop = e_stop;\n    CodeMirror.addClass = addClass;\n    CodeMirror.contains = contains;\n    CodeMirror.rmClass = rmClass;\n    CodeMirror.keyNames = keyNames;\n  }\n\n  // EDITOR CONSTRUCTOR\n\n  defineOptions(CodeMirror);\n\n  addEditorMethods(CodeMirror);\n\n  // Set up methods on CodeMirror's prototype to redirect to the editor's document.\n  var dontDelegate = \"iter insert remove copy getEditor constructor\".split(\" \");\n  for (var prop in Doc.prototype) { if (Doc.prototype.hasOwnProperty(prop) && indexOf(dontDelegate, prop) < 0)\n    { CodeMirror.prototype[prop] = (function(method) {\n      return function() {return method.apply(this.doc, arguments)}\n    })(Doc.prototype[prop]); } }\n\n  eventMixin(Doc);\n  CodeMirror.inputStyles = {\"textarea\": TextareaInput, \"contenteditable\": ContentEditableInput};\n\n  // Extra arguments are stored as the mode's dependencies, which is\n  // used by (legacy) mechanisms like loadmode.js to automatically\n  // load a mode. (Preferred mechanism is the require/define calls.)\n  CodeMirror.defineMode = function(name/*, mode, …*/) {\n    if (!CodeMirror.defaults.mode && name != \"null\") { CodeMirror.defaults.mode = name; }\n    defineMode.apply(this, arguments);\n  };\n\n  CodeMirror.defineMIME = defineMIME;\n\n  // Minimal default mode.\n  CodeMirror.defineMode(\"null\", function () { return ({token: function (stream) { return stream.skipToEnd(); }}); });\n  CodeMirror.defineMIME(\"text/plain\", \"null\");\n\n  // EXTENSIONS\n\n  CodeMirror.defineExtension = function (name, func) {\n    CodeMirror.prototype[name] = func;\n  };\n  CodeMirror.defineDocExtension = function (name, func) {\n    Doc.prototype[name] = func;\n  };\n\n  CodeMirror.fromTextArea = fromTextArea;\n\n  addLegacyProps(CodeMirror);\n\n  CodeMirror.version = \"5.58.1\";\n\n  return CodeMirror;\n\n})));\n","'use strict';\n\nfunction _extends() {\n  _extends = Object.assign || function(target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n    return target;\n  };\n  return _extends.apply(this, arguments);\n}\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n  return _typeof(obj);\n}\n\nvar __extends = void 0 && (void 0).__extends || function() {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    }\n    instanceof Array && function(d, b) {\n      d.__proto__ = b;\n    } || function(d, b) {\n      for (var p in b) {\n        if (b.hasOwnProperty(p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function(d, b) {\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.UnControlled = exports.Controlled = void 0;\n\nvar React = require('react');\n\nvar SERVER_RENDERED = typeof navigator === 'undefined' || global['PREVENT_CODEMIRROR_RENDER'] === true;\nvar cm;\n\nif (!SERVER_RENDERED) {\n  cm = require('codemirror');\n}\n\nvar Helper = function() {\n  function Helper() {}\n\n  Helper.equals = function(x, y) {\n    var _this = this;\n\n    var ok = Object.keys,\n      tx = _typeof(x),\n      ty = _typeof(y);\n\n    return x && y && tx === 'object' && tx === ty ? ok(x).length === ok(y).length && ok(x).every(function(key) {\n      return _this.equals(x[key], y[key]);\n    }) : x === y;\n  };\n\n  return Helper;\n}();\n\nvar Shared = function() {\n  function Shared(editor, props) {\n    this.editor = editor;\n    this.props = props;\n  }\n\n  Shared.prototype.delegateCursor = function(position, scroll, focus) {\n    var doc = this.editor.getDoc();\n\n    if (focus) {\n      this.editor.focus();\n    }\n\n    scroll ? doc.setCursor(position) : doc.setCursor(position, null, {\n      scroll: false\n    });\n  };\n\n  Shared.prototype.delegateScroll = function(coordinates) {\n    this.editor.scrollTo(coordinates.x, coordinates.y);\n  };\n\n  Shared.prototype.delegateSelection = function(ranges, focus) {\n    var doc = this.editor.getDoc();\n    doc.setSelections(ranges);\n\n    if (focus) {\n      this.editor.focus();\n    }\n  };\n\n  Shared.prototype.apply = function(props) {\n    if (props && props.selection && props.selection.ranges) {\n      this.delegateSelection(props.selection.ranges, props.selection.focus || false);\n    }\n\n    if (props && props.cursor) {\n      this.delegateCursor(props.cursor, props.autoScroll || false, this.editor.getOption('autofocus') || false);\n    }\n\n    if (props && props.scroll) {\n      this.delegateScroll(props.scroll);\n    }\n  };\n\n  Shared.prototype.applyNext = function(props, next, preserved) {\n    if (props && props.selection && props.selection.ranges) {\n      if (next && next.selection && next.selection.ranges && !Helper.equals(props.selection.ranges, next.selection.ranges)) {\n        this.delegateSelection(next.selection.ranges, next.selection.focus || false);\n      }\n    }\n\n    if (props && props.cursor) {\n      if (next && next.cursor && !Helper.equals(props.cursor, next.cursor)) {\n        this.delegateCursor(preserved.cursor || next.cursor, next.autoScroll || false, next.autoCursor || false);\n      }\n    }\n\n    if (props && props.scroll) {\n      if (next && next.scroll && !Helper.equals(props.scroll, next.scroll)) {\n        this.delegateScroll(next.scroll);\n      }\n    }\n  };\n\n  Shared.prototype.applyUserDefined = function(props, preserved) {\n    if (preserved && preserved.cursor) {\n      this.delegateCursor(preserved.cursor, props.autoScroll || false, this.editor.getOption('autofocus') || false);\n    }\n  };\n\n  Shared.prototype.wire = function(props) {\n    var _this = this;\n\n    Object.keys(props || {}).filter(function(p) {\n      return /^on/.test(p);\n    }).forEach(function(prop) {\n      switch (prop) {\n        case 'onBlur': {\n          _this.editor.on('blur', function(cm, event) {\n            _this.props.onBlur(_this.editor, event);\n          });\n        }\n        break;\n\n      case 'onContextMenu': {\n        _this.editor.on('contextmenu', function(cm, event) {\n          _this.props.onContextMenu(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onCopy': {\n        _this.editor.on('copy', function(cm, event) {\n          _this.props.onCopy(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onCursor': {\n        _this.editor.on('cursorActivity', function(cm) {\n          _this.props.onCursor(_this.editor, _this.editor.getDoc().getCursor());\n        });\n      }\n      break;\n\n      case 'onCursorActivity': {\n        _this.editor.on('cursorActivity', function(cm) {\n          _this.props.onCursorActivity(_this.editor);\n        });\n      }\n      break;\n\n      case 'onCut': {\n        _this.editor.on('cut', function(cm, event) {\n          _this.props.onCut(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onDblClick': {\n        _this.editor.on('dblclick', function(cm, event) {\n          _this.props.onDblClick(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onDragEnter': {\n        _this.editor.on('dragenter', function(cm, event) {\n          _this.props.onDragEnter(_this.editor, event);\n        });\n      }\n      break;\n\n      case 'onDragLeave': {\n        _this.editor.on('dragleave', function(cm, event) {\n          _this.props.onDragLeave(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onDragOver': {\n        _this.editor.on('dragover', function(cm, event) {\n          _this.props.onDragOver(_this.editor, event);\n        });\n      }\n      break;\n\n      case 'onDragStart': {\n        _this.editor.on('dragstart', function(cm, event) {\n          _this.props.onDragStart(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onDrop': {\n        _this.editor.on('drop', function(cm, event) {\n          _this.props.onDrop(_this.editor, event);\n        });\n      }\n      break;\n\n      case 'onFocus': {\n        _this.editor.on('focus', function(cm, event) {\n          _this.props.onFocus(_this.editor, event);\n        });\n      }\n      break;\n\n      case 'onGutterClick': {\n        _this.editor.on('gutterClick', function(cm, lineNumber, gutter, event) {\n          _this.props.onGutterClick(_this.editor, lineNumber, gutter, event);\n        });\n      }\n      break;\n\n      case 'onInputRead': {\n        _this.editor.on('inputRead', function(cm, EditorChangeEvent) {\n          _this.props.onInputRead(_this.editor, EditorChangeEvent);\n        });\n      }\n      break;\n\n      case 'onKeyDown': {\n        _this.editor.on('keydown', function(cm, event) {\n          _this.props.onKeyDown(_this.editor, event);\n        });\n      }\n      break;\n\n      case 'onKeyHandled': {\n        _this.editor.on('keyHandled', function(cm, key, event) {\n          _this.props.onKeyHandled(_this.editor, key, event);\n        });\n      }\n      break;\n\n      case 'onKeyPress': {\n        _this.editor.on('keypress', function(cm, event) {\n          _this.props.onKeyPress(_this.editor, event);\n        });\n      }\n      break;\n\n      case 'onKeyUp': {\n        _this.editor.on('keyup', function(cm, event) {\n          _this.props.onKeyUp(_this.editor, event);\n        });\n      }\n      break;\n\n      case 'onMouseDown': {\n        _this.editor.on('mousedown', function(cm, event) {\n          _this.props.onMouseDown(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onPaste': {\n        _this.editor.on('paste', function(cm, event) {\n          _this.props.onPaste(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onRenderLine': {\n        _this.editor.on('renderLine', function(cm, line, element) {\n          _this.props.onRenderLine(_this.editor, line, element);\n        });\n\n        break;\n      }\n\n      case 'onScroll': {\n        _this.editor.on('scroll', function(cm) {\n          _this.props.onScroll(_this.editor, _this.editor.getScrollInfo());\n        });\n      }\n      break;\n\n      case 'onSelection': {\n        _this.editor.on('beforeSelectionChange', function(cm, data) {\n          _this.props.onSelection(_this.editor, data);\n        });\n      }\n      break;\n\n      case 'onTouchStart': {\n        _this.editor.on('touchstart', function(cm, event) {\n          _this.props.onTouchStart(_this.editor, event);\n        });\n\n        break;\n      }\n\n      case 'onUpdate': {\n        _this.editor.on('update', function(cm) {\n          _this.props.onUpdate(_this.editor);\n        });\n      }\n      break;\n\n      case 'onViewportChange': {\n        _this.editor.on('viewportChange', function(cm, from, to) {\n          _this.props.onViewportChange(_this.editor, from, to);\n        });\n      }\n      break;\n      }\n    });\n  };\n\n  return Shared;\n}();\n\nvar Controlled = function(_super) {\n  __extends(Controlled, _super);\n\n  function Controlled(props) {\n    var _this = _super.call(this, props) || this;\n\n    if (SERVER_RENDERED) return _this;\n    _this.applied = false;\n    _this.appliedNext = false;\n    _this.appliedUserDefined = false;\n    _this.deferred = null;\n    _this.emulating = false;\n    _this.hydrated = false;\n\n    _this.initCb = function() {\n      if (_this.props.editorDidConfigure) {\n        _this.props.editorDidConfigure(_this.editor);\n      }\n    };\n\n    _this.mounted = false;\n    return _this;\n  }\n\n  Controlled.prototype.hydrate = function(props) {\n    var _this = this;\n\n    var _options = props && props.options ? props.options : {};\n\n    var userDefinedOptions = _extends({}, cm.defaults, this.editor.options, _options);\n\n    var optionDelta = Object.keys(userDefinedOptions).some(function(key) {\n      return _this.editor.getOption(key) !== userDefinedOptions[key];\n    });\n\n    if (optionDelta) {\n      Object.keys(userDefinedOptions).forEach(function(key) {\n        if (_options.hasOwnProperty(key)) {\n          if (_this.editor.getOption(key) !== userDefinedOptions[key]) {\n            _this.editor.setOption(key, userDefinedOptions[key]);\n\n            _this.mirror.setOption(key, userDefinedOptions[key]);\n          }\n        }\n      });\n    }\n\n    if (!this.hydrated) {\n      this.deferred ? this.resolveChange(props.value) : this.initChange(props.value || '');\n    }\n\n    this.hydrated = true;\n  };\n\n  Controlled.prototype.initChange = function(value) {\n    this.emulating = true;\n    var doc = this.editor.getDoc();\n    var lastLine = doc.lastLine();\n    var lastChar = doc.getLine(doc.lastLine()).length;\n    doc.replaceRange(value || '', {\n      line: 0,\n      ch: 0\n    }, {\n      line: lastLine,\n      ch: lastChar\n    });\n    this.mirror.setValue(value);\n    doc.clearHistory();\n    this.mirror.clearHistory();\n    this.emulating = false;\n  };\n\n  Controlled.prototype.resolveChange = function(value) {\n    this.emulating = true;\n    var doc = this.editor.getDoc();\n\n    if (this.deferred.origin === 'undo') {\n      doc.undo();\n    } else if (this.deferred.origin === 'redo') {\n      doc.redo();\n    } else {\n      doc.replaceRange(this.deferred.text, this.deferred.from, this.deferred.to, this.deferred.origin);\n    }\n\n    if (value && value !== doc.getValue()) {\n      var cursor = doc.getCursor();\n      doc.setValue(value);\n      doc.setCursor(cursor);\n    }\n\n    this.emulating = false;\n    this.deferred = null;\n  };\n\n  Controlled.prototype.mirrorChange = function(deferred) {\n    var doc = this.editor.getDoc();\n\n    if (deferred.origin === 'undo') {\n      doc.setHistory(this.mirror.getHistory());\n      this.mirror.undo();\n    } else if (deferred.origin === 'redo') {\n      doc.setHistory(this.mirror.getHistory());\n      this.mirror.redo();\n    } else {\n      this.mirror.replaceRange(deferred.text, deferred.from, deferred.to, deferred.origin);\n    }\n\n    return this.mirror.getValue();\n  };\n\n  Controlled.prototype.componentDidMount = function() {\n    var _this = this;\n\n    if (SERVER_RENDERED) return;\n\n    if (this.props.defineMode) {\n      if (this.props.defineMode.name && this.props.defineMode.fn) {\n        cm.defineMode(this.props.defineMode.name, this.props.defineMode.fn);\n      }\n    }\n\n    this.editor = cm(this.ref, this.props.options);\n    this.shared = new Shared(this.editor, this.props);\n    this.mirror = cm(function() {}, this.props.options);\n    this.editor.on('electricInput', function() {\n      _this.mirror.setHistory(_this.editor.getDoc().getHistory());\n    });\n    this.editor.on('cursorActivity', function() {\n      _this.mirror.setCursor(_this.editor.getDoc().getCursor());\n    });\n    this.editor.on('beforeChange', function(cm, data) {\n      if (_this.emulating) {\n        return;\n      }\n\n      data.cancel();\n      _this.deferred = data;\n\n      var phantomChange = _this.mirrorChange(_this.deferred);\n\n      if (_this.props.onBeforeChange) _this.props.onBeforeChange(_this.editor, _this.deferred, phantomChange);\n    });\n    this.editor.on('change', function(cm, data) {\n      if (!_this.mounted) {\n        return;\n      }\n\n      if (_this.props.onChange) {\n        _this.props.onChange(_this.editor, data, _this.editor.getValue());\n      }\n    });\n    this.hydrate(this.props);\n    this.shared.apply(this.props);\n    this.applied = true;\n    this.mounted = true;\n    this.shared.wire(this.props);\n\n    if (this.editor.getOption('autofocus')) {\n      this.editor.focus();\n    }\n\n    if (this.props.editorDidMount) {\n      this.props.editorDidMount(this.editor, this.editor.getValue(), this.initCb);\n    }\n  };\n\n  Controlled.prototype.componentDidUpdate = function(prevProps) {\n    if (SERVER_RENDERED) return;\n    var preserved = {\n      cursor: null\n    };\n\n    if (this.props.value !== prevProps.value) {\n      this.hydrated = false;\n    }\n\n    if (!this.props.autoCursor && this.props.autoCursor !== undefined) {\n      preserved.cursor = this.editor.getDoc().getCursor();\n    }\n\n    this.hydrate(this.props);\n\n    if (!this.appliedNext) {\n      this.shared.applyNext(prevProps, this.props, preserved);\n      this.appliedNext = true;\n    }\n\n    this.shared.applyUserDefined(prevProps, preserved);\n    this.appliedUserDefined = true;\n  };\n\n  Controlled.prototype.componentWillUnmount = function() {\n    if (SERVER_RENDERED) return;\n\n    if (this.props.editorWillUnmount) {\n      this.props.editorWillUnmount(cm);\n    }\n  };\n\n  Controlled.prototype.shouldComponentUpdate = function(nextProps, nextState) {\n    return !SERVER_RENDERED;\n  };\n\n  Controlled.prototype.render = function() {\n    var _this = this;\n\n    if (SERVER_RENDERED) return null;\n    var className = this.props.className ? 'react-codemirror2 ' + this.props.className : 'react-codemirror2';\n    return React.createElement('div', {\n      className: className,\n      ref: function ref(self) {\n        return _this.ref = self;\n      }\n    });\n  };\n\n  return Controlled;\n}(React.Component);\n\nexports.Controlled = Controlled;\n\nvar UnControlled = function(_super) {\n  __extends(UnControlled, _super);\n\n  function UnControlled(props) {\n    var _this = _super.call(this, props) || this;\n\n    if (SERVER_RENDERED) return _this;\n    _this.applied = false;\n    _this.appliedUserDefined = false;\n    _this.continueChange = false;\n    _this.detached = false;\n    _this.hydrated = false;\n\n    _this.initCb = function() {\n      if (_this.props.editorDidConfigure) {\n        _this.props.editorDidConfigure(_this.editor);\n      }\n    };\n\n    _this.mounted = false;\n\n    _this.onBeforeChangeCb = function() {\n      _this.continueChange = true;\n    };\n\n    return _this;\n  }\n\n  UnControlled.prototype.hydrate = function(props) {\n    var _this = this;\n\n    var _options = props && props.options ? props.options : {};\n\n    var userDefinedOptions = _extends({}, cm.defaults, this.editor.options, _options);\n\n    var optionDelta = Object.keys(userDefinedOptions).some(function(key) {\n      return _this.editor.getOption(key) !== userDefinedOptions[key];\n    });\n\n    if (optionDelta) {\n      Object.keys(userDefinedOptions).forEach(function(key) {\n        if (_options.hasOwnProperty(key)) {\n          if (_this.editor.getOption(key) !== userDefinedOptions[key]) {\n            _this.editor.setOption(key, userDefinedOptions[key]);\n          }\n        }\n      });\n    }\n\n    if (!this.hydrated) {\n      var doc = this.editor.getDoc();\n      var lastLine = doc.lastLine();\n      var lastChar = doc.getLine(doc.lastLine()).length;\n      doc.replaceRange(props.value || '', {\n        line: 0,\n        ch: 0\n      }, {\n        line: lastLine,\n        ch: lastChar\n      });\n    }\n\n    this.hydrated = true;\n  };\n\n  UnControlled.prototype.componentDidMount = function() {\n    var _this = this;\n\n    if (SERVER_RENDERED) return;\n    this.detached = this.props.detach === true;\n\n    if (this.props.defineMode) {\n      if (this.props.defineMode.name && this.props.defineMode.fn) {\n        cm.defineMode(this.props.defineMode.name, this.props.defineMode.fn);\n      }\n    }\n\n    this.editor = cm(this.ref, this.props.options);\n    this.shared = new Shared(this.editor, this.props);\n    this.editor.on('beforeChange', function(cm, data) {\n      if (_this.props.onBeforeChange) {\n        _this.props.onBeforeChange(_this.editor, data, _this.editor.getValue(), _this.onBeforeChangeCb);\n      }\n    });\n    this.editor.on('change', function(cm, data) {\n      if (!_this.mounted || !_this.props.onChange) {\n        return;\n      }\n\n      if (_this.props.onBeforeChange) {\n        if (_this.continueChange) {\n          _this.props.onChange(_this.editor, data, _this.editor.getValue());\n        }\n      } else {\n        _this.props.onChange(_this.editor, data, _this.editor.getValue());\n      }\n    });\n    this.hydrate(this.props);\n    this.shared.apply(this.props);\n    this.applied = true;\n    this.mounted = true;\n    this.shared.wire(this.props);\n    this.editor.getDoc().clearHistory();\n\n    if (this.props.editorDidMount) {\n      this.props.editorDidMount(this.editor, this.editor.getValue(), this.initCb);\n    }\n  };\n\n  UnControlled.prototype.componentDidUpdate = function(prevProps) {\n    if (this.detached && this.props.detach === false) {\n      this.detached = false;\n\n      if (prevProps.editorDidAttach) {\n        prevProps.editorDidAttach(this.editor);\n      }\n    }\n\n    if (!this.detached && this.props.detach === true) {\n      this.detached = true;\n\n      if (prevProps.editorDidDetach) {\n        prevProps.editorDidDetach(this.editor);\n      }\n    }\n\n    if (SERVER_RENDERED || this.detached) return;\n    var preserved = {\n      cursor: null\n    };\n\n    if (this.props.value !== prevProps.value) {\n      this.hydrated = false;\n      this.applied = false;\n      this.appliedUserDefined = false;\n    }\n\n    if (!prevProps.autoCursor && prevProps.autoCursor !== undefined) {\n      preserved.cursor = this.editor.getDoc().getCursor();\n    }\n\n    this.hydrate(this.props);\n\n    if (!this.applied) {\n      this.shared.apply(prevProps);\n      this.applied = true;\n    }\n\n    if (!this.appliedUserDefined) {\n      this.shared.applyUserDefined(prevProps, preserved);\n      this.appliedUserDefined = true;\n    }\n  };\n\n  UnControlled.prototype.componentWillUnmount = function() {\n    if (SERVER_RENDERED) return;\n\n    if (this.props.editorWillUnmount) {\n      this.props.editorWillUnmount(cm);\n    }\n  };\n\n  UnControlled.prototype.shouldComponentUpdate = function(nextProps, nextState) {\n    var update = true;\n    if (SERVER_RENDERED) update = false;\n    if (this.detached && nextProps.detach) update = false;\n    return update;\n  };\n\n  UnControlled.prototype.render = function() {\n    var _this = this;\n\n    if (SERVER_RENDERED) return null;\n    var className = this.props.className ? 'react-codemirror2 ' + this.props.className : 'react-codemirror2';\n    return React.createElement('div', {\n      className: className,\n      ref: function ref(self) {\n        return _this.ref = self;\n      }\n    });\n  };\n\n  return UnControlled;\n}(React.Component);\n\nexports.UnControlled = UnControlled;","// This icon file is generated automatically.\nvar SaveOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z\" } }] }, \"name\": \"save\", \"theme\": \"outlined\" };\nexport default SaveOutlined;\n","// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport SaveOutlinedSvg from \"@ant-design/icons-svg/es/asn/SaveOutlined\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar SaveOutlined = function SaveOutlined(props, ref) {\n  return React.createElement(AntdIcon, Object.assign({}, props, {\n    ref: ref,\n    icon: SaveOutlinedSvg\n  }));\n};\n\nSaveOutlined.displayName = 'SaveOutlined';\nexport default React.forwardRef(SaveOutlined);","/*!\n * hotkeys-js v3.8.1\n * A simple micro-library for defining and dispatching keyboard shortcuts. It has no dependencies.\n * \n * Copyright (c) 2020 kenny wong <wowohoo@qq.com>\n * http://jaywcjlove.github.io/hotkeys\n * \n * Licensed under the MIT license.\n */\n\nvar isff = typeof navigator !== 'undefined' ? navigator.userAgent.toLowerCase().indexOf('firefox') > 0 : false; // 绑定事件\n\nfunction addEvent(object, event, method) {\n  if (object.addEventListener) {\n    object.addEventListener(event, method, false);\n  } else if (object.attachEvent) {\n    object.attachEvent(\"on\".concat(event), function () {\n      method(window.event);\n    });\n  }\n} // 修饰键转换成对应的键码\n\n\nfunction getMods(modifier, key) {\n  var mods = key.slice(0, key.length - 1);\n\n  for (var i = 0; i < mods.length; i++) {\n    mods[i] = modifier[mods[i].toLowerCase()];\n  }\n\n  return mods;\n} // 处理传的key字符串转换成数组\n\n\nfunction getKeys(key) {\n  if (typeof key !== 'string') key = '';\n  key = key.replace(/\\s/g, ''); // 匹配任何空白字符,包括空格、制表符、换页符等等\n\n  var keys = key.split(','); // 同时设置多个快捷键，以','分割\n\n  var index = keys.lastIndexOf(''); // 快捷键可能包含','，需特殊处理\n\n  for (; index >= 0;) {\n    keys[index - 1] += ',';\n    keys.splice(index, 1);\n    index = keys.lastIndexOf('');\n  }\n\n  return keys;\n} // 比较修饰键的数组\n\n\nfunction compareArray(a1, a2) {\n  var arr1 = a1.length >= a2.length ? a1 : a2;\n  var arr2 = a1.length >= a2.length ? a2 : a1;\n  var isIndex = true;\n\n  for (var i = 0; i < arr1.length; i++) {\n    if (arr2.indexOf(arr1[i]) === -1) isIndex = false;\n  }\n\n  return isIndex;\n}\n\nvar _keyMap = {\n  backspace: 8,\n  tab: 9,\n  clear: 12,\n  enter: 13,\n  return: 13,\n  esc: 27,\n  escape: 27,\n  space: 32,\n  left: 37,\n  up: 38,\n  right: 39,\n  down: 40,\n  del: 46,\n  delete: 46,\n  ins: 45,\n  insert: 45,\n  home: 36,\n  end: 35,\n  pageup: 33,\n  pagedown: 34,\n  capslock: 20,\n  '⇪': 20,\n  ',': 188,\n  '.': 190,\n  '/': 191,\n  '`': 192,\n  '-': isff ? 173 : 189,\n  '=': isff ? 61 : 187,\n  ';': isff ? 59 : 186,\n  '\\'': 222,\n  '[': 219,\n  ']': 221,\n  '\\\\': 220\n}; // Modifier Keys\n\nvar _modifier = {\n  // shiftKey\n  '⇧': 16,\n  shift: 16,\n  // altKey\n  '⌥': 18,\n  alt: 18,\n  option: 18,\n  // ctrlKey\n  '⌃': 17,\n  ctrl: 17,\n  control: 17,\n  // metaKey\n  '⌘': 91,\n  cmd: 91,\n  command: 91\n};\nvar modifierMap = {\n  16: 'shiftKey',\n  18: 'altKey',\n  17: 'ctrlKey',\n  91: 'metaKey',\n  shiftKey: 16,\n  ctrlKey: 17,\n  altKey: 18,\n  metaKey: 91\n};\nvar _mods = {\n  16: false,\n  18: false,\n  17: false,\n  91: false\n};\nvar _handlers = {}; // F1~F12 special key\n\nfor (var k = 1; k < 20; k++) {\n  _keyMap[\"f\".concat(k)] = 111 + k;\n}\n\nvar _downKeys = []; // 记录摁下的绑定键\n\nvar _scope = 'all'; // 默认热键范围\n\nvar elementHasBindEvent = []; // 已绑定事件的节点记录\n// 返回键码\n\nvar code = function code(x) {\n  return _keyMap[x.toLowerCase()] || _modifier[x.toLowerCase()] || x.toUpperCase().charCodeAt(0);\n}; // 设置获取当前范围（默认为'所有'）\n\n\nfunction setScope(scope) {\n  _scope = scope || 'all';\n} // 获取当前范围\n\n\nfunction getScope() {\n  return _scope || 'all';\n} // 获取摁下绑定键的键值\n\n\nfunction getPressedKeyCodes() {\n  return _downKeys.slice(0);\n} // 表单控件控件判断 返回 Boolean\n// hotkey is effective only when filter return true\n\n\nfunction filter(event) {\n  var target = event.target || event.srcElement;\n  var tagName = target.tagName;\n  var flag = true; // ignore: isContentEditable === 'true', <input> and <textarea> when readOnly state is false, <select>\n\n  if (target.isContentEditable || (tagName === 'INPUT' || tagName === 'TEXTAREA' || tagName === 'SELECT') && !target.readOnly) {\n    flag = false;\n  }\n\n  return flag;\n} // 判断摁下的键是否为某个键，返回true或者false\n\n\nfunction isPressed(keyCode) {\n  if (typeof keyCode === 'string') {\n    keyCode = code(keyCode); // 转换成键码\n  }\n\n  return _downKeys.indexOf(keyCode) !== -1;\n} // 循环删除handlers中的所有 scope(范围)\n\n\nfunction deleteScope(scope, newScope) {\n  var handlers;\n  var i; // 没有指定scope，获取scope\n\n  if (!scope) scope = getScope();\n\n  for (var key in _handlers) {\n    if (Object.prototype.hasOwnProperty.call(_handlers, key)) {\n      handlers = _handlers[key];\n\n      for (i = 0; i < handlers.length;) {\n        if (handlers[i].scope === scope) handlers.splice(i, 1);else i++;\n      }\n    }\n  } // 如果scope被删除，将scope重置为all\n\n\n  if (getScope() === scope) setScope(newScope || 'all');\n} // 清除修饰键\n\n\nfunction clearModifier(event) {\n  var key = event.keyCode || event.which || event.charCode;\n\n  var i = _downKeys.indexOf(key); // 从列表中清除按压过的键\n\n\n  if (i >= 0) {\n    _downKeys.splice(i, 1);\n  } // 特殊处理 cmmand 键，在 cmmand 组合快捷键 keyup 只执行一次的问题\n\n\n  if (event.key && event.key.toLowerCase() === 'meta') {\n    _downKeys.splice(0, _downKeys.length);\n  } // 修饰键 shiftKey altKey ctrlKey (command||metaKey) 清除\n\n\n  if (key === 93 || key === 224) key = 91;\n\n  if (key in _mods) {\n    _mods[key] = false; // 将修饰键重置为false\n\n    for (var k in _modifier) {\n      if (_modifier[k] === key) hotkeys[k] = false;\n    }\n  }\n}\n\nfunction unbind(keysInfo) {\n  // unbind(), unbind all keys\n  if (!keysInfo) {\n    Object.keys(_handlers).forEach(function (key) {\n      return delete _handlers[key];\n    });\n  } else if (Array.isArray(keysInfo)) {\n    // support like : unbind([{key: 'ctrl+a', scope: 's1'}, {key: 'ctrl-a', scope: 's2', splitKey: '-'}])\n    keysInfo.forEach(function (info) {\n      if (info.key) eachUnbind(info);\n    });\n  } else if (typeof keysInfo === 'object') {\n    // support like unbind({key: 'ctrl+a, ctrl+b', scope:'abc'})\n    if (keysInfo.key) eachUnbind(keysInfo);\n  } else if (typeof keysInfo === 'string') {\n    for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n      args[_key - 1] = arguments[_key];\n    }\n\n    // support old method\n    // eslint-disable-line\n    var scope = args[0],\n        method = args[1];\n\n    if (typeof scope === 'function') {\n      method = scope;\n      scope = '';\n    }\n\n    eachUnbind({\n      key: keysInfo,\n      scope: scope,\n      method: method,\n      splitKey: '+'\n    });\n  }\n} // 解除绑定某个范围的快捷键\n\n\nvar eachUnbind = function eachUnbind(_ref) {\n  var key = _ref.key,\n      scope = _ref.scope,\n      method = _ref.method,\n      _ref$splitKey = _ref.splitKey,\n      splitKey = _ref$splitKey === void 0 ? '+' : _ref$splitKey;\n  var multipleKeys = getKeys(key);\n  multipleKeys.forEach(function (originKey) {\n    var unbindKeys = originKey.split(splitKey);\n    var len = unbindKeys.length;\n    var lastKey = unbindKeys[len - 1];\n    var keyCode = lastKey === '*' ? '*' : code(lastKey);\n    if (!_handlers[keyCode]) return; // 判断是否传入范围，没有就获取范围\n\n    if (!scope) scope = getScope();\n    var mods = len > 1 ? getMods(_modifier, unbindKeys) : [];\n    _handlers[keyCode] = _handlers[keyCode].map(function (record) {\n      // 通过函数判断，是否解除绑定，函数相等直接返回\n      var isMatchingMethod = method ? record.method === method : true;\n\n      if (isMatchingMethod && record.scope === scope && compareArray(record.mods, mods)) {\n        return {};\n      }\n\n      return record;\n    });\n  });\n}; // 对监听对应快捷键的回调函数进行处理\n\n\nfunction eventHandler(event, handler, scope) {\n  var modifiersMatch; // 看它是否在当前范围\n\n  if (handler.scope === scope || handler.scope === 'all') {\n    // 检查是否匹配修饰符（如果有返回true）\n    modifiersMatch = handler.mods.length > 0;\n\n    for (var y in _mods) {\n      if (Object.prototype.hasOwnProperty.call(_mods, y)) {\n        if (!_mods[y] && handler.mods.indexOf(+y) > -1 || _mods[y] && handler.mods.indexOf(+y) === -1) {\n          modifiersMatch = false;\n        }\n      }\n    } // 调用处理程序，如果是修饰键不做处理\n\n\n    if (handler.mods.length === 0 && !_mods[16] && !_mods[18] && !_mods[17] && !_mods[91] || modifiersMatch || handler.shortcut === '*') {\n      if (handler.method(event, handler) === false) {\n        if (event.preventDefault) event.preventDefault();else event.returnValue = false;\n        if (event.stopPropagation) event.stopPropagation();\n        if (event.cancelBubble) event.cancelBubble = true;\n      }\n    }\n  }\n} // 处理keydown事件\n\n\nfunction dispatch(event) {\n  var asterisk = _handlers['*'];\n  var key = event.keyCode || event.which || event.charCode; // 表单控件过滤 默认表单控件不触发快捷键\n\n  if (!hotkeys.filter.call(this, event)) return; // Gecko(Firefox)的command键值224，在Webkit(Chrome)中保持一致\n  // Webkit左右 command 键值不一样\n\n  if (key === 93 || key === 224) key = 91;\n  /**\n   * Collect bound keys\n   * If an Input Method Editor is processing key input and the event is keydown, return 229.\n   * https://stackoverflow.com/questions/25043934/is-it-ok-to-ignore-keydown-events-with-keycode-229\n   * http://lists.w3.org/Archives/Public/www-dom/2010JulSep/att-0182/keyCode-spec.html\n   */\n\n  if (_downKeys.indexOf(key) === -1 && key !== 229) _downKeys.push(key);\n  /**\n   * Jest test cases are required.\n   * ===============================\n   */\n\n  ['ctrlKey', 'altKey', 'shiftKey', 'metaKey'].forEach(function (keyName) {\n    var keyNum = modifierMap[keyName];\n\n    if (event[keyName] && _downKeys.indexOf(keyNum) === -1) {\n      _downKeys.push(keyNum);\n    } else if (!event[keyName] && _downKeys.indexOf(keyNum) > -1) {\n      _downKeys.splice(_downKeys.indexOf(keyNum), 1);\n    } else if (keyName === 'metaKey' && event[keyName] && _downKeys.length === 3) {\n      /**\n       * Fix if Command is pressed:\n       * ===============================\n       */\n      if (!(event.ctrlKey || event.shiftKey || event.altKey)) {\n        _downKeys = _downKeys.slice(_downKeys.indexOf(keyNum));\n      }\n    }\n  });\n  /**\n   * -------------------------------\n   */\n\n  if (key in _mods) {\n    _mods[key] = true; // 将特殊字符的key注册到 hotkeys 上\n\n    for (var k in _modifier) {\n      if (_modifier[k] === key) hotkeys[k] = true;\n    }\n\n    if (!asterisk) return;\n  } // 将 modifierMap 里面的修饰键绑定到 event 中\n\n\n  for (var e in _mods) {\n    if (Object.prototype.hasOwnProperty.call(_mods, e)) {\n      _mods[e] = event[modifierMap[e]];\n    }\n  }\n  /**\n   * https://github.com/jaywcjlove/hotkeys/pull/129\n   * This solves the issue in Firefox on Windows where hotkeys corresponding to special characters would not trigger.\n   * An example of this is ctrl+alt+m on a Swedish keyboard which is used to type μ.\n   * Browser support: https://caniuse.com/#feat=keyboardevent-getmodifierstate\n   */\n\n\n  if (event.getModifierState && !(event.altKey && !event.ctrlKey) && event.getModifierState('AltGraph')) {\n    if (_downKeys.indexOf(17) === -1) {\n      _downKeys.push(17);\n    }\n\n    if (_downKeys.indexOf(18) === -1) {\n      _downKeys.push(18);\n    }\n\n    _mods[17] = true;\n    _mods[18] = true;\n  } // 获取范围 默认为 `all`\n\n\n  var scope = getScope(); // 对任何快捷键都需要做的处理\n\n  if (asterisk) {\n    for (var i = 0; i < asterisk.length; i++) {\n      if (asterisk[i].scope === scope && (event.type === 'keydown' && asterisk[i].keydown || event.type === 'keyup' && asterisk[i].keyup)) {\n        eventHandler(event, asterisk[i], scope);\n      }\n    }\n  } // key 不在 _handlers 中返回\n\n\n  if (!(key in _handlers)) return;\n\n  for (var _i = 0; _i < _handlers[key].length; _i++) {\n    if (event.type === 'keydown' && _handlers[key][_i].keydown || event.type === 'keyup' && _handlers[key][_i].keyup) {\n      if (_handlers[key][_i].key) {\n        var record = _handlers[key][_i];\n        var splitKey = record.splitKey;\n        var keyShortcut = record.key.split(splitKey);\n        var _downKeysCurrent = []; // 记录当前按键键值\n\n        for (var a = 0; a < keyShortcut.length; a++) {\n          _downKeysCurrent.push(code(keyShortcut[a]));\n        }\n\n        if (_downKeysCurrent.sort().join('') === _downKeys.sort().join('')) {\n          // 找到处理内容\n          eventHandler(event, record, scope);\n        }\n      }\n    }\n  }\n} // 判断 element 是否已经绑定事件\n\n\nfunction isElementBind(element) {\n  return elementHasBindEvent.indexOf(element) > -1;\n}\n\nfunction hotkeys(key, option, method) {\n  _downKeys = [];\n  var keys = getKeys(key); // 需要处理的快捷键列表\n\n  var mods = [];\n  var scope = 'all'; // scope默认为all，所有范围都有效\n\n  var element = document; // 快捷键事件绑定节点\n\n  var i = 0;\n  var keyup = false;\n  var keydown = true;\n  var splitKey = '+'; // 对为设定范围的判断\n\n  if (method === undefined && typeof option === 'function') {\n    method = option;\n  }\n\n  if (Object.prototype.toString.call(option) === '[object Object]') {\n    if (option.scope) scope = option.scope; // eslint-disable-line\n\n    if (option.element) element = option.element; // eslint-disable-line\n\n    if (option.keyup) keyup = option.keyup; // eslint-disable-line\n\n    if (option.keydown !== undefined) keydown = option.keydown; // eslint-disable-line\n\n    if (typeof option.splitKey === 'string') splitKey = option.splitKey; // eslint-disable-line\n  }\n\n  if (typeof option === 'string') scope = option; // 对于每个快捷键进行处理\n\n  for (; i < keys.length; i++) {\n    key = keys[i].split(splitKey); // 按键列表\n\n    mods = []; // 如果是组合快捷键取得组合快捷键\n\n    if (key.length > 1) mods = getMods(_modifier, key); // 将非修饰键转化为键码\n\n    key = key[key.length - 1];\n    key = key === '*' ? '*' : code(key); // *表示匹配所有快捷键\n    // 判断key是否在_handlers中，不在就赋一个空数组\n\n    if (!(key in _handlers)) _handlers[key] = [];\n\n    _handlers[key].push({\n      keyup: keyup,\n      keydown: keydown,\n      scope: scope,\n      mods: mods,\n      shortcut: keys[i],\n      method: method,\n      key: keys[i],\n      splitKey: splitKey\n    });\n  } // 在全局document上设置快捷键\n\n\n  if (typeof element !== 'undefined' && !isElementBind(element) && window) {\n    elementHasBindEvent.push(element);\n    addEvent(element, 'keydown', function (e) {\n      dispatch(e);\n    });\n    addEvent(window, 'focus', function () {\n      _downKeys = [];\n    });\n    addEvent(element, 'keyup', function (e) {\n      dispatch(e);\n      clearModifier(e);\n    });\n  }\n}\n\nvar _api = {\n  setScope: setScope,\n  getScope: getScope,\n  deleteScope: deleteScope,\n  getPressedKeyCodes: getPressedKeyCodes,\n  isPressed: isPressed,\n  filter: filter,\n  unbind: unbind\n};\n\nfor (var a in _api) {\n  if (Object.prototype.hasOwnProperty.call(_api, a)) {\n    hotkeys[a] = _api[a];\n  }\n}\n\nif (typeof window !== 'undefined') {\n  var _hotkeys = window.hotkeys;\n\n  hotkeys.noConflict = function (deep) {\n    if (deep && window.hotkeys === hotkeys) {\n      window.hotkeys = _hotkeys;\n    }\n\n    return hotkeys;\n  };\n\n  window.hotkeys = hotkeys;\n}\n\nexport default hotkeys;\n","import hotkeys from \"hotkeys-js\";\n\nexport function useIsHotkeyPressed() {\n  return hotkeys.isPressed;\n}","import hotkeys, {HotkeysEvent, KeyHandler} from \"hotkeys-js\";\nimport React, {useCallback, useEffect, useRef} from \"react\";\n\ntype AvailableTags = 'INPUT' | 'TEXTAREA' | 'SELECT';\n\nexport type Options = {\n  filter?: typeof hotkeys.filter;\n  enableOnTags?: AvailableTags[];\n  splitKey?: string;\n  scope?: string;\n  keyup?: boolean;\n  keydown?: boolean;\n};\n\nexport function useHotkeys<T extends Element>(keys: string, callback: KeyHandler, options?: Options): React.MutableRefObject<T | null>;\nexport function useHotkeys<T extends Element>(keys: string, callback: KeyHandler, deps?: any[]): React.MutableRefObject<T | null>;\nexport function useHotkeys<T extends Element>(keys: string, callback: KeyHandler, options?: Options, deps?: any[]): React.MutableRefObject<T | null>;\nexport function useHotkeys<T extends Element>(keys: string, callback: KeyHandler, options?: any[] | Options, deps?: any[]): React.MutableRefObject<T | null> {\n  if (options instanceof Array) {\n    deps = options;\n    options = undefined;\n  }\n  const {enableOnTags, filter} = options || {};\n\n  const ref = useRef<T | null>(null);\n\n  const memoisedCallback = useCallback((keyboardEvent: KeyboardEvent, hotkeysEvent: HotkeysEvent) => {\n    if (ref.current === null || document.activeElement === ref.current) {\n      callback(keyboardEvent, hotkeysEvent);\n      return true;\n    }\n\n    return false;\n  }, deps ? [ref, ...deps] : [ref]);\n\n  useEffect(() => {\n    if (options && (options as Options).enableOnTags) {\n      hotkeys.filter = ({target, srcElement}) => {\n        // @ts-ignore\n        const targetTagName = (target && target.tagName) || (srcElement && srcElement.tagName);\n\n        return Boolean(targetTagName && enableOnTags && enableOnTags.includes(targetTagName as AvailableTags));\n      };\n    }\n\n    if (filter) hotkeys.filter = filter;\n\n    hotkeys(keys, (options as Options) || {}, memoisedCallback);\n\n    return () => hotkeys.unbind(keys, memoisedCallback);\n  }, [memoisedCallback, options, enableOnTags, filter, keys]);\n\n  return ref;\n}","import _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport ReactIcon from './IconBase';\nimport { normalizeTwoToneColors } from '../utils';\nexport function setTwoToneColor(twoToneColor) {\n  var _normalizeTwoToneColo = normalizeTwoToneColors(twoToneColor),\n      _normalizeTwoToneColo2 = _slicedToArray(_normalizeTwoToneColo, 2),\n      primaryColor = _normalizeTwoToneColo2[0],\n      secondaryColor = _normalizeTwoToneColo2[1];\n\n  return ReactIcon.setTwoToneColors({\n    primaryColor: primaryColor,\n    secondaryColor: secondaryColor\n  });\n}\nexport function getTwoToneColor() {\n  var colors = ReactIcon.getTwoToneColors();\n\n  if (!colors.calculated) {\n    return colors.primaryColor;\n  }\n\n  return [colors.primaryColor, colors.secondaryColor];\n}"],"sourceRoot":""}